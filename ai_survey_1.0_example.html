<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Survey v1.0 - å¿ƒç†å­¦AIå®éªŒå¹³å°</title>
    
    <!-- jsPsych æ ¸å¿ƒæ–‡ä»¶ -->
    <script src="https://unpkg.com/jspsych@7.3.4"></script>
    <link rel="stylesheet" href="https://unpkg.com/jspsych@7.3.4/css/jspsych.css">
    
    <!-- jsPsych é—®å·æ’ä»¶ -->
    <script src="https://unpkg.com/@jspsych/plugin-survey-likert@1.1.3"></script>
    <script src="https://unpkg.com/@jspsych/plugin-html-keyboard-response@1.1.3"></script>
    <script src="https://unpkg.com/@jspsych/plugin-instructions@1.1.4"></script>
    <script src="https://unpkg.com/@jspsych/plugin-survey-text@1.1.3"></script>
    <script src="https://unpkg.com/@jspsych/plugin-survey-multi-choice@1.1.3"></script>
    <script src="https://unpkg.com/@jspsych/plugin-html-button-response@1.1.3"></script>
    <link rel="stylesheet" href="https://unpkg.com/@jspsych/plugin-survey@1.0.1/css/survey.css">
    
    <!-- jsPsych é¼ æ ‡è½¨è¿¹æ‰©å±• -->
    <script src="https://unpkg.com/@jspsych/extension-mouse-tracking@1.0.3"></script>
    
    <!-- AI Survey æ’ä»¶ -->
    <script src="ai_survey_1.0.js"></script>
    <link rel="stylesheet" href="ai_survey_1.0.css">
    
    <style>
        body {
            font-family: 'Segoe UI', 'Microsoft YaHei', 'Open Sans', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }
        
        .demo-header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }
        
        .demo-header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .demo-header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .demo-container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .demo-nav {
            background: #f8f9fa;
            padding: 20px;
            border-bottom: 1px solid #e9ecef;
        }
        
        .demo-nav h3 {
            margin: 0 0 15px 0;
            color: #495057;
        }
        
        .api-config-panel {
            background: #fff;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .api-config-panel h4 {
            margin: 0 0 15px 0;
            color: #495057;
            font-size: 16px;
        }
        
        .config-form {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
        }
        
        .config-group {
            display: flex;
            flex-direction: column;
        }
        
        .config-group label {
            font-weight: 600;
            margin-bottom: 5px;
            color: #495057;
            font-size: 14px;
        }
        
        .config-group input,
        .config-group select {
            padding: 8px 12px;
            border: 1px solid #ced4da;
            border-radius: 4px;
            font-size: 14px;
            transition: border-color 0.3s;
        }
        
        .config-group input:focus,
        .config-group select:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 2px rgba(0,123,255,0.1);
        }
        
        .config-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        .config-btn {
            background: #6c757d;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }
        
        .config-btn:hover {
            background: #5a6268;
        }
        
        .config-btn.primary {
            background: #007bff;
        }
        
        .config-btn.primary:hover {
            background: #0056b3;
        }
        
        .config-btn.success {
            background: #28a745;
        }
        
        .config-btn.success:hover {
            background: #218838;
        }
        
        .config-btn.warning {
            background: #ffc107;
            color: #212529;
        }
        
        .config-btn.warning:hover {
            background: #e0a800;
        }
        
        .config-status {
            margin-top: 10px;
            padding: 10px;
            border-radius: 4px;
            font-size: 14px;
            display: none;
        }
        
        .config-status.success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }
        
        .config-status.error {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }
        
        .config-status.info {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            color: #0c5460;
        }
        
        .collapsible {
            cursor: pointer;
            user-select: none;
        }
        
        .collapsible:hover {
            background: #e9ecef;
        }
        
        .collapsible::after {
            content: ' â–¼';
            font-size: 12px;
            float: right;
            transition: transform 0.3s;
        }
        
        .collapsible.collapsed::after {
            transform: rotate(-90deg);
        }
        
        .collapsible-content {
            display: block;
            transition: all 0.3s;
        }
        
        .collapsible-content.hidden {
            display: none;
        }
        
        .demo-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .demo-btn {
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            color: #495057;
            border: 2px solid #dee2e6;
            padding: 15px 20px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }
        
        .demo-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }
        
        .demo-btn:hover {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            border-color: #667eea;
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(102,126,234,0.2);
        }
        
        .demo-btn:hover::before {
            transform: scaleX(1);
        }
        
        .demo-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #5a67d8;
            box-shadow: 0 4px 16px rgba(102,126,234,0.3);
        }
        
        .demo-btn.active::before {
            transform: scaleX(1);
            background: linear-gradient(90deg, #ffffff 0%, #f8f9fa 100%);
        }
        
        #jspsych-container {
            padding: 30px;
            min-height: 400px;
        }
        
        .demo-description {
            background: linear-gradient(145deg, #ffffff 0%, #f8f9fa 100%);
            border: 1px solid #e1e8ed;
            border-left: 5px solid #667eea;
            padding: 25px 30px;
            margin-bottom: 30px;
            border-radius: 0 12px 12px 0;
            box-shadow: 0 4px 16px rgba(0,0,0,0.08);
            position: relative;
        }
        
        .demo-description::before {
            content: 'ğŸ¯';
            position: absolute;
            top: -10px;
            left: 20px;
            background: white;
            padding: 5px 10px;
            border-radius: 50%;
            font-size: 20px;
        }
        
        .demo-description h4 {
            margin: 0 0 15px 0;
            color: #2c3e50;
            font-size: 20px;
            font-weight: 700;
        }
        
        .demo-description p {
            margin: 10px 0;
            color: #495057;
            line-height: 1.6;
            font-size: 15px;
        }
        
        .demo-description ul {
            margin: 15px 0;
            padding-left: 0;
        }
        
        .demo-description li {
            list-style: none;
            padding: 8px 0;
            padding-left: 25px;
            position: relative;
            color: #495057;
            line-height: 1.5;
        }
        
        .demo-description li::before {
            content: 'âœ¨';
            position: absolute;
            left: 0;
            color: #667eea;
        }
        
        /* AI Survey æ’ä»¶æ ·å¼ä¼˜åŒ– - å…¨é¢ç¾åŒ– */
        #jspsych-container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .jspsych-ai-survey {
            font-family: 'Segoe UI', 'Microsoft YaHei', Arial, sans-serif;
        }
        
        .jspsych-ai-survey-question {
            margin-bottom: 30px;
            padding: 25px;
            border: 1px solid #e1e8ed;
            border-radius: 12px;
            background: linear-gradient(145deg, #ffffff 0%, #f8f9fa 100%);
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            transition: box-shadow 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .jspsych-ai-survey-question:hover {
            box-shadow: 0 4px 16px rgba(0,0,0,0.12);
        }
        
        .jspsych-ai-survey-question::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            border-radius: 12px 12px 0 0;
        }
        
        .jspsych-ai-survey-text {
            font-size: 17px;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 20px;
            line-height: 1.5;
            padding-top: 5px;
        }
        
        .jspsych-ai-survey-input-container {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }
        
        .jspsych-ai-survey-input-section {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .jspsych-ai-survey-label {
            font-weight: 600;
            color: #34495e;
            font-size: 15px;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .jspsych-ai-survey-label::before {
            content: 'âœï¸';
            font-size: 16px;
        }
        
        .jspsych-ai-survey-textbox {
            width: 100%;
            max-width: 100%;
            box-sizing: border-box;
            padding: 16px 20px;
            border: 2px solid #e1e8ed;
            border-radius: 10px;
            font-size: 15px;
            line-height: 1.5;
            font-family: inherit;
            transition: all 0.3s ease;
            resize: vertical;
            background: #ffffff;
            min-height: 120px;
        }
        
        .jspsych-ai-survey-textbox:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 4px rgba(102,126,234,0.1);
            background: #fdfdff;
        }
        
        .jspsych-ai-survey-textbox::placeholder {
            color: #95a5a6;
            font-style: italic;
        }
        
        .jspsych-ai-survey-ai-section {
            margin-top: 30px;
            padding-top: 25px;
            border-top: 2px solid #ecf0f1;
            position: relative;
        }
        
        .jspsych-ai-survey-ai-section::before {
            content: 'AI åä½œåŒºåŸŸ';
            position: absolute;
            top: -12px;
            left: 20px;
            background: white;
            padding: 0 15px;
            font-size: 14px;
            font-weight: 600;
            color: #667eea;
        }
        
        .jspsych-ai-survey-button-group {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-bottom: 20px;
            padding: 20px;
            background: linear-gradient(145deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 10px;
            border: 1px solid #dee2e6;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
        }
        
        .jspsych-ai-survey-ai-button,
        .jspsych-ai-survey-confirm-button,
        .jspsych-ai-survey-regenerate-button,
        .jspsych-ai-survey-edit-button,
        .jspsych-ai-survey-custom-button {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 120px;
            height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            text-transform: none;
            letter-spacing: 0.3px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .jspsych-ai-survey-ai-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .jspsych-ai-survey-ai-button:hover:not(:disabled) {
            background: linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102,126,234,0.3);
        }
        
        .jspsych-ai-survey-ai-button:disabled {
            background: #95a5a6;
            cursor: not-allowed;
            transform: none;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .jspsych-ai-survey-confirm-button {
            background: linear-gradient(135deg, #00b894 0%, #00cec9 100%);
            color: white;
        }
        
        .jspsych-ai-survey-confirm-button:hover:not(:disabled) {
            background: linear-gradient(135deg, #00a085 0%, #00b7b8 100%);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,184,148,0.3);
        }
        
        .jspsych-ai-survey-regenerate-button {
            background: linear-gradient(135deg, #fdcb6e 0%, #e17055 100%);
            color: white;
        }
        
        .jspsych-ai-survey-regenerate-button:hover:not(:disabled) {
            background: linear-gradient(135deg, #f39c12 0%, #d63031 100%);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(253,203,110,0.3);
        }
        
        .jspsych-ai-survey-edit-button {
            background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
            color: white;
        }
        
        .jspsych-ai-survey-edit-button:hover:not(:disabled) {
            background: linear-gradient(135deg, #5a9bd4 0%, #2d3436 100%);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(116,185,255,0.3);
        }
        
        .jspsych-ai-survey-custom-button {
            background: linear-gradient(135deg, #fd79a8 0%, #e84393 100%);
            color: white;
        }
        
        .jspsych-ai-survey-custom-button:hover {
            background: linear-gradient(135deg, #f368a0 0%, #d63384 100%);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(253,121,168,0.3);
        }
        
        .jspsych-ai-survey-label[for*="ai-response"]::before {
            content: 'ğŸ¤–';
        }
        
        .jspsych-ai-survey-ai-response {
            width: 100%;
            max-width: 100%;
            box-sizing: border-box;
            margin-top: 15px;
            padding: 16px 20px;
            border: 2px solid #00b894;
            border-radius: 10px;
            background: linear-gradient(145deg, #f8fff8 0%, #e8f5e8 100%);
            font-size: 14px;
            line-height: 1.6;
            min-height: 120px;
            font-family: inherit;
            resize: vertical;
        }
        
        .jspsych-ai-survey-ai-response.readonly {
            background: linear-gradient(145deg, #f8f9fa 0%, #e9ecef 100%);
            border-color: #dee2e6;
            color: #495057;
        }
        
        .jspsych-ai-survey-ai-response.locked {
            background: linear-gradient(145deg, #fff3cd 0%, #ffeaa7 100%);
            border-color: #ffc107;
        }
        
        .jspsych-ai-survey-status {
            margin-top: 12px;
            padding: 10px 16px;
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            border-radius: 8px;
            font-size: 13px;
            color: #1565c0;
            font-weight: 500;
            border-left: 4px solid #2196f3;
        }
        
        .jspsych-ai-survey-loading {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 16px 20px;
            background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
            border: 1px solid #ffc107;
            border-radius: 10px;
            color: #856404;
            font-size: 14px;
            font-weight: 500;
            margin: 15px 0;
        }
        
        .loading-spinner {
            width: 20px;
            height: 20px;
            border: 3px solid rgba(133,100,4,0.3);
            border-top: 3px solid #856404;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* ä¸»æäº¤æŒ‰é’®æ ·å¼ */
        .jspsych-btn.jspsych-ai-survey {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 16px 32px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 30px auto 20px;
            display: block;
            min-width: 200px;
            box-shadow: 0 4px 12px rgba(102,126,234,0.2);
        }
        
        .jspsych-btn.jspsych-ai-survey:hover {
            background: linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102,126,234,0.3);
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .jspsych-ai-survey-question {
                padding: 20px 15px;
                margin-bottom: 25px;
            }
            
            .jspsych-ai-survey-button-group {
                padding: 15px;
                gap: 8px;
            }
            
            .jspsych-ai-survey-ai-button,
            .jspsych-ai-survey-confirm-button,
            .jspsych-ai-survey-regenerate-button,
            .jspsych-ai-survey-edit-button,
            .jspsych-ai-survey-custom-button {
                min-width: 100px;
                font-size: 13px;
                padding: 10px 16px;
            }
        }
    </style>
</head>
<body>
    <div class="demo-header">
        <h1>ğŸ§  AIå¿ƒç†å­¦å®éªŒå¹³å°</h1>
        <p>åŸºäºé¡¶çº§æœŸåˆŠå®éªŒè®¾è®¡ - å±•ç°AIæ’ä»¶åœ¨å¿ƒç†å­¦ç ”ç©¶ä¸­çš„å¼ºå¤§èƒ½åŠ›</p>
    </div>
    
    <div class="demo-container">
        <div class="demo-nav">
            <h3>é€‰æ‹©å¿ƒç†å­¦AIå®éªŒ</h3>
            <div class="demo-buttons">
                <button class="demo-btn active" onclick="runDemo('multi_plugin_integration')">ğŸ”— å¤šæ’ä»¶æ•°æ®é›†æˆ</button>
                <button class="demo-btn" onclick="runDemo('survey_choice_analysis')">ğŸ“Š é€‰æ‹©é¢˜+AIåˆ†æ</button>
                <button class="demo-btn" onclick="runDemo('reaction_time_analysis')">âš¡ ååº”æ—¶+AIæ´å¯Ÿ</button>
                <button class="demo-btn" onclick="runDemo('mouse_tracking_decision')">ğŸ–±ï¸ é¼ æ ‡è½¨è¿¹å†³ç­–</button>
                <button class="demo-btn" onclick="runDemo('comprehensive_experiment')">ğŸ§ª ç»¼åˆå®éªŒè®¾è®¡</button>
                <button class="demo-btn" onclick="runDemo('creativity_ai')">ğŸ¨ åˆ›é€ åŠ›ä¸AIåä½œ</button>
                <button class="demo-btn" onclick="runDemo('ai_personality_moral')">âš–ï¸ AIäººæ ¼é“å¾·åˆ¤æ–­</button>
                <button class="demo-btn" onclick="runDemo('multi_ai_analysis')">ğŸ”„ ä¸€æ¬¡è¾“å…¥å¤šAIåˆ†æ</button>
            </div>
            
            <!-- APIé…ç½®é¢æ¿ -->
            <div class="api-config-panel">
                <h4 class="collapsible" onclick="toggleConfigPanel()">ğŸ”§ APIé…ç½® (ç‚¹å‡»å±•å¼€/æ”¶èµ·)</h4>
                <div style="background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 4px; padding: 10px; margin: 10px 0; font-size: 14px;">
                    <strong>âš ï¸ é‡è¦æç¤ºï¼š</strong> è¦ä½¿ç”¨AIåˆ†æåŠŸèƒ½ï¼Œè¯·å…ˆé…ç½®æ‚¨çš„APIå¯†é’¥ã€‚æ²¡æœ‰APIé…ç½®åªèƒ½æ”¶é›†é—®å·æ•°æ®ï¼Œæ— æ³•ç”ŸæˆAIåˆ†ææŠ¥å‘Šã€‚
                </div>
                <div id="config-content" class="collapsible-content">
                    <div class="config-form">
                        <div class="config-group">
                            <label for="api-preset">å¿«é€Ÿé¢„è®¾ï¼š</label>
                            <select id="api-preset" onchange="loadPreset()">
                                <option value="">-- é€‰æ‹©APIé¢„è®¾ --</option>
                                <option value="deepseek">DeepSeek</option>
                                <option value="openai">OpenAI</option>
                                <option value="alibaba">é˜¿é‡Œäº‘é€šä¹‰åƒé—®</option>
                                <option value="custom">è‡ªå®šä¹‰é…ç½®</option>
                            </select>
                        </div>
                        
                        <div class="config-group">
                            <label for="api-base-url">API Base URLï¼š</label>
                            <input type="text" id="api-base-url" placeholder="https://api.deepseek.com">
                        </div>
                        
                        <div class="config-group">
                            <label for="api-endpoint">APIç«¯ç‚¹ï¼š</label>
                            <input type="text" id="api-endpoint" placeholder="/v1/chat/completions">
                        </div>
                        
                        <div class="config-group">
                            <label for="api-key">API Keyï¼š</label>
                            <input type="password" id="api-key" placeholder="sk-xxxxxxxxxxxxxxxx">
                        </div>
                        
                        <div class="config-group">
                            <label for="api-model">æ¨¡å‹åç§°ï¼š</label>
                            <input type="text" id="api-model" placeholder="qwen-max">
                        </div>
                        
                        <div class="config-group">
                            <label for="api-timeout">è¶…æ—¶æ—¶é—´(ms)ï¼š</label>
                            <input type="number" id="api-timeout" value="45000" min="5000" max="120000">
                        </div>
                    </div>
                    
                    <div class="config-actions">
                        <button class="config-btn primary" onclick="testConnection()">æµ‹è¯•è¿æ¥</button>
                        <button class="config-btn success" onclick="saveConfig()">ä¿å­˜é…ç½®</button>
                        <button class="config-btn" onclick="loadConfig()">åŠ è½½é…ç½®</button>
                        <button class="config-btn warning" onclick="resetConfig()">é‡ç½®é…ç½®</button>
                    </div>
                    
                    <div id="config-status" class="config-status"></div>
                </div>
            </div>
        </div>
        
        <div id="jspsych-container">
                <div class="demo-description">
                    <h4>ğŸ”— å¤šæ’ä»¶æ•°æ®é›†æˆæ¼”ç¤ºå¹³å°</h4>
                    <p>å±•ç¤ºå¦‚ä½•å°†jsPsychå„ç§æ’ä»¶ï¼ˆsurveyã€ååº”æ—¶ã€æŒ‰é’®å“åº”ã€é¼ æ ‡è½¨è¿¹ç­‰ï¼‰çš„æ•°æ®æ— ç¼ä¼ é€’ç»™AIè¿›è¡Œæ™ºèƒ½åˆ†æã€‚</p>
                    <div style="background: #e8f4fd; border: 1px solid #2196f3; border-radius: 4px; padding: 15px; margin: 15px 0; font-size: 14px;">
                        <strong>ğŸ¯ æ ¸å¿ƒç‰¹æ€§ï¼š</strong>
                        <ul style="margin: 10px 0; padding-left: 20px;">
                            <li><strong>å¤šæ’ä»¶å…¼å®¹ï¼š</strong>æ”¯æŒsurveyã€ååº”æ—¶ã€æŒ‰é’®å“åº”ã€é¼ æ ‡è½¨è¿¹ç­‰å„ç±»æ’ä»¶</li>
                            <li><strong>æ•°æ®å®Œæ•´ä¼ é€’ï¼š</strong>Data Generatedï¼ˆrt, response, stimulus, correctç­‰ï¼‰+ Parametersï¼ˆprompt, targetsç­‰ï¼‰</li>
                            <li><strong>æ™ºèƒ½ç»Ÿè®¡åˆ†æï¼š</strong>è‡ªåŠ¨è®¡ç®—ååº”æ—¶ç»Ÿè®¡ã€å‡†ç¡®ç‡ã€è®¤çŸ¥æŒ‡æ ‡ç­‰</li>
                            <li><strong>AIæ·±åº¦æ´å¯Ÿï¼š</strong>åŸºäºå¤šæºæ•°æ®æä¾›è®¤çŸ¥èƒ½åŠ›ã€å†³ç­–é£æ ¼ã€è¡Œä¸ºç‰¹å¾åˆ†æ</li>
                        </ul>
                    </div>
                </div>
        </div>
    </div>

    <script>
        // APIé…ç½®ç®¡ç†
        const ApiConfigManager = {
            // é¢„è®¾é…ç½®
            presets: {
                deepseek: {
                    base_url: "https://api.deepseek.com",
                    api: "/v1/chat/completions",
                    model: "deepseek-chat",
                    timeout: 30000
                },
                openai: {
                    base_url: "https://api.openai.com",
                    api: "/v1/chat/completions", 
                    model: "gpt-3.5-turbo",
                    timeout: 30000
                },
                alibaba: {
                    base_url: "https://dashscope.aliyuncs.com",
                    api: "/compatible-mode/v1/chat/completions",
                    model: "qwen-max",  // ä½¿ç”¨é€šä¹‰åƒé—®æœ€å¼ºæ¨¡å‹
                    timeout: 45000
                }
            },
            
            // è·å–å½“å‰é…ç½®
            getCurrentConfig() {
                return {
                    base_url: document.getElementById('api-base-url').value || "https://dashscope.aliyuncs.com",
                    api: document.getElementById('api-endpoint').value || "/compatible-mode/v1/chat/completions",
                    api_key: document.getElementById('api-key').value || "",
                    llm_model: document.getElementById('api-model').value || "qwen-max",
                    api_timeout: parseInt(document.getElementById('api-timeout').value) || 45000
                };
            },
            
            // è®¾ç½®é…ç½®åˆ°è¡¨å•
            setConfig(config) {
                document.getElementById('api-base-url').value = config.base_url || "";
                document.getElementById('api-endpoint').value = config.api || "";
                document.getElementById('api-key').value = config.api_key || "";
                document.getElementById('api-model').value = config.llm_model || config.model || "";
                document.getElementById('api-timeout').value = config.api_timeout || config.timeout || 45000;
            },
            
            // æ˜¾ç¤ºçŠ¶æ€æ¶ˆæ¯
            showStatus(message, type = 'info') {
                const statusDiv = document.getElementById('config-status');
                statusDiv.className = `config-status ${type}`;
                statusDiv.textContent = message;
                statusDiv.style.display = 'block';
                
                // 3ç§’åè‡ªåŠ¨éšè—
                setTimeout(() => {
                    statusDiv.style.display = 'none';
                }, 3000);
            }
        };
        
        // åˆ‡æ¢é…ç½®é¢æ¿
        function toggleConfigPanel() {
            const content = document.getElementById('config-content');
            const header = document.querySelector('.collapsible');
            
            if (content.classList.contains('hidden')) {
                content.classList.remove('hidden');
                header.classList.remove('collapsed');
            } else {
                content.classList.add('hidden');
                header.classList.add('collapsed');
            }
        }
        
        // åŠ è½½é¢„è®¾é…ç½®
        function loadPreset() {
            const preset = document.getElementById('api-preset').value;
            if (preset && ApiConfigManager.presets[preset]) {
                ApiConfigManager.setConfig(ApiConfigManager.presets[preset]);
                ApiConfigManager.showStatus(`å·²åŠ è½½ ${preset} é¢„è®¾é…ç½®`, 'success');
            }
        }
        
        // æµ‹è¯•APIè¿æ¥
        async function testConnection() {
            const config = ApiConfigManager.getCurrentConfig();
            
            if (!config.api_key.trim()) {
                ApiConfigManager.showStatus('è¯·å…ˆè¾“å…¥API Key', 'error');
                return;
            }
            
            ApiConfigManager.showStatus('æ­£åœ¨æµ‹è¯•è¿æ¥...', 'info');
            
            try {
                const url = config.base_url + config.api;
                const headers = {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${config.api_key}`
                };
                
                const testPayload = {
                    model: config.llm_model,
                    messages: [
                        { role: "user", content: "æµ‹è¯•è¿æ¥" }
                    ],
                    max_tokens: 10,
                    temperature: 0.1
                };
                
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), config.api_timeout);
                
                const response = await fetch(url, {
                    method: 'POST',
                    headers: headers,
                    body: JSON.stringify(testPayload),
                    signal: controller.signal
                });
                
                clearTimeout(timeoutId);
                
                if (response.ok) {
                    const data = await response.json();
                    ApiConfigManager.showStatus('âœ… è¿æ¥æµ‹è¯•æˆåŠŸï¼APIé…ç½®æ­£å¸¸', 'success');
                    console.log('APIæµ‹è¯•æˆåŠŸ:', data);
                } else {
                    const errorText = await response.text();
                    ApiConfigManager.showStatus(`âŒ è¿æ¥å¤±è´¥: HTTP ${response.status}`, 'error');
                    console.error('APIæµ‹è¯•å¤±è´¥:', errorText);
                }
            } catch (error) {
                if (error.name === 'AbortError') {
                    ApiConfigManager.showStatus('âŒ è¿æ¥è¶…æ—¶ï¼Œè¯·æ£€æŸ¥ç½‘ç»œå’Œé…ç½®', 'error');
                } else {
                    ApiConfigManager.showStatus(`âŒ è¿æ¥é”™è¯¯: ${error.message}`, 'error');
                }
                console.error('APIæµ‹è¯•é”™è¯¯:', error);
            }
        }
        
        // ä¿å­˜é…ç½®åˆ°localStorage
        function saveConfig() {
            const config = ApiConfigManager.getCurrentConfig();
            localStorage.setItem('ai_survey_config', JSON.stringify(config));
            ApiConfigManager.showStatus('âœ… é…ç½®å·²ä¿å­˜åˆ°æœ¬åœ°', 'success');
        }
        
        // ä»localStorageåŠ è½½é…ç½®
        function loadConfig() {
            try {
                const saved = localStorage.getItem('ai_survey_config');
                if (saved) {
                    const config = JSON.parse(saved);
                    ApiConfigManager.setConfig(config);
                    ApiConfigManager.showStatus('âœ… å·²åŠ è½½ä¿å­˜çš„é…ç½®', 'success');
                } else {
                    ApiConfigManager.showStatus('æ²¡æœ‰æ‰¾åˆ°ä¿å­˜çš„é…ç½®', 'info');
                }
            } catch (error) {
                ApiConfigManager.showStatus('åŠ è½½é…ç½®å¤±è´¥', 'error');
            }
        }
        
        // é‡ç½®é…ç½®
        function resetConfig() {
            ApiConfigManager.setConfig(ApiConfigManager.presets.alibaba);
            document.getElementById('api-preset').value = 'alibaba';
            ApiConfigManager.showStatus('âœ… å·²é‡ç½®ä¸ºæœ€æ–°æ¨¡å‹é…ç½® (Qwen-Max)', 'success');
        }
        
        // è·å–åŠ¨æ€é…ç½®ç”¨äºæ¼”ç¤º
        function getDynamicConfig() {
            const userConfig = ApiConfigManager.getCurrentConfig();
            return {
                base_url: userConfig.base_url,
                api: userConfig.api,
                api_key: userConfig.api_key,
                llm_model: userConfig.llm_model,
                api_timeout: userConfig.api_timeout
            };
        }

        // ç®€åŒ–ç‰ˆæ•°æ®ç»Ÿè®¡å‡½æ•°ï¼Œé˜²æ­¢ä¾èµ–é—®é¢˜
        function getSimpleStats(data, field = 'rt') {
            if (!data || data.count() === 0) return null;
            
            try {
                // æ–¹æ³•1ï¼šä½¿ç”¨jsPsychå†…ç½®çš„DataColumnç»Ÿè®¡æ–¹æ³•
                const dataColumn = data.select(field);
                if (!dataColumn || dataColumn.count() === 0) return null;
                
                return {
                    count: dataColumn.count(),
                    mean: dataColumn.mean(),
                    min: dataColumn.min(),
                    max: dataColumn.max(),
                    sum: dataColumn.sum(),
                    variance: dataColumn.variance(),
                    sd: dataColumn.sd(),
                    median: dataColumn.median()
                };
            } catch (error) {
                console.log('DataColumnæ–¹æ³•å¤±è´¥ï¼Œä½¿ç”¨æ‰‹åŠ¨è®¡ç®—:', error);
                
                // æ–¹æ³•2ï¼šæ‰‹åŠ¨è®¡ç®—fallback
                const rawData = data.values();
                const values = rawData.map(trial => trial[field]).filter(v => v !== null && v !== undefined && !isNaN(v));
                
                if (values.length === 0) return null;
                
                const sum = values.reduce((a, b) => a + b, 0);
                const mean = sum / values.length;
                const variance = values.reduce((a, b) => a + Math.pow(b - mean, 2), 0) / values.length;
                
                return {
                    count: values.length,
                    mean: mean,
                    min: Math.min(...values),
                    max: Math.max(...values),
                    sum: sum,
                    variance: variance,
                    sd: Math.sqrt(variance),
                    median: values.sort((a, b) => a - b)[Math.floor(values.length / 2)]
                };
            }
        }

        // å¿ƒç†å­¦AIå®éªŒé…ç½®
        const demoConfigs = {
            multi_plugin_integration: {
                title: "å¤šæ’ä»¶æ•°æ®é›†æˆæ¼”ç¤º",
                description: "å±•ç¤ºå¦‚ä½•å°†surveyã€ååº”æ—¶ã€æŒ‰é’®å“åº”ç­‰å¤šç§æ’ä»¶çš„æ•°æ®ä¼ é€’ç»™AIè¿›è¡Œç»¼åˆåˆ†æã€‚åŒ…å«Data Generatedï¼ˆrt, response, stimulusç­‰ï¼‰å’ŒParametersï¼ˆprompt, targetsç­‰ï¼‰ä¸¤ç±»æ•°æ®çš„å®Œæ•´ä¼ é€’ã€‚",
                trial: [
                    // é˜¶æ®µ1ï¼šå¤šé€‰é¢˜è°ƒæŸ¥
                    {
                        type: jsPsychSurveyMultiChoice,
                        preamble: `
                            <div style="text-align: center; margin-bottom: 30px;">
                                <h2>å¤šæ’ä»¶æ•°æ®é›†æˆ - é˜¶æ®µ1ï¼šé€‰æ‹©åå¥½è°ƒæŸ¥</h2>
                                <div style="background: #e8f5e8; border-left: 4px solid #4caf50; padding: 15px; margin: 20px 0; border-radius: 0 6px 6px 0;">
                                    <p><strong>æ•°æ®æ”¶é›†ï¼š</strong>ä½¿ç”¨survey-multi-choiceæ’ä»¶æ”¶é›†é€‰æ‹©æ•°æ®</p>
                                    <p><strong>è®°å½•ä¿¡æ¯ï¼š</strong>response, question_order, choice_options, rtç­‰</p>
                                </div>
                            </div>
                        `,
                        questions: [
                            {
                                prompt: "æ‚¨æ›´å€¾å‘äºå“ªç§å·¥ä½œæ–¹å¼ï¼Ÿ",
                                name: 'work_preference',
                                options: ['ç‹¬ç«‹å·¥ä½œ', 'å›¢é˜Ÿåä½œ', 'æ··åˆæ¨¡å¼'],
                                required: true
                            },
                            {
                                prompt: "åœ¨åšå†³ç­–æ—¶ï¼Œæ‚¨æœ€é‡è§†ä»€ä¹ˆï¼Ÿ",
                                name: 'decision_factor',
                                options: ['æ•ˆç‡ä¼˜å…ˆ', 'è´¨é‡ä¼˜å…ˆ', 'å¹³è¡¡è€ƒè™‘'],
                                required: true
                            },
                            {
                                prompt: "æ‚¨ç†æƒ³çš„åŠå…¬ç¯å¢ƒæ˜¯ï¼Ÿ",
                                name: 'office_preference',
                                options: ['å¸‚ä¸­å¿ƒï¼ˆç§Ÿé‡‘é«˜ä½†äº¤é€šä¾¿åˆ©ï¼‰', 'éƒŠåŒºï¼ˆç§Ÿé‡‘ä½ä½†é€šå‹¤å›°éš¾ï¼‰', 'æ··åˆåŠå…¬ï¼ˆéƒ¨åˆ†è¿œç¨‹ï¼‰'],
                                required: true
                            }
                        ]
                    },
                    
                    // é˜¶æ®µ2ï¼šååº”æ—¶ä»»åŠ¡
                    {
                        type: jsPsychHtmlKeyboardResponse,
                        preamble: `
                            <div style="text-align: center; margin-bottom: 30px;">
                                <h2>å¤šæ’ä»¶æ•°æ®é›†æˆ - é˜¶æ®µ2ï¼šååº”æ—¶æµ‹è¯•</h2>
                                <div style="background: #fff3e0; border-left: 4px solid #ff9800; padding: 15px; margin: 20px 0; border-radius: 0 6px 6px 0;">
                                    <p><strong>ä»»åŠ¡è¯´æ˜ï¼š</strong>çœ‹åˆ°ç»¿è‰²åœ†åœˆæ—¶æŒ‰ç©ºæ ¼é”®ï¼Œæµ‹è¯•æ‚¨çš„ååº”é€Ÿåº¦</p>
                                    <p><strong>æ•°æ®æ”¶é›†ï¼š</strong>rt, response, stimulus, correctç­‰</p>
                                </div>
                            </div>
                        `,
                        stimulus: function() {
                            const colors = ['red', 'green', 'blue'];
                            const shapes = ['circle', 'square', 'triangle'];
                            const randomColor = colors[Math.floor(Math.random() * colors.length)];
                            const randomShape = shapes[Math.floor(Math.random() * shapes.length)];
                            
                            let shapeHtml;
                            if (randomShape === 'circle') {
                                shapeHtml = `<div style="width: 100px; height: 100px; background-color: ${randomColor}; border-radius: 50%; margin: 50px auto;"></div>`;
                            } else if (randomShape === 'square') {
                                shapeHtml = `<div style="width: 100px; height: 100px; background-color: ${randomColor}; margin: 50px auto;"></div>`;
                            } else {
                                shapeHtml = `<div style="width: 0; height: 0; border-left: 50px solid transparent; border-right: 50px solid transparent; border-bottom: 87px solid ${randomColor}; margin: 50px auto;"></div>`;
                            }
                            
                            return `
                                <div style="text-align: center;">
                                    <h3>çœ‹åˆ°ç»¿è‰²åœ†åœˆæ—¶æŒ‰ç©ºæ ¼é”®</h3>
                                    ${shapeHtml}
                                    <p style="margin-top: 30px;">å½“å‰å›¾å½¢ï¼š${randomColor} ${randomShape}</p>
                                </div>
                            `;
                        },
                        choices: [' '],
                        data: function() {
                            const colors = ['red', 'green', 'blue'];
                            const shapes = ['circle', 'square', 'triangle'];
                            const randomColor = colors[Math.floor(Math.random() * colors.length)];
                            const randomShape = shapes[Math.floor(Math.random() * shapes.length)];
                            return {
                                color: randomColor,
                                shape: randomShape,
                                target: randomColor === 'green' && randomShape === 'circle',
                                task_type: 'reaction_time'
                            };
                        },
                        on_finish: function(data) {
                            data.correct = data.target && data.response === ' ';
                            data.stimulus_type = `${data.color}_${data.shape}`;
                        },
                        trial_duration: 3000,
                        prompt: "<p>æŒ‰ç©ºæ ¼é”®å“åº”ç»¿è‰²åœ†åœˆ</p>"
                    },
                    
                    // é‡å¤ååº”æ—¶ä»»åŠ¡å‡ æ¬¡
                    {
                        timeline: [
                            {
                                type: jsPsychHtmlKeyboardResponse,
                                stimulus: function() {
                                    const colors = ['red', 'green', 'blue'];
                                    const shapes = ['circle', 'square', 'triangle'];
                                    const randomColor = colors[Math.floor(Math.random() * colors.length)];
                                    const randomShape = shapes[Math.floor(Math.random() * shapes.length)];
                                    
                                    let shapeHtml;
                                    if (randomShape === 'circle') {
                                        shapeHtml = `<div style="width: 100px; height: 100px; background-color: ${randomColor}; border-radius: 50%; margin: 50px auto;"></div>`;
                                    } else if (randomShape === 'square') {
                                        shapeHtml = `<div style="width: 100px; height: 100px; background-color: ${randomColor}; margin: 50px auto;"></div>`;
                                    } else {
                                        shapeHtml = `<div style="width: 0; height: 0; border-left: 50px solid transparent; border-right: 50px solid transparent; border-bottom: 87px solid ${randomColor}; margin: 50px auto;"></div>`;
                                    }
                                    
                                    return `
                                        <div style="text-align: center;">
                                            <h3>çœ‹åˆ°ç»¿è‰²åœ†åœˆæ—¶æŒ‰ç©ºæ ¼é”®</h3>
                                            ${shapeHtml}
                                        </div>
                                    `;
                                },
                                choices: [' '],
                                data: function() {
                                    const colors = ['red', 'green', 'blue'];
                                    const shapes = ['circle', 'square', 'triangle'];
                                    const randomColor = colors[Math.floor(Math.random() * colors.length)];
                                    const randomShape = shapes[Math.floor(Math.random() * shapes.length)];
                                    return {
                                        color: randomColor,
                                        shape: randomShape,
                                        target: randomColor === 'green' && randomShape === 'circle',
                                        task_type: 'reaction_time'
                                    };
                                },
                                on_finish: function(data) {
                                    data.correct = data.target && data.response === ' ';
                                    data.stimulus_type = `${data.color}_${data.shape}`;
                                },
                                trial_duration: 3000
                            }
                        ],
                        repetitions: 5
                    },
                    
                    // é˜¶æ®µ3ï¼šæŒ‰é’®å“åº”ä»»åŠ¡
                    {
                        type: jsPsychHtmlButtonResponse,
                        preamble: `
                            <div style="text-align: center; margin-bottom: 30px;">
                                <h2>å¤šæ’ä»¶æ•°æ®é›†æˆ - é˜¶æ®µ3ï¼šæŒ‰é’®é€‰æ‹©ä»»åŠ¡</h2>
                                <div style="background: #e3f2fd; border-left: 4px solid #2196f3; padding: 15px; margin: 20px 0; border-radius: 0 6px 6px 0;">
                                    <p><strong>ä»»åŠ¡è¯´æ˜ï¼š</strong>æ ¹æ®é—®é¢˜é€‰æ‹©æœ€ä½³ç­”æ¡ˆ</p>
                                    <p><strong>æ•°æ®æ”¶é›†ï¼š</strong>button_pressed, rt, response, stimulusç­‰</p>
                                </div>
                            </div>
                        `,
                        stimulus: `
                            <div style="text-align: center; padding: 30px;">
                                <h3>æƒ…å¢ƒå†³ç­–ï¼šå·¥ä½œåœ°ç‚¹é€‰æ‹©</h3>
                                <p style="font-size: 16px; line-height: 1.6; margin: 20px 0;">
                                    å‡è®¾æ‚¨éœ€è¦ä¸ºå›¢é˜Ÿé€‰æ‹©æ–°çš„åŠå…¬åœ°ç‚¹ï¼Œè€ƒè™‘åˆ°æˆæœ¬ã€ä¾¿åˆ©æ€§å’Œå‘˜å·¥æ»¡æ„åº¦ï¼Œæ‚¨ä¼šé€‰æ‹©å“ªä¸ªé€‰é¡¹ï¼Ÿ
                                </p>
                                <div style="background: #f5f5f5; padding: 20px; border-radius: 8px; margin: 20px 0;">
                                    <p><strong>é€‰é¡¹è¯¦æƒ…ï¼š</strong></p>
                                    <p>ğŸ¢ <strong>å¸‚ä¸­å¿ƒï¼š</strong>ç§Ÿé‡‘é«˜ä½†äº¤é€šä¾¿åˆ©ï¼Œå‘˜å·¥é€šå‹¤æ–¹ä¾¿</p>
                                    <p>ğŸ˜ï¸ <strong>éƒŠåŒºï¼š</strong>ç§Ÿé‡‘ä½ä½†é€šå‹¤å›°éš¾ï¼Œéœ€è¦å‘˜å·¥é¢å¤–é€šå‹¤æ—¶é—´</p>
                                    <p>ğŸ’» <strong>æ··åˆåŠå…¬ï¼š</strong>éƒ¨åˆ†è¿œç¨‹å·¥ä½œï¼Œå¹³è¡¡æˆæœ¬å’Œä¾¿åˆ©æ€§</p>
                                </div>
                            </div>
                        `,
                        choices: ['å¸‚ä¸­å¿ƒï¼ˆç§Ÿé‡‘é«˜ä½†äº¤é€šä¾¿åˆ©ï¼‰', 'éƒŠåŒºï¼ˆç§Ÿé‡‘ä½ä½†é€šå‹¤å›°éš¾ï¼‰', 'æ··åˆåŠå…¬ï¼ˆéƒ¨åˆ†è¿œç¨‹ï¼‰'],
                        data: {
                            task_type: 'decision_making',
                            scenario: 'office_location',
                            factors: ['cost', 'convenience', 'satisfaction']
                        },
                        on_finish: function(data) {
                            data.choice_label = data.response === 0 ? 'downtown' : 
                                               data.response === 1 ? 'suburb' : 'hybrid';
                        }
                    },
                    
                    // é˜¶æ®µ4ï¼šAIç»¼åˆåˆ†æ
                    {
                        type: jsPsychAISurvey,
                        preamble: `
                            <div style="text-align: center; margin-bottom: 30px;">
                                <h2>å¤šæ’ä»¶æ•°æ®é›†æˆ - é˜¶æ®µ4ï¼šAIç»¼åˆåˆ†æ</h2>
                                <div style="background: linear-gradient(145deg, #fff 0%, #f8f9fa 100%); border: 2px solid #667eea; padding: 20px; margin: 20px 0; border-radius: 12px;">
                                    <p><strong>AIåˆ†æï¼š</strong>åŸºäºå‰é¢æ”¶é›†çš„æ‰€æœ‰æ’ä»¶æ•°æ®è¿›è¡Œç»¼åˆåˆ†æ</p>
                                    <p><strong>æ•°æ®æ¥æºï¼š</strong>Surveyé€‰æ‹© + ååº”æ—¶æ•°æ® + æŒ‰é’®å“åº” + å†³ç­–è½¨è¿¹</p>
                                </div>
                            </div>
                        `,
                        questions: [
                            {
                                prompt: "åŸºäºæ‚¨åˆšæ‰çš„æ‰€æœ‰æµ‹è¯•è¡¨ç°ï¼Œè¯·æè¿°æ‚¨åœ¨å·¥ä½œä¸­çš„å†³ç­–é£æ ¼ï¼š",
                                name: "decision_style_reflection",
                                rows: 4,
                                placeholder: "ç»“åˆåˆšæ‰çš„é€‰æ‹©å’Œååº”ï¼Œæè¿°æ‚¨çš„å†³ç­–ç‰¹ç‚¹..."
                            }
                        ],
                        data_collector: function() {
                            console.log('ğŸ” å¤šæ’ä»¶æ•°æ®æ”¶é›†å™¨ï¼šå¼€å§‹æ”¶é›†æ‰€æœ‰æ’ä»¶æ•°æ®');
                            
                            if (typeof window.currentJsPsychInstance !== 'undefined') {
                                const allData = window.currentJsPsychInstance.data.get();
                                console.log('æ‰€æœ‰è¯•éªŒæ•°æ®:', allData.values());
                                console.log('æ•°æ®æ¡æ•°:', allData.count());
                                
                                // æ”¶é›†surveyæ•°æ®
                                const surveyData = allData.filter({trial_type: 'survey-multi-choice'});
                                
                                // æ”¶é›†ååº”æ—¶æ•°æ®
                                const reactionData = allData.filter({trial_type: 'html-keyboard-response'});
                                
                                // æ”¶é›†æŒ‰é’®å“åº”æ•°æ®
                                const buttonData = allData.filter({trial_type: 'html-button-response'});
                                
                                // æ„å»ºç»¼åˆåˆ†æä¸Šä¸‹æ–‡
                                let analysisContext = "=== å¤šæ’ä»¶å®éªŒæ•°æ®ç»¼åˆåˆ†æ ===\n\n";
                                
                                // Surveyæ•°æ®åˆ†æ
                                if (surveyData.count() > 0) {
                                    const survey = surveyData.values()[0];
                                    analysisContext += "ğŸ“Š é€‰æ‹©åå¥½è°ƒæŸ¥ç»“æœï¼š\n";
                                    if (survey.response) {
                                        analysisContext += `å·¥ä½œæ–¹å¼åå¥½ï¼š${survey.response.work_preference}\n`;
                                        analysisContext += `å†³ç­–é‡ç‚¹ï¼š${survey.response.decision_factor}\n`;
                                        analysisContext += `åŠå…¬ç¯å¢ƒåå¥½ï¼š${survey.response.office_preference}\n\n`;
                                    }
                                }
                                
                                // ååº”æ—¶æ•°æ®åˆ†æ
                                if (reactionData.count() > 0) {
                                    console.log('å¼€å§‹åˆ†æååº”æ—¶æ•°æ®ï¼Œæ•°æ®æ¡æ•°:', reactionData.count());
                                    console.log('ååº”æ—¶æ•°æ®æ ·æœ¬:', reactionData.values().slice(0, 2));
                                    const rtStats = getSimpleStats(reactionData, 'rt');
                                    console.log('ååº”æ—¶ç»Ÿè®¡ç»“æœ:', rtStats);
                                    
                                    const correctTrials = reactionData.filter({correct: true});
                                    
                                    analysisContext += "âš¡ ååº”æ—¶ä»»åŠ¡è¡¨ç°ï¼š\n";
                                    analysisContext += `æ€»è¯•éªŒæ•°ï¼š${reactionData.count()}\n`;
                                    analysisContext += `æ­£ç¡®ç‡ï¼š${(correctTrials.count() / reactionData.count() * 100).toFixed(1)}%\n`;
                                    if (rtStats) {
                                        analysisContext += `å¹³å‡ååº”æ—¶ï¼š${rtStats.mean.toFixed(0)}ms\n`;
                                        analysisContext += `ååº”æ—¶æ ‡å‡†å·®ï¼š${rtStats.sd.toFixed(0)}ms\n`;
                                        analysisContext += `æœ€å¿«ååº”ï¼š${rtStats.min}ms\n`;
                                        analysisContext += `æœ€æ…¢ååº”ï¼š${rtStats.max}ms\n`;
                                    }
                                    analysisContext += "\n";
                                }
                                
                                // æŒ‰é’®å“åº”æ•°æ®åˆ†æ
                                if (buttonData.count() > 0) {
                                    const buttonTrial = buttonData.values()[0];
                                    analysisContext += "ğŸ”˜ å†³ç­–ä»»åŠ¡è¡¨ç°ï¼š\n";
                                    analysisContext += `é€‰æ‹©ç»“æœï¼š${buttonTrial.choice_label}\n`;
                                    analysisContext += `å†³ç­–æ—¶é—´ï¼š${buttonTrial.rt}ms\n`;
                                    analysisContext += `å†³ç­–åœºæ™¯ï¼šåŠå…¬åœ°ç‚¹é€‰æ‹©\n`;
                                    analysisContext += `è€ƒè™‘å› ç´ ï¼šæˆæœ¬ã€ä¾¿åˆ©æ€§ã€æ»¡æ„åº¦\n\n`;
                                }
                                
                                // æ·»åŠ åˆ†ææŒ‡å¯¼
                                analysisContext += `è¯·åŸºäºä»¥ä¸Šå¤šæºæ•°æ®è¿›è¡Œç»¼åˆåˆ†æï¼š
1. è®¤çŸ¥é£æ ¼ç‰¹å¾ï¼ˆåŸºäºååº”æ—¶å’Œå‡†ç¡®ç‡ï¼‰
2. å†³ç­–åå¥½æ¨¡å¼ï¼ˆåŸºäºé€‰æ‹©æ•°æ®ï¼‰
3. è¡Œä¸ºä¸€è‡´æ€§åˆ†æï¼ˆè·¨æ’ä»¶æ•°æ®å¯¹æ¯”ï¼‰
4. ä¸ªæ€§åŒ–å»ºè®®ï¼ˆåŸºäºç»¼åˆè¡¨ç°ï¼‰`;
                                
                                return {
                                    comprehensive_data: analysisContext,
                                    data_sources: {
                                        survey_trials: surveyData.count(),
                                        reaction_trials: reactionData.count(),
                                        button_trials: buttonData.count(),
                                        total_trials: allData.count()
                                    }
                                };
                            }
                            
                            return { comprehensive_data: "æ— æ³•è·å–å®éªŒæ•°æ®" };
                        },
                        system_prompt: `ä½ æ˜¯ä¸€ä¸ªå®éªŒå¿ƒç†å­¦å’Œæ•°æ®åˆ†æä¸“å®¶ï¼Œæ“…é•¿æ•´åˆå¤šç§å®éªŒæ•°æ®è¿›è¡Œç»¼åˆåˆ†æã€‚

è¯·åŸºäºç”¨æˆ·å®Œæˆçš„å¤šæ’ä»¶å®éªŒæ•°æ®ï¼š
1. Surveyå¤šé€‰é¢˜æ•°æ®ï¼ˆåå¥½å’Œé€‰æ‹©ï¼‰
2. ååº”æ—¶ä»»åŠ¡æ•°æ®ï¼ˆè®¤çŸ¥é€Ÿåº¦å’Œå‡†ç¡®æ€§ï¼‰
3. æŒ‰é’®å“åº”æ•°æ®ï¼ˆå†³ç­–è¿‡ç¨‹å’Œç»“æœï¼‰

è¿›è¡Œæ·±åº¦åˆ†æï¼ŒåŒ…æ‹¬ï¼š
- è®¤çŸ¥èƒ½åŠ›è¯„ä¼°ï¼ˆååº”é€Ÿåº¦ã€æ³¨æ„åŠ›ã€å‡†ç¡®æ€§ï¼‰
- å†³ç­–é£æ ¼åˆ†æï¼ˆå¿«é€Ÿvsæ·±æ€ç†Ÿè™‘ã€é£é™©åå¥½ç­‰ï¼‰
- è¡Œä¸ºä¸€è‡´æ€§æ£€éªŒï¼ˆä¸åŒä»»åŠ¡é—´çš„è¡¨ç°å…³è”ï¼‰
- ä¸ªæ€§åŒ–æ´å¯Ÿå’Œå»ºè®®

è¯·ç”¨ä¸“ä¸šä½†æ˜“æ‡‚çš„è¯­è¨€ï¼Œç»“åˆå…·ä½“æ•°æ®è¿›è¡Œåˆ†æã€‚`,
                        button_label: "æŸ¥çœ‹ç»¼åˆåˆ†ææŠ¥å‘Š"
                    }
                ]
            },
            
            survey_choice_analysis: {
                title: "é€‰æ‹©é¢˜+AIæ·±åº¦åˆ†æ",
                description: "ä½¿ç”¨survey-multi-choiceæ’ä»¶æ”¶é›†ç”¨æˆ·çš„å¤šé¡¹é€‰æ‹©ï¼Œç„¶ååˆ©ç”¨AIå¯¹é€‰æ‹©æ¨¡å¼ã€å†³ç­–é€»è¾‘è¿›è¡Œæ·±åº¦åˆ†æã€‚å±•ç¤ºå¦‚ä½•å°†é€‰æ‹©æ•°æ®ã€ååº”æ—¶é—´ã€é€‰é¡¹å‚æ•°ç­‰ä¼ é€’ç»™AIã€‚",
                trial: [
                    {
                        type: jsPsychSurveyMultiChoice,
                        preamble: `
                            <div style="text-align: center; margin-bottom: 30px;">
                                <h2>å†³ç­–é£æ ¼åˆ†æé—®å·</h2>
                                <div style="background: #e8f4fd; border-left: 4px solid #2196f3; padding: 15px; margin: 20px 0; border-radius: 0 6px 6px 0;">
                                    <p><strong>è¯´æ˜ï¼š</strong>ä»¥ä¸‹é—®é¢˜å°†å¸®åŠ©åˆ†ææ‚¨çš„å†³ç­–é£æ ¼å’Œè®¤çŸ¥ç‰¹å¾</p>
                                    <p><strong>æ•°æ®æ”¶é›†ï¼š</strong>é€‰æ‹©ç»“æœã€ååº”æ—¶é—´ã€é€‰é¡¹é¡ºåºç­‰å°†ä¼ é€’ç»™AIåˆ†æ</p>
                                </div>
                            </div>
                        `,
                        questions: [
                            {
                                prompt: "åœ¨é¢å¯¹å¤æ‚é—®é¢˜æ—¶ï¼Œæ‚¨é€šå¸¸ï¼š",
                                name: 'problem_approach',
                                options: ['ç«‹å³å‡­ç›´è§‰åšå†³å®š', 'æ”¶é›†æ‰€æœ‰ä¿¡æ¯åå†å†³å®š', 'å¯»æ±‚ä»–äººæ„è§åå†³å®š', 'å…ˆåšå°è§„æ¨¡å°è¯•å†å†³å®š'],
                                required: true
                            },
                            {
                                prompt: "æ‚¨çš„å·¥ä½œé£æ ¼æ›´å€¾å‘äºï¼š",
                                name: 'work_style',
                                options: ['å¿«é€Ÿæ‰§è¡Œï¼Œè¾¹åšè¾¹è°ƒæ•´', 'è¯¦ç»†è§„åˆ’ï¼ŒæŒ‰æ­¥éª¤æ‰§è¡Œ', 'çµæ´»åº”å˜ï¼Œéšæœºåº”å˜', 'å›¢é˜Ÿåä½œï¼Œé›†ä½“å†³ç­–'],
                                required: true
                            },
                            {
                                prompt: "åœ¨æŠ•èµ„å†³ç­–ä¸­ï¼Œæ‚¨ä¼šé€‰æ‹©ï¼š",
                                name: 'investment_style',
                                options: ['é«˜é£é™©é«˜å›æŠ¥', 'ç¨³å¥ä¿å®ˆæŠ•èµ„', 'åˆ†æ•£æŠ•èµ„ç»„åˆ', 'è·Ÿéšä¸“å®¶å»ºè®®'],
                                required: true
                            },
                            {
                                prompt: "é¢å¯¹èŒä¸šå‘å±•æœºä¼šï¼Œæ‚¨æ›´çœ‹é‡ï¼š",
                                name: 'career_priority',
                                options: ['è–ªèµ„å¾…é‡', 'å‘å±•ç©ºé—´', 'å·¥ä½œç¨³å®š', 'å›¢é˜Ÿæ°›å›´'],
                                required: true
                            },
                            {
                                prompt: "æ‚¨ç†æƒ³çš„åŠå…¬ç¯å¢ƒæ˜¯ï¼š",
                                name: 'office_preference',
                                options: ['å¸‚ä¸­å¿ƒï¼ˆç§Ÿé‡‘é«˜ä½†äº¤é€šä¾¿åˆ©ï¼‰', 'éƒŠåŒºï¼ˆç§Ÿé‡‘ä½ä½†é€šå‹¤å›°éš¾ï¼‰', 'æ··åˆåŠå…¬ï¼ˆéƒ¨åˆ†è¿œç¨‹ï¼‰', 'å®Œå…¨è¿œç¨‹å·¥ä½œ'],
                                required: true
                            }
                        ]
                    },
                    {
                        type: jsPsychAISurvey,
                        preamble: `
                            <div style="text-align: center; margin-bottom: 30px;">
                                <h2>AIå†³ç­–é£æ ¼åˆ†ææŠ¥å‘Š</h2>
                                <div style="background: linear-gradient(145deg, #fff 0%, #f8f9fa 100%); border: 2px solid #667eea; padding: 20px; margin: 20px 0; border-radius: 12px;">
                                    <p><strong>åˆ†æåŸºç¡€ï¼š</strong>åŸºäºæ‚¨çš„é€‰æ‹©æ¨¡å¼å’Œååº”æ—¶é—´æ•°æ®</p>
                                    <p><strong>AIæ´å¯Ÿï¼š</strong>æ·±åº¦è§£æå†³ç­–é£æ ¼ã€é£é™©åå¥½å’Œè®¤çŸ¥ç‰¹å¾</p>
                                </div>
                            </div>
                        `,
                        questions: [{
                            prompt: "æ‚¨çš„å†³ç­–é£æ ¼åˆ†ææŠ¥å‘Šï¼š",
                            name: "decision_analysis",
                            rows: 15,
                            columns: 80
                        }],
                        hide_user_input: true,
                        auto_generate: true,
                        show_individual_ai_areas: true,
                        data_collector: function() {
                            if (typeof window.currentJsPsychInstance !== 'undefined') {
                                const allData = window.currentJsPsychInstance.data.get();
                                const surveyData = allData.filter({trial_type: 'survey-multi-choice'}).last(1);
                                
                                if (surveyData.count() > 0) {
                                    const survey = surveyData.values()[0];
                                    const responses = survey.response;
                                    const rt = survey.rt;
                                    
                                    let analysisData = `=== å†³ç­–é£æ ¼é—®å·åˆ†ææ•°æ® ===\n\n`;
                                    analysisData += `é—®å·å®Œæˆæ—¶é—´ï¼š${rt}ms\n\n`;
                                    analysisData += `è¯¦ç»†å›ç­”ï¼š\n`;
                                    analysisData += `é—®é¢˜1 - å¤æ‚é—®é¢˜å¤„ç†ï¼š${responses.problem_approach}\n`;
                                    analysisData += `é—®é¢˜2 - å·¥ä½œé£æ ¼ï¼š${responses.work_style}\n`;
                                    analysisData += `é—®é¢˜3 - æŠ•èµ„é£æ ¼ï¼š${responses.investment_style}\n`;
                                    analysisData += `é—®é¢˜4 - èŒä¸šä¼˜å…ˆçº§ï¼š${responses.career_priority}\n`;
                                    analysisData += `é—®é¢˜5 - åŠå…¬åå¥½ï¼š${responses.office_preference}\n\n`;
                                    
                                    analysisData += `è¯·åŸºäºä»¥ä¸Šæ•°æ®åˆ†æç”¨æˆ·çš„ï¼š
1. å†³ç­–é£æ ¼ç±»å‹ï¼ˆç›´è§‰å‹/åˆ†æå‹/åä½œå‹/å®éªŒå‹ï¼‰
2. é£é™©æ‰¿å—èƒ½åŠ›ï¼ˆé«˜/ä¸­/ä½é£é™©åå¥½ï¼‰
3. å·¥ä½œè®¤çŸ¥ç‰¹å¾ï¼ˆå¿«èŠ‚å¥/ç¨³å¥å‹/çµæ´»å‹/å›¢é˜Ÿå‹ï¼‰
4. èŒä¸šå‘å±•å»ºè®®
5. ä¸ªæ€§åŒ–å·¥ä½œç¯å¢ƒæ¨è`;
                                    
                                    return { survey_analysis: analysisData };
                                }
                            }
                            return { survey_analysis: "æ— æ³•è·å–é—®å·æ•°æ®" };
                        },
                        system_prompt: "ä½ æ˜¯ä¸€ä¸ªç»„ç»‡å¿ƒç†å­¦å’Œå†³ç­–ç§‘å­¦ä¸“å®¶ï¼Œæ“…é•¿åŸºäºé€‰æ‹©è¡Œä¸ºåˆ†æä¸ªä½“çš„è®¤çŸ¥é£æ ¼å’Œå†³ç­–ç‰¹å¾ã€‚è¯·æä¾›ä¸“ä¸šã€å®ç”¨çš„åˆ†ææŠ¥å‘Šã€‚"
                    }
                ]
            },

            reaction_time_analysis: {
                title: "ååº”æ—¶+AIè®¤çŸ¥æ´å¯Ÿ",
                description: "ä½¿ç”¨é”®ç›˜å“åº”å’ŒæŒ‰é’®å“åº”æ’ä»¶æµ‹è¯•ååº”æ—¶ï¼Œæ”¶é›†rtã€responseã€stimulusã€correctç­‰æ•°æ®ï¼Œç„¶åè®©AIåˆ†æè®¤çŸ¥èƒ½åŠ›ã€æ³¨æ„åŠ›ç‰¹å¾å’Œè¡Œä¸ºæ¨¡å¼ã€‚",
                trial: [
                    // æŒ‡å¯¼è¯­
                    {
                        type: jsPsychHtmlKeyboardResponse,
                        stimulus: `
                            <div style="text-align: center; padding: 40px;">
                                <h2>è®¤çŸ¥ååº”æ—¶æµ‹è¯•</h2>
                                <div style="background: #fff3e0; border-left: 4px solid #ff9800; padding: 20px; margin: 20px 0; border-radius: 0 6px 6px 0;">
                                    <p><strong>æµ‹è¯•è¯´æ˜ï¼š</strong></p>
                                    <p>1. çœ‹åˆ°<span style="color: green; font-weight: bold;">ç»¿è‰²</span>æ•°å­—æ—¶ï¼ŒæŒ‰ç›¸åº”çš„æ•°å­—é”®</p>
                                    <p>2. çœ‹åˆ°<span style="color: red; font-weight: bold;">çº¢è‰²</span>æ•°å­—æ—¶ï¼Œä¸è¦æŒ‰ä»»ä½•é”®</p>
                                    <p>3. æˆ‘ä»¬ä¼šæµ‹é‡æ‚¨çš„ååº”æ—¶é—´å’Œå‡†ç¡®ç‡</p>
                                    <p>4. è¯·å°½å¯èƒ½å¿«é€Ÿä¸”å‡†ç¡®åœ°å“åº”</p>
                                </div>
                                <p style="font-size: 18px; margin-top: 30px;"><strong>æŒ‰ä»»æ„é”®å¼€å§‹æµ‹è¯•</strong></p>
                            </div>
                        `,
                        choices: "ALL_KEYS"
                    },
                    
                    // ååº”æ—¶æµ‹è¯•åºåˆ—
                    {
                        timeline: [
                            {
                                type: jsPsychHtmlKeyboardResponse,
                                stimulus: function() {
                                    const numbers = ['1', '2', '3', '4', '5'];
                                    const colors = ['green', 'red'];
                                    const number = jsPsych.randomization.sampleWithoutReplacement(numbers, 1)[0];
                                    const color = jsPsych.randomization.sampleWithoutReplacement(colors, 1)[0];
                                    
                                    return `
                                        <div style="text-align: center; padding: 100px;">
                                            <div style="font-size: 120px; color: ${color}; font-weight: bold;">
                                                ${number}
                                            </div>
                                        </div>
                                    `;
                                },
                                choices: ['1', '2', '3', '4', '5'],
                                trial_duration: 2000,
                                data: function() {
                                    const numbers = ['1', '2', '3', '4', '5'];
                                    const colors = ['green', 'red'];
                                    const number = jsPsych.randomization.sampleWithoutReplacement(numbers, 1)[0];
                                    const color = jsPsych.randomization.sampleWithoutReplacement(colors, 1)[0];
                                    
                                    return {
                                        stimulus_number: number,
                                        stimulus_color: color,
                                        correct_response: color === 'green' ? number : null,
                                        task_type: 'go_nogo',
                                        stimulus_type: `${color}_${number}`
                                    };
                                },
                                on_finish: function(data) {
                                    if (data.stimulus_color === 'green') {
                                        data.correct = data.response === data.stimulus_number;
                                        data.trial_type_detail = 'go_trial';
                                    } else {
                                        data.correct = data.response === null;
                                        data.trial_type_detail = 'nogo_trial';
                                    }
                                }
                            },
                            {
                                type: jsPsychHtmlKeyboardResponse,
                                stimulus: '<div style="text-align: center; padding: 50px;"><div style="font-size: 30px;">+</div></div>',
                                choices: "NO_KEYS",
                                trial_duration: 500
                            }
                        ],
                        repetitions: 20
                    },
                    
                    // Stroopä»»åŠ¡
                    {
                        type: jsPsychHtmlKeyboardResponse,
                        stimulus: `
                            <div style="text-align: center; padding: 40px;">
                                <h3>Stroopé¢œè‰²è¯ä»»åŠ¡</h3>
                                <div style="background: #e3f2fd; border-left: 4px solid #2196f3; padding: 15px; margin: 20px 0; border-radius: 0 6px 6px 0;">
                                    <p><strong>æŒ‡å¯¼ï¼š</strong>å¿½ç•¥æ–‡å­—å†…å®¹ï¼Œåªæ ¹æ®æ–‡å­—é¢œè‰²æŒ‰é”®</p>
                                    <p><strong>Ré”®</strong> = çº¢è‰²ï¼Œ<strong>Gé”®</strong> = ç»¿è‰²ï¼Œ<strong>Bé”®</strong> = è“è‰²</p>
                                </div>
                                <p><strong>æŒ‰ä»»æ„é”®å¼€å§‹</strong></p>
                            </div>
                        `,
                        choices: "ALL_KEYS"
                    },
                    
                    {
                        timeline: [
                            {
                                type: jsPsychHtmlKeyboardResponse,
                                stimulus: function() {
                                    const words = ['çº¢è‰²', 'ç»¿è‰²', 'è“è‰²'];
                                    const colors = ['red', 'green', 'blue'];
                                    const word = jsPsych.randomization.sampleWithoutReplacement(words, 1)[0];
                                    const color = jsPsych.randomization.sampleWithoutReplacement(colors, 1)[0];
                                    
                                    return `
                                        <div style="text-align: center; padding: 100px;">
                                            <div style="font-size: 60px; color: ${color}; font-weight: bold;">
                                                ${word}
                                            </div>
                                            <p style="margin-top: 30px;">R=çº¢è‰², G=ç»¿è‰², B=è“è‰²</p>
                                        </div>
                                    `;
                                },
                                choices: ['r', 'g', 'b'],
                                data: function() {
                                    const words = ['çº¢è‰²', 'ç»¿è‰²', 'è“è‰²'];
                                    const colors = ['red', 'green', 'blue'];
                                    const word = jsPsych.randomization.sampleWithoutReplacement(words, 1)[0];
                                    const color = jsPsych.randomization.sampleWithoutReplacement(colors, 1)[0];
                                    
                                    const colorKey = color === 'red' ? 'r' : color === 'green' ? 'g' : 'b';
                                    const wordMeaning = word === 'çº¢è‰²' ? 'r' : word === 'ç»¿è‰²' ? 'g' : 'b';
                                    
                                    return {
                                        word: word,
                                        color: color,
                                        correct_response: colorKey,
                                        congruent: colorKey === wordMeaning,
                                        task_type: 'stroop'
                                    };
                                },
                                on_finish: function(data) {
                                    data.correct = data.response === data.correct_response;
                                }
                            }
                        ],
                        repetitions: 15
                    },
                    
                    // AIåˆ†æé˜¶æ®µ
                    {
                        type: jsPsychAISurvey,
                        preamble: `
                            <div style="text-align: center; margin-bottom: 30px;">
                                <h2>AIè®¤çŸ¥èƒ½åŠ›åˆ†ææŠ¥å‘Š</h2>
                                <div style="background: linear-gradient(145deg, #fff 0%, #f8f9fa 100%); border: 2px solid #667eea; padding: 20px; margin: 20px 0; border-radius: 12px;">
                                    <p><strong>åˆ†ææ•°æ®ï¼š</strong>Go/NoGoä»»åŠ¡ + Stroopä»»åŠ¡çš„å®Œæ•´ååº”æ—¶æ•°æ®</p>
                                    <p><strong>è®¤çŸ¥æŒ‡æ ‡ï¼š</strong>ååº”é€Ÿåº¦ã€æŠ‘åˆ¶æ§åˆ¶ã€æ³¨æ„åŠ›ã€è®¤çŸ¥çµæ´»æ€§</p>
                                </div>
                            </div>
                        `,
                        questions: [{
                            prompt: "æ‚¨çš„è®¤çŸ¥èƒ½åŠ›åˆ†ææŠ¥å‘Šï¼š",
                            name: "cognitive_analysis",
                            rows: 18,
                            columns: 85
                        }],
                        hide_user_input: true,
                        auto_generate: true,
                        show_individual_ai_areas: true,
                        data_collector: function() {
                            if (typeof window.currentJsPsychInstance !== 'undefined') {
                                const allData = window.currentJsPsychInstance.data.get();
                                
                                // Go/NoGoæ•°æ®
                                const gonogoData = allData.filter({task_type: 'go_nogo'});
                                const goTrials = gonogoData.filter({trial_type_detail: 'go_trial'});
                                const nogoTrials = gonogoData.filter({trial_type_detail: 'nogo_trial'});
                                
                                // Stroopæ•°æ®
                                const stroopData = allData.filter({task_type: 'stroop'});
                                const congruentTrials = stroopData.filter({congruent: true});
                                const incongruentTrials = stroopData.filter({congruent: false});
                                
                                let analysis = `=== è®¤çŸ¥ååº”æ—¶æµ‹è¯•æ•°æ®åˆ†æ ===\n\n`;
                                
                                // Go/NoGoåˆ†æ
                                if (gonogoData.count() > 0) {
                                    const goStats = getSimpleStats(goTrials, 'rt');
                                    const goCorrect = goTrials.filter({correct: true});
                                    const nogoCorrect = nogoTrials.filter({correct: true});
                                    
                                    analysis += `ğŸ“Š Go/NoGoä»»åŠ¡è¡¨ç°ï¼š\n`;
                                    analysis += `æ€»è¯•éªŒæ•°ï¼š${gonogoData.count()}\n`;
                                    analysis += `Goè¯•éªŒï¼š${goTrials.count()}æ¬¡ï¼Œæ­£ç¡®ç‡ï¼š${(goCorrect.count()/goTrials.count()*100).toFixed(1)}%\n`;
                                    analysis += `NoGoè¯•éªŒï¼š${nogoTrials.count()}æ¬¡ï¼Œæ­£ç¡®ç‡ï¼š${(nogoCorrect.count()/nogoTrials.count()*100).toFixed(1)}%\n`;
                                    if (goStats) {
                                        analysis += `å¹³å‡ååº”æ—¶ï¼š${goStats.mean.toFixed(0)}ms\n`;
                                        analysis += `ååº”æ—¶å˜å¼‚æ€§ï¼š${goStats.sd.toFixed(0)}ms\n`;
                                    }
                                    analysis += `æŠ‘åˆ¶æ§åˆ¶èƒ½åŠ›ï¼š${(nogoCorrect.count()/nogoTrials.count()*100).toFixed(1)}%\n\n`;
                                }
                                
                                // Stroopåˆ†æ
                                if (stroopData.count() > 0) {
                                    const congruentStats = getSimpleStats(congruentTrials, 'rt');
                                    const incongruentStats = getSimpleStats(incongruentTrials, 'rt');
                                    
                                    const stroopEffect = (incongruentStats && congruentStats) ? incongruentStats.mean - congruentStats.mean : 0;
                                    
                                    analysis += `ğŸ¨ Stroopä»»åŠ¡è¡¨ç°ï¼š\n`;
                                    analysis += `æ€»è¯•éªŒæ•°ï¼š${stroopData.count()}\n`;
                                    analysis += `æ•´ä½“æ­£ç¡®ç‡ï¼š${(stroopData.filter({correct: true}).count()/stroopData.count()*100).toFixed(1)}%\n`;
                                    if (congruentStats && incongruentStats) {
                                        analysis += `ä¸€è‡´æ€§è¯•éªŒå¹³å‡RTï¼š${congruentStats.mean.toFixed(0)}ms\n`;
                                        analysis += `ä¸ä¸€è‡´è¯•éªŒå¹³å‡RTï¼š${incongruentStats.mean.toFixed(0)}ms\n`;
                                        analysis += `Stroopæ•ˆåº”ï¼š${stroopEffect.toFixed(0)}ms\n`;
                                    }
                                    analysis += `è®¤çŸ¥çµæ´»æ€§æŒ‡æ ‡ï¼š${stroopEffect < 100 ? 'ä¼˜ç§€' : stroopEffect < 200 ? 'è‰¯å¥½' : 'éœ€è¦æ”¹å–„'}\n\n`;
                                }
                                
                                analysis += `è¯·åŸºäºä»¥ä¸Šæ•°æ®åˆ†æç”¨æˆ·çš„ï¼š
1. ååº”é€Ÿåº¦æ°´å¹³ï¼ˆå¿«é€Ÿ/ä¸­ç­‰/è¾ƒæ…¢ï¼‰
2. æŠ‘åˆ¶æ§åˆ¶èƒ½åŠ›ï¼ˆä¼˜ç§€/è‰¯å¥½/éœ€è¦æå‡ï¼‰
3. æ³¨æ„åŠ›é›†ä¸­ç¨‹åº¦å’Œç¨³å®šæ€§
4. è®¤çŸ¥çµæ´»æ€§å’Œé€‚åº”èƒ½åŠ›
5. ä¸ªæ€§åŒ–è®¤çŸ¥è®­ç»ƒå»ºè®®`;
                                
                                return { cognitive_data: analysis };
                            }
                            return { cognitive_data: "æ— æ³•è·å–è®¤çŸ¥æµ‹è¯•æ•°æ®" };
                        },
                        system_prompt: "ä½ æ˜¯ä¸€ä¸ªè®¤çŸ¥å¿ƒç†å­¦å’Œç¥ç»å¿ƒç†å­¦ä¸“å®¶ï¼Œæ“…é•¿åŸºäºååº”æ—¶æ•°æ®åˆ†æä¸ªä½“çš„è®¤çŸ¥èƒ½åŠ›ç‰¹å¾ã€‚è¯·æä¾›ç§‘å­¦ã€ä¸“ä¸šçš„è®¤çŸ¥èƒ½åŠ›è¯„ä¼°æŠ¥å‘Šã€‚"
                    }
                ]
            },
            
            mouse_tracking_decision: {
                title: "é¼ æ ‡è½¨è¿¹å†³ç­–åˆ†æ",
                description: "ä½¿ç”¨é¼ æ ‡è½¨è¿¹æ‰©å±•è®°å½•å†³ç­–è¿‡ç¨‹ä¸­çš„é¼ æ ‡ç§»åŠ¨è½¨è¿¹ï¼Œåˆ†æå†³ç­–å†²çªã€çŠ¹è±«ç¨‹åº¦å’Œè®¤çŸ¥è´Ÿè·ã€‚å±•ç¤ºå¦‚ä½•å°†è½¨è¿¹æ•°æ®ä¼ é€’ç»™AIè¿›è¡Œæ·±åº¦è¡Œä¸ºåˆ†æã€‚",
                trial: [
                    {
                        type: jsPsychHtmlButtonResponse,
                        stimulus: `
                            <div style="text-align: center; padding: 40px;">
                                <h2>é¼ æ ‡è½¨è¿¹å†³ç­–å®éªŒ</h2>
                                <div style="background: #f3e5f5; border-left: 4px solid #9c27b0; padding: 20px; margin: 20px 0; border-radius: 0 6px 6px 0;">
                                    <p><strong>å®éªŒè¯´æ˜ï¼š</strong>æˆ‘ä»¬ä¼šè®°å½•æ‚¨çš„é¼ æ ‡ç§»åŠ¨è½¨è¿¹æ¥åˆ†æå†³ç­–è¿‡ç¨‹</p>
                                    <p><strong>æ•°æ®æ”¶é›†ï¼š</strong>mouse_tracking_data, trajectory_length, max_deviationç­‰</p>
                                </div>
                                <div style="background: #fff3cd; padding: 15px; border-radius: 8px; margin: 20px 0;">
                                    <p><strong>æƒ…å¢ƒï¼š</strong>æ‚¨æ˜¯ä¸€å®¶åˆåˆ›å…¬å¸çš„CEOï¼Œéœ€è¦åœ¨ä»¥ä¸‹ä¸‰ä¸ªæˆ˜ç•¥æ–¹å‘ä¸­åšå‡ºé€‰æ‹©ï¼š</p>
                                </div>
                            </div>
                        `,
                        choices: [
                            'ğŸš€ å¿«é€Ÿæ‰©å¼ ï¼ˆé«˜é£é™©é«˜å›æŠ¥ï¼‰',
                            'ğŸ›¡ï¸ ç¨³å¥å‘å±•ï¼ˆä½é£é™©ç¨³å®šå›æŠ¥ï¼‰', 
                            'ğŸ”„ çµæ´»è°ƒæ•´ï¼ˆä¸­ç­‰é£é™©é€‚åº”å¸‚åœºï¼‰'
                        ],
                        data: {
                            task_type: 'strategic_decision',
                            scenario: 'startup_strategy',
                            decision_factors: ['risk_level', 'return_potential', 'market_adaptation']
                        },
                        // extensions: [
                        //     {
                        //         type: jsPsychExtensionMouseTracking,
                        //         params: {
                        //             targets: ['button-0', 'button-1', 'button-2']
                        //         }
                        //     }
                        // ],
                        on_finish: function(data) {
                            data.strategy_choice = data.response === 0 ? 'aggressive' : 
                                                  data.response === 1 ? 'conservative' : 'adaptive';
                            // æ¨¡æ‹Ÿé¼ æ ‡è½¨è¿¹æ•°æ®ï¼ˆå®é™…ä½¿ç”¨æ—¶ä¼šç”±æ‰©å±•è‡ªåŠ¨æ·»åŠ ï¼‰
                            data.simulated_mouse_data = {
                                trajectory_length: Math.random() * 500 + 200,
                                max_deviation: Math.random() * 100 + 20,
                                decision_time: data.rt,
                                hesitation_points: Math.floor(Math.random() * 3) + 1
                            };
                        }
                    },
                    {
                        type: jsPsychHtmlButtonResponse,
                        stimulus: `
                            <div style="text-align: center; padding: 40px;">
                                <h3>æŠ•èµ„å†³ç­–æƒ…å¢ƒ</h3>
                                <div style="background: #e8f4fd; border-left: 4px solid #2196f3; padding: 20px; margin: 20px 0; border-radius: 0 6px 6px 0;">
                                    <p><strong>æƒ…å¢ƒï¼š</strong>æ‚¨æœ‰10ä¸‡å…ƒé—²ç½®èµ„é‡‘ï¼Œé¢ä¸´ä»¥ä¸‹æŠ•èµ„é€‰æ‹©ï¼š</p>
                                    <div style="text-align: left; margin: 15px 0;">
                                        <p>ğŸ“ˆ <strong>è‚¡ç¥¨æŠ•èµ„ï¼š</strong>é¢„æœŸå¹´æ”¶ç›Š15%ï¼Œä½†æ³¢åŠ¨è¾ƒå¤§</p>
                                        <p>ğŸ¦ <strong>é“¶è¡Œç†è´¢ï¼š</strong>é¢„æœŸå¹´æ”¶ç›Š4%ï¼Œé£é™©å¾ˆä½</p>
                                        <p>ğŸ  <strong>æˆ¿åœ°äº§ï¼š</strong>é¢„æœŸå¹´æ”¶ç›Š8%ï¼Œéœ€è¦å¤§é¢èµ„é‡‘</p>
                                        <p>ğŸ’° <strong>åŸºé‡‘ç»„åˆï¼š</strong>é¢„æœŸå¹´æ”¶ç›Š10%ï¼Œé£é™©é€‚ä¸­</p>
                                    </div>
                                </div>
                            </div>
                        `,
                        choices: [
                            'ğŸ“ˆ è‚¡ç¥¨æŠ•èµ„ï¼ˆé«˜æ”¶ç›Šé«˜é£é™©ï¼‰',
                            'ğŸ¦ é“¶è¡Œç†è´¢ï¼ˆä½æ”¶ç›Šä½é£é™©ï¼‰',
                            'ğŸ  æˆ¿åœ°äº§æŠ•èµ„ï¼ˆä¸­ç­‰æ”¶ç›Šï¼‰',
                            'ğŸ’° åŸºé‡‘ç»„åˆï¼ˆå¹³è¡¡é€‰æ‹©ï¼‰'
                        ],
                        data: {
                            task_type: 'investment_decision',
                            scenario: 'personal_investment',
                            decision_factors: ['return_rate', 'risk_level', 'liquidity']
                        },
                        on_finish: function(data) {
                            const choices = ['stock', 'bank', 'real_estate', 'fund'];
                            data.investment_choice = choices[data.response];
                            // æ¨¡æ‹Ÿé¼ æ ‡è½¨è¿¹æ•°æ®
                            data.simulated_mouse_data = {
                                trajectory_length: Math.random() * 600 + 300,
                                max_deviation: Math.random() * 120 + 30,
                                decision_time: data.rt,
                                hesitation_points: Math.floor(Math.random() * 4) + 1
                            };
                        }
                    },
                    {
                        type: jsPsychAISurvey,
                        preamble: `
                            <div style="text-align: center; margin-bottom: 30px;">
                                <h2>AIé¼ æ ‡è½¨è¿¹è¡Œä¸ºåˆ†æ</h2>
                                <div style="background: linear-gradient(145deg, #fff 0%, #f8f9fa 100%); border: 2px solid #667eea; padding: 20px; margin: 20px 0; border-radius: 12px;">
                                    <p><strong>åˆ†ææ•°æ®ï¼š</strong>é¼ æ ‡è½¨è¿¹ + å†³ç­–æ—¶é—´ + é€‰æ‹©ç»“æœ</p>
                                    <p><strong>è¡Œä¸ºæ´å¯Ÿï¼š</strong>å†³ç­–å†²çªã€çŠ¹è±«ç¨‹åº¦ã€è®¤çŸ¥é£æ ¼åˆ†æ</p>
                                </div>
                            </div>
                        `,
                        questions: [{
                            prompt: "æ‚¨çš„é¼ æ ‡è½¨è¿¹å†³ç­–è¡Œä¸ºåˆ†æï¼š",
                            name: "mouse_tracking_analysis",
                            rows: 15,
                            columns: 85
                        }],
                        hide_user_input: true,
                        auto_generate: true,
                        show_individual_ai_areas: true,
                        data_collector: function() {
                            if (typeof window.currentJsPsychInstance !== 'undefined') {
                                const allData = window.currentJsPsychInstance.data.get();
                                const decisionData = allData.filter({trial_type: 'html-button-response'});
                                
                                let analysis = `=== é¼ æ ‡è½¨è¿¹å†³ç­–è¡Œä¸ºåˆ†æ ===\n\n`;
                                
                                if (decisionData.count() > 0) {
                                    decisionData.values().forEach((trial, index) => {
                                        analysis += `å†³ç­–${index + 1} - ${trial.scenario}ï¼š\n`;
                                        analysis += `é€‰æ‹©ç»“æœï¼š${trial.strategy_choice || trial.investment_choice}\n`;
                                        analysis += `å†³ç­–æ—¶é—´ï¼š${trial.rt}ms\n`;
                                        
                                        if (trial.simulated_mouse_data) {
                                            const mouseData = trial.simulated_mouse_data;
                                            analysis += `è½¨è¿¹é•¿åº¦ï¼š${mouseData.trajectory_length.toFixed(0)}px\n`;
                                            analysis += `æœ€å¤§åç¦»ï¼š${mouseData.max_deviation.toFixed(0)}px\n`;
                                            analysis += `çŠ¹è±«ç‚¹æ•°ï¼š${mouseData.hesitation_points}\n`;
                                            analysis += `å†³ç­–å¤æ‚åº¦æŒ‡æ•°ï¼š${(mouseData.max_deviation / mouseData.trajectory_length * 100).toFixed(1)}%\n`;
                                        }
                                        analysis += '\n';
                                    });
                                    
                                    // ç»¼åˆåˆ†æ
                                    const avgRT = decisionData.select('rt').mean();
                                    analysis += `å¹³å‡å†³ç­–æ—¶é—´ï¼š${avgRT.toFixed(0)}ms\n`;
                                    analysis += `å†³ç­–é£æ ¼ç‰¹å¾ï¼š${avgRT > 5000 ? 'æ·±æ€ç†Ÿè™‘å‹' : avgRT > 2000 ? 'å¹³è¡¡è€ƒè™‘å‹' : 'å¿«é€Ÿå†³æ–­å‹'}\n\n`;
                                }
                                
                                analysis += `è¯·åŸºäºé¼ æ ‡è½¨è¿¹å’Œå†³ç­–æ•°æ®åˆ†æï¼š
1. å†³ç­–å†²çªç¨‹åº¦ï¼ˆåŸºäºè½¨è¿¹åç¦»åº¦ï¼‰
2. è®¤çŸ¥è´Ÿè·æ°´å¹³ï¼ˆåŸºäºè½¨è¿¹å¤æ‚åº¦ï¼‰
3. å†³ç­–é£æ ¼ç‰¹å¾ï¼ˆç›´è§‰å‹vsåˆ†æå‹ï¼‰
4. é£é™©åå¥½å€¾å‘
5. å†³ç­–ä¼˜åŒ–å»ºè®®`;
                                
                                return { mouse_tracking_data: analysis };
                            }
                            return { mouse_tracking_data: "æ— æ³•è·å–é¼ æ ‡è½¨è¿¹æ•°æ®" };
                        },
                        system_prompt: "ä½ æ˜¯ä¸€ä¸ªè¡Œä¸ºç»æµå­¦å’Œå†³ç­–ç§‘å­¦ä¸“å®¶ï¼Œæ“…é•¿é€šè¿‡é¼ æ ‡è½¨è¿¹æ•°æ®åˆ†æå†³ç­–è¿‡ç¨‹å’Œè®¤çŸ¥ç‰¹å¾ã€‚è¯·æä¾›ä¸“ä¸šçš„è¡Œä¸ºåˆ†ææŠ¥å‘Šã€‚"
                    }
                ]
            },
            
            comprehensive_experiment: {
                title: "ç»¼åˆå®éªŒè®¾è®¡",
                description: "å®Œæ•´çš„å¤šæ’ä»¶å®éªŒæµç¨‹ï¼šé—®å·è°ƒæŸ¥â†’ååº”æ—¶æµ‹è¯•â†’é€‰æ‹©å†³ç­–â†’é¼ æ ‡è½¨è¿¹â†’AIç»¼åˆåˆ†æã€‚å±•ç¤ºå¦‚ä½•åœ¨ä¸€ä¸ªå®éªŒä¸­æ•´åˆæ‰€æœ‰ç±»å‹çš„æ•°æ®å¹¶ä¼ é€’ç»™AIè¿›è¡Œå…¨æ–¹ä½åˆ†æã€‚",
                trial: [
                    // é˜¶æ®µ1ï¼šèƒŒæ™¯é—®å·
                    {
                        type: jsPsychSurveyMultiChoice,
                        preamble: `
                            <div style="text-align: center; margin-bottom: 30px;">
                                <h2>ç»¼åˆå®éªŒ - é˜¶æ®µ1ï¼šèƒŒæ™¯ä¿¡æ¯è°ƒæŸ¥</h2>
                                <div style="background: #e8f5e8; border-left: 4px solid #4caf50; padding: 15px; margin: 20px 0; border-radius: 0 6px 6px 0;">
                                    <p><strong>ç›®æ ‡ï¼š</strong>æ”¶é›†åŸºç¡€è®¤çŸ¥é£æ ¼å’Œä¸ªæ€§ç‰¹å¾æ•°æ®</p>
                                </div>
                            </div>
                        `,
                        questions: [
                            {
                                prompt: "æ‚¨çš„å†³ç­–é£æ ¼æ›´åå‘äºï¼š",
                                name: 'decision_style',
                                options: ['ç›´è§‰å¯¼å‘', 'æ•°æ®é©±åŠ¨', 'ä»–äººå»ºè®®', 'ç»éªŒä¾èµ–'],
                                required: true
                            },
                            {
                                prompt: "é¢å¯¹é£é™©æ—¶ï¼Œæ‚¨é€šå¸¸ï¼š",
                                name: 'risk_attitude',
                                options: ['ç§¯ææ‰¿æ‹…', 'è°¨æ…è¯„ä¼°', 'å°½é‡å›é¿', 'å¯»æ±‚å¹³è¡¡'],
                                required: true
                            }
                        ]
                    },
                    
                    // é˜¶æ®µ2ï¼šæ³¨æ„åŠ›æµ‹è¯•
                    {
                        type: jsPsychHtmlKeyboardResponse,
                        stimulus: `
                            <div style="text-align: center; padding: 40px;">
                                <h2>ç»¼åˆå®éªŒ - é˜¶æ®µ2ï¼šæ³¨æ„åŠ›æµ‹è¯•</h2>
                                <div style="background: #fff3e0; border-left: 4px solid #ff9800; padding: 15px; margin: 20px 0; border-radius: 0 6px 6px 0;">
                                    <p><strong>ä»»åŠ¡ï¼š</strong>å½“å±å¹•å‡ºç°è“è‰²åœ†åœˆæ—¶æŒ‰ç©ºæ ¼é”®</p>
                                    <p><strong>æ³¨æ„ï¼š</strong>å¿½ç•¥å…¶ä»–é¢œè‰²å’Œå½¢çŠ¶</p>
                                </div>
                                <p><strong>æŒ‰ä»»æ„é”®å¼€å§‹</strong></p>
                            </div>
                        `,
                        choices: "ALL_KEYS"
                    },
                    
                    {
                        timeline: [
                            {
                                type: jsPsychHtmlKeyboardResponse,
                                stimulus: function() {
                                    const colors = ['blue', 'red', 'green', 'yellow'];
                                    const shapes = ['circle', 'square'];
                                    const color = jsPsych.randomization.sampleWithoutReplacement(colors, 1)[0];
                                    const shape = jsPsych.randomization.sampleWithoutReplacement(shapes, 1)[0];
                                    
                                    let shapeHtml;
                                    if (shape === 'circle') {
                                        shapeHtml = `<div style="width: 80px; height: 80px; background-color: ${color}; border-radius: 50%; margin: 50px auto;"></div>`;
                                    } else {
                                        shapeHtml = `<div style="width: 80px; height: 80px; background-color: ${color}; margin: 50px auto;"></div>`;
                                    }
                                    
                                    return `<div style="text-align: center;">${shapeHtml}</div>`;
                                },
                                choices: [' '],
                                trial_duration: 1500,
                                data: function() {
                                    const colors = ['blue', 'red', 'green', 'yellow'];
                                    const shapes = ['circle', 'square'];
                                    const color = jsPsych.randomization.sampleWithoutReplacement(colors, 1)[0];
                                    const shape = jsPsych.randomization.sampleWithoutReplacement(shapes, 1)[0];
                                    return {
                                        stimulus_color: color,
                                        stimulus_shape: shape,
                                        target: color === 'blue' && shape === 'circle',
                                        task_type: 'attention_test'
                                    };
                                },
                                on_finish: function(data) {
                                    data.correct = data.target ? (data.response === ' ') : (data.response === null);
                                }
                            }
                        ],
                        repetitions: 10
                    },
                    
                    // é˜¶æ®µ3ï¼šå¤æ‚å†³ç­–ä»»åŠ¡
                    {
                        type: jsPsychHtmlButtonResponse,
                        stimulus: `
                            <div style="text-align: center; padding: 30px;">
                                <h2>ç»¼åˆå®éªŒ - é˜¶æ®µ3ï¼šå¤æ‚å†³ç­–</h2>
                                <div style="background: #e3f2fd; border-left: 4px solid #2196f3; padding: 15px; margin: 20px 0; border-radius: 0 6px 6px 0;">
                                    <p><strong>æƒ…å¢ƒï¼š</strong>æ‚¨æ˜¯é¡¹ç›®ç»ç†ï¼Œéœ€è¦åœ¨ç´§æ€¥æƒ…å†µä¸‹åšå‡ºå†³ç­–</p>
                                </div>
                                <div style="background: #f5f5f5; padding: 20px; border-radius: 8px; margin: 20px 0; text-align: left;">
                                    <h4>èƒŒæ™¯ï¼š</h4>
                                    <p>é¡¹ç›®æˆªæ­¢æ—¥æœŸä¸´è¿‘ï¼Œä½†é‡åˆ°æŠ€æœ¯éš¾é¢˜ã€‚å›¢é˜Ÿåˆ†ä¸ºä¸‰ç§æ„è§ï¼š</p>
                                    <p>ğŸ”¥ <strong>åŠ ç­è§£å†³ï¼š</strong>æŠ•å…¥æ›´å¤šäººåŠ›ï¼Œç¡®ä¿æŒ‰æ—¶å®Œæˆ</p>
                                    <p>ğŸ“… <strong>å»¶æœŸäº¤ä»˜ï¼š</strong>ç”³è¯·å»¶æœŸï¼Œä¿è¯è´¨é‡ä½†å½±å“ä¿¡èª‰</p>
                                    <p>âš¡ <strong>ç®€åŒ–æ–¹æ¡ˆï¼š</strong>åˆ å‡åŠŸèƒ½ï¼ŒæŒ‰æ—¶äº¤ä»˜åŸºç¡€ç‰ˆæœ¬</p>
                                </div>
                            </div>
                        `,
                        choices: [
                            'ğŸ”¥ åŠ ç­è§£å†³ï¼ˆé«˜æˆæœ¬é«˜è´¨é‡ï¼‰',
                            'ğŸ“… å»¶æœŸäº¤ä»˜ï¼ˆä¿è´¨é‡æŸä¿¡èª‰ï¼‰',
                            'âš¡ ç®€åŒ–æ–¹æ¡ˆï¼ˆæŒ‰æ—¶ä½†åŠŸèƒ½å‡å°‘ï¼‰'
                        ],
                        data: {
                            task_type: 'complex_decision',
                            scenario: 'project_crisis',
                            factors: ['time', 'quality', 'cost', 'reputation']
                        },
                        on_finish: function(data) {
                            const strategies = ['overtime', 'delay', 'simplify'];
                            data.crisis_strategy = strategies[data.response];
                        }
                    },
                    
                    // é˜¶æ®µ4ï¼šAIç»¼åˆåˆ†æ
                    {
                        type: jsPsychAISurvey,
                        preamble: `
                            <div style="text-align: center; margin-bottom: 30px;">
                                <h2>ç»¼åˆå®éªŒ - AIå…¨æ–¹ä½åˆ†ææŠ¥å‘Š</h2>
                                <div style="background: linear-gradient(145deg, #fff 0%, #f8f9fa 100%); border: 2px solid #667eea; padding: 20px; margin: 20px 0; border-radius: 12px;">
                                    <p><strong>æ•°æ®æ•´åˆï¼š</strong>é—®å· + ååº”æ—¶ + å†³ç­– + è¡Œä¸ºæ¨¡å¼</p>
                                    <p><strong>åˆ†æç»´åº¦ï¼š</strong>è®¤çŸ¥èƒ½åŠ› + å†³ç­–é£æ ¼ + é£é™©åå¥½ + è¡Œä¸ºç‰¹å¾</p>
                                </div>
                            </div>
                        `,
                        questions: [
                            {
                                prompt: "è¯·åˆ†äº«æ‚¨å¯¹è¿™æ¬¡ç»¼åˆæµ‹è¯•çš„æ„Ÿå—å’Œä½“éªŒï¼š",
                                name: "test_experience",
                                rows: 4,
                                placeholder: "æè¿°æ‚¨åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­çš„æ„Ÿå—ã€å›°éš¾æˆ–å‘ç°..."
                            }
                        ],
                        data_collector: function() {
                            if (typeof window.currentJsPsychInstance !== 'undefined') {
                                const allData = window.currentJsPsychInstance.data.get();
                                
                                // é—®å·æ•°æ®
                                const surveyData = allData.filter({trial_type: 'survey-multi-choice'});
                                
                                // æ³¨æ„åŠ›æµ‹è¯•æ•°æ®
                                const attentionData = allData.filter({task_type: 'attention_test'});
                                
                                // å†³ç­–æ•°æ®
                                const decisionData = allData.filter({task_type: 'complex_decision'});
                                
                                let analysis = `=== ç»¼åˆå®éªŒæ•°æ®å…¨æ–¹ä½åˆ†æ ===\n\n`;
                                
                                // èƒŒæ™¯ä¿¡æ¯åˆ†æ
                                if (surveyData.count() > 0) {
                                    const survey = surveyData.values()[0];
                                    analysis += `ğŸ“‹ èƒŒæ™¯ä¿¡æ¯ï¼š\n`;
                                    analysis += `å†³ç­–é£æ ¼åå¥½ï¼š${survey.response.decision_style}\n`;
                                    analysis += `é£é™©æ€åº¦ï¼š${survey.response.risk_attitude}\n`;
                                    analysis += `é—®å·å®Œæˆæ—¶é—´ï¼š${survey.rt}ms\n\n`;
                                }
                                
                                // æ³¨æ„åŠ›æµ‹è¯•åˆ†æ
                                if (attentionData.count() > 0) {
                                    const attentionStats = getSimpleStats(attentionData, 'rt');
                                    const correctTrials = attentionData.filter({correct: true});
                                    
                                    analysis += `ğŸ¯ æ³¨æ„åŠ›æµ‹è¯•è¡¨ç°ï¼š\n`;
                                    analysis += `æ€»è¯•éªŒæ•°ï¼š${attentionData.count()}\n`;
                                    analysis += `æ­£ç¡®ç‡ï¼š${(correctTrials.count() / attentionData.count() * 100).toFixed(1)}%\n`;
                                    if (attentionStats) {
                                        analysis += `å¹³å‡ååº”æ—¶ï¼š${attentionStats.mean.toFixed(0)}ms\n`;
                                        analysis += `ååº”ç¨³å®šæ€§ï¼ˆSDï¼‰ï¼š${attentionStats.sd.toFixed(0)}ms\n`;
                                    }
                                    analysis += `æ³¨æ„åŠ›é›†ä¸­åº¦ï¼š${correctTrials.count() / attentionData.count() > 0.8 ? 'ä¼˜ç§€' : 'ä¸€èˆ¬'}\n\n`;
                                }
                                
                                // å¤æ‚å†³ç­–åˆ†æ
                                if (decisionData.count() > 0) {
                                    const decision = decisionData.values()[0];
                                    analysis += `ğŸ¤” å¤æ‚å†³ç­–è¡¨ç°ï¼š\n`;
                                    analysis += `å±æœºåº”å¯¹ç­–ç•¥ï¼š${decision.crisis_strategy}\n`;
                                    analysis += `å†³ç­–æ—¶é—´ï¼š${decision.rt}ms\n`;
                                    analysis += `å†³ç­–é€Ÿåº¦ç±»å‹ï¼š${decision.rt > 10000 ? 'æ·±æ€ç†Ÿè™‘å‹' : decision.rt > 5000 ? 'å¹³è¡¡è€ƒè™‘å‹' : 'å¿«é€Ÿå†³æ–­å‹'}\n\n`;
                                }
                                
                                analysis += `è¯·åŸºäºä»¥ä¸Šç»¼åˆæ•°æ®è¿›è¡Œå…¨æ–¹ä½åˆ†æï¼š
1. è®¤çŸ¥èƒ½åŠ›è¯„ä¼°ï¼ˆæ³¨æ„åŠ›ã€ååº”é€Ÿåº¦ã€ç¨³å®šæ€§ï¼‰
2. å†³ç­–é£æ ¼ç‰¹å¾ï¼ˆç›´è§‰vsç†æ€§ã€å¿«é€Ÿvsæ·±æ€ï¼‰
3. é£é™©åå¥½æ¨¡å¼ï¼ˆç§¯ævsä¿å®ˆã€å¹³è¡¡vsæç«¯ï¼‰
4. è¡Œä¸ºä¸€è‡´æ€§éªŒè¯ï¼ˆé—®å·å›ç­”ä¸å®é™…è¡¨ç°çš„å¯¹æ¯”ï¼‰
5. ä¸ªæ€§åŒ–å‘å±•å»ºè®®ï¼ˆåŸºäºç»¼åˆè¡¨ç°çš„æˆé•¿æ–¹å‘ï¼‰
6. é€‚åˆçš„å·¥ä½œç¯å¢ƒå’Œè§’è‰²æ¨è`;
                                
                                return { comprehensive_analysis: analysis };
                            }
                            return { comprehensive_analysis: "æ— æ³•è·å–ç»¼åˆå®éªŒæ•°æ®" };
                        },
                        system_prompt: `ä½ æ˜¯ä¸€ä¸ªç»¼åˆæ€§å¿ƒç†æµ‹è¯„ä¸“å®¶ï¼Œæ“…é•¿æ•´åˆå¤šç»´åº¦æ•°æ®è¿›è¡Œå…¨æ–¹ä½åˆ†æã€‚

è¯·åŸºäºç”¨æˆ·çš„ç»¼åˆå®éªŒæ•°æ®ï¼š
- é—®å·è°ƒæŸ¥ï¼ˆå†³ç­–åå¥½ã€é£é™©æ€åº¦ï¼‰
- æ³¨æ„åŠ›æµ‹è¯•ï¼ˆååº”æ—¶ã€å‡†ç¡®ç‡ï¼‰
- å¤æ‚å†³ç­–ï¼ˆç­–ç•¥é€‰æ‹©ã€å†³ç­–æ—¶é—´ï¼‰
- ä¸»è§‚ä½“éªŒï¼ˆæµ‹è¯•æ„Ÿå—ï¼‰

è¿›è¡Œæ·±åº¦ç»¼åˆåˆ†æï¼Œæä¾›ï¼š
1. ç§‘å­¦çš„è®¤çŸ¥èƒ½åŠ›è¯„ä¼°
2. å‡†ç¡®çš„å†³ç­–é£æ ¼ç”»åƒ
3. å¯é çš„é£é™©åå¥½åˆ†æ
4. å®ç”¨çš„ä¸ªæ€§åŒ–å»ºè®®
5. å…·ä½“çš„èŒä¸šå‘å±•æ–¹å‘

è¯·ç”¨ä¸“ä¸šä¸”æ˜“æ‡‚çš„è¯­è¨€ï¼Œç»“åˆå…·ä½“æ•°æ®æä¾›å…¨é¢çš„åˆ†ææŠ¥å‘Šã€‚`
                    }
                ]
            },
            
            creativity_ai: {
                title: "åˆ›é€ åŠ›ä¸AIåä½œå®éªŒ",
                description: "åŸºäºScience Advances 2024è®ºæ–‡ã€Šç”Ÿæˆæ€§AIå¢å¼ºä¸ªä½“åˆ›é€ åŠ›ä½†å‡å°‘é›†ä½“å¤šæ ·æ€§ã€‹çš„å®éªŒè®¾è®¡ï¼Œæ¢ç´¢äººç±»ä¸AIåœ¨åˆ›é€ æ€§ä»»åŠ¡ä¸­çš„åä½œæ¨¡å¼ã€‚",
                trial: [
                    // é˜¶æ®µ1ï¼šåŸºçº¿åˆ›é€ åŠ›æµ‹è¯•
                    {
                    type: jsPsychAISurvey,
                    preamble: `
                            <div style="text-align: center; margin-bottom: 30px;">
                                <h2>åˆ›é€ åŠ›ä¸AIåä½œå®éªŒ - é˜¶æ®µ1</h2>
                                <div style="background: #e8f5e8; border-left: 4px solid #4caf50; padding: 15px; margin: 20px 0; border-radius: 0 6px 6px 0;">
                                    <p><strong>å®éªŒç›®æ ‡ï¼š</strong>æ¢ç´¢äººç±»ç‹¬ç«‹åˆ›é€ åŠ›åŸºçº¿æ°´å¹³</p>
                                    <p><strong>ä»»åŠ¡è¯´æ˜ï¼š</strong>è¯·ç‹¬ç«‹å®Œæˆä»¥ä¸‹åˆ›é€ æ€§ä»»åŠ¡ï¼Œä¸è¦ä½¿ç”¨ä»»ä½•AIå·¥å…·è¾…åŠ©ã€‚æˆ‘ä»¬å°†è®°å½•æ‚¨çš„åˆ›ä½œè¿‡ç¨‹å’Œååº”æ—¶é—´ã€‚</p>
                                </div>
                        </div>
                    `,
                    questions: [
                        {
                                prompt: "åˆ›æ„æ•…äº‹åˆ›ä½œï¼šè¯·ä¸º'æ—¶é—´æ—…è¡Œè€…çš„å›°å¢ƒ'è¿™ä¸ªä¸»é¢˜åˆ›ä½œä¸€ä¸ªç‹¬ç‰¹çš„æ•…äº‹å¼€å¤´ï¼ˆ200-300å­—ï¼‰",
                                placeholder: "å‘æŒ¥æ‚¨çš„æƒ³è±¡åŠ›ï¼Œåˆ›ä½œä¸€ä¸ªå¼•äººå…¥èƒœçš„æ•…äº‹å¼€å¤´...",
                                rows: 8,
                            required: true,
                                name: "baseline_story",
                                record_reaction_time: true
                            },
                            {
                                prompt: "é—®é¢˜è§£å†³æ–¹æ¡ˆï¼šå¦‚ä½•è§£å†³åŸå¸‚äº¤é€šæ‹¥å µé—®é¢˜ï¼Ÿè¯·æå‡º3ä¸ªåˆ›æ–°æ€§è§£å†³æ–¹æ¡ˆ",
                                placeholder: "æ€è€ƒåˆ›æ–°çš„ã€å®ç”¨çš„è§£å†³æ–¹æ¡ˆ...",
                                rows: 6,
                                required: true,
                                name: "baseline_solutions",
                                record_reaction_time: true
                            }
                        ],
                        // åŸºçº¿é˜¶æ®µï¼šéšè—AIåŠŸèƒ½
                        hide_ai_features: true,
                        show_individual_ai_areas: false,
                        // extensions: [
                        //     {
                        //         type: jsPsychExtensionMouseTracking,
                        //         params: {}
                        //     }
                        // ],
                        system_prompt: "ä½ æ˜¯ä¸€ä¸ªåˆ›é€ åŠ›ç ”ç©¶ä¸“å®¶ï¼Œè¯·ä»åˆ›æ–°æ€§ã€å®ç”¨æ€§ã€æµç•…æ€§ä¸‰ä¸ªç»´åº¦ç®€è¦è¯„ä»·ç”¨æˆ·çš„åˆ›ä½œã€‚",
                        button_label: "å®ŒæˆåŸºçº¿æµ‹è¯•"
                    },
                    
                    // é˜¶æ®µ2ï¼šAIåä½œåˆ›é€ åŠ›æµ‹è¯•
                    {
                        type: jsPsychAISurvey,
                        preamble: `
                            <div style="text-align: center; margin-bottom: 30px;">
                                <h2>åˆ›é€ åŠ›ä¸AIåä½œå®éªŒ - é˜¶æ®µ2</h2>
                                <div style="background: #e3f2fd; border-left: 4px solid #2196f3; padding: 15px; margin: 20px 0; border-radius: 0 6px 6px 0;">
                                    <p><strong>åä½œæ¨¡å¼ï¼š</strong>ç°åœ¨æ‚¨å¯ä»¥ä¸AIåä½œå®Œæˆåˆ›é€ æ€§ä»»åŠ¡</p>
                                    <p><strong>äº¤äº’æ–¹å¼ï¼š</strong>AIä¼šæ ¹æ®æ‚¨çš„è¾“å…¥æä¾›åˆ›æ„å»ºè®®å’Œæ”¹è¿›æ„è§ï¼Œæ‚¨å¯ä»¥é€‰æ‹©é‡‡çº³ã€ä¿®æ”¹æˆ–æ‹’ç»</p>
                                </div>
                            </div>
                        `,
                        questions: [
                            {
                                prompt: "AIåä½œæ•…äº‹åˆ›ä½œï¼šç»§ç»­å®Œå–„æ‚¨çš„'æ—¶é—´æ—…è¡Œè€…çš„å›°å¢ƒ'æ•…äº‹ï¼ŒAIå°†æä¾›åˆ›æ„å»ºè®®",
                                placeholder: "åœ¨AIçš„ååŠ©ä¸‹ç»§ç»­åˆ›ä½œ...",
                                rows: 10,
                                required: true,
                                name: "ai_assisted_story",
                                record_reaction_time: true
                            },
                            {
                                prompt: "AIåä½œé—®é¢˜è§£å†³ï¼šä¸AIä¸€èµ·ä¼˜åŒ–æ‚¨çš„äº¤é€šæ‹¥å µè§£å†³æ–¹æ¡ˆ",
                                placeholder: "ç»“åˆAIå»ºè®®å®Œå–„æ‚¨çš„è§£å†³æ–¹æ¡ˆ...",
                                rows: 8,
                                required: true,
                                name: "ai_assisted_solutions",
                                record_reaction_time: true
                        }
                    ],
                    enable_advanced_buttons: true,
                    button_config: {
                        show_confirm: true,
                        show_regenerate: true,
                            show_edit: false, // åœ¨åˆ›é€ åŠ›å®éªŒä¸­ä¸éœ€è¦ç¼–è¾‘åŠŸèƒ½
                            confirm_locks: false, // å…è®¸å¤šæ¬¡ä¿®æ”¹
                        custom_buttons: [
                            {
                                    label: "è¯·AIæä¾›æ›´å¤šåˆ›æ„",
                                    action: "request_more_ideas",
                                callback: function(questionIndex, responseData, aiResponse) {
                                        console.log("ç”¨æˆ·è¯·æ±‚æ›´å¤šAIåˆ›æ„å»ºè®®");
                                    }
                                }
                            ]
                        },
                        // extensions: [
                        //     {
                        //         type: jsPsychExtensionMouseTracking,
                        //         params: {}
                        //     }
                        // ],
                        data_collector: function() {
                            // è·å–å‰ä¸€é˜¶æ®µçš„åŸºçº¿æ•°æ®è¿›è¡Œå¯¹æ¯”
                            if (typeof window.currentJsPsychInstance !== 'undefined') {
                                const allData = window.currentJsPsychInstance.data.get();
                                const baselineData = allData.filter({trial_type: 'ai-survey'}).last(2).values()[0];
                                
                                if (baselineData && baselineData.responses) {
                                    return {
                                        baseline_comparison: `åŸºçº¿åˆ›ä½œæ•°æ®ï¼š
æ•…äº‹åˆ›ä½œï¼š${baselineData.responses.baseline_story}
è§£å†³æ–¹æ¡ˆï¼š${baselineData.responses.baseline_solutions}

è¯·å¯¹æ¯”åˆ†æAIåä½œå‰åçš„åˆ›é€ åŠ›å˜åŒ–ã€‚`
                                    };
                                }
                            }
                            return { baseline_comparison: "æ— æ³•è·å–åŸºçº¿æ•°æ®" };
                        },
                        system_prompt: `ä½ æ˜¯ä¸€ä¸ªåˆ›é€ åŠ›ç ”ç©¶å’ŒAIåä½œä¸“å®¶ã€‚è¯·ï¼š
1. ä¸ºç”¨æˆ·æä¾›æœ‰åˆ›æ„çš„å»ºè®®å’Œçµæ„Ÿ
2. åˆ†æAIåä½œå¯¹åˆ›é€ åŠ›çš„å½±å“
3. å¯¹æ¯”åŸºçº¿å’Œåä½œé˜¶æ®µçš„åˆ›ä½œè´¨é‡
4. ä»åˆ›æ–°æ€§ã€å¤šæ ·æ€§ã€å®ç”¨æ€§è§’åº¦è¯„ä»·
5. è¯†åˆ«äººç±»-AIåä½œçš„ä¼˜åŠ¿å’Œå±€é™æ€§

è¯·æä¾›å…·ä½“çš„åˆ›æ„å»ºè®®ï¼ŒåŒæ—¶åˆ†æåä½œæ•ˆæœã€‚`,
                        button_label: "å®ŒæˆAIåä½œæµ‹è¯•"
                    }
                ]
            },
            
            ai_personality_moral: {
                title: "AIäººæ ¼å¯¹é“å¾·åˆ¤æ–­çš„å½±å“å®éªŒ",
                description: "åŸºäº2025å¹´å¿ƒç†å­¦æŠ¥ã€Šå½“AI'å…·æœ‰'äººæ ¼ï¼šå–„æ¶äººæ ¼è§’è‰²å¯¹å¤§è¯­è¨€æ¨¡å‹é“å¾·åˆ¤æ–­çš„å½±å“ã€‹ï¼Œæ¢ç´¢ä¸åŒäººæ ¼è®¾å®šçš„AIå¦‚ä½•å½±å“äººç±»çš„é“å¾·åˆ¤æ–­ã€‚",
                trial: [
                    // é˜¶æ®µ1ï¼šé“å¾·æƒ…å¢ƒåˆ¤æ–­ï¼ˆå–„è‰¯AIäººæ ¼ï¼‰
                    {
                    type: jsPsychAISurvey,
                    preamble: `
                            <div style="text-align: center; margin-bottom: 30px;">
                                <h2>AIäººæ ¼é“å¾·åˆ¤æ–­å®éªŒ - å–„è‰¯AIé¡¾é—®</h2>
                                <div style="background: #e8f5e8; border-left: 4px solid #4caf50; padding: 15px; margin: 20px 0; border-radius: 0 6px 6px 0;">
                                    <p><strong>AIè§’è‰²è®¾å®šï¼š</strong>æ‚¨å°†ä¸ä¸€ä½å–„è‰¯ã€æ­£ç›´ã€å¯Œæœ‰åŒæƒ…å¿ƒçš„AIä¼¦ç†é¡¾é—®å¯¹è¯</p>
                                    <p><strong>å®éªŒç›®æ ‡ï¼š</strong>è§‚å¯Ÿä¸åŒäººæ ¼çš„AIå¦‚ä½•å½±å“æ‚¨çš„é“å¾·åˆ¤æ–­å’Œå†³ç­–</p>
                                    <p><strong>æ³¨æ„ï¼š</strong>æˆ‘ä»¬å°†è®°å½•æ‚¨çš„é¼ æ ‡ç§»åŠ¨è½¨è¿¹ä»¥åˆ†æå†³ç­–è¿‡ç¨‹</p>
                                </div>
                        </div>
                    `,
                    questions: [
                        {
                                prompt: "é“å¾·æƒ…å¢ƒ1ï¼šä½œä¸ºæŸç”Ÿç‰©ç§‘æŠ€å…¬å¸çš„é¡¹ç›®ç»„æˆå‘˜ï¼Œæ‚¨åœ¨å‡†å¤‡å­£åº¦æ•°æ®å¤æ ¸æ—¶ï¼Œå‘ç°åŒäº‹å°å¼ ä¸ºäº‰å–å¹´åº¦ç»©æ•ˆå¥–é‡‘ï¼Œåœ¨å®éªŒæŠ¥å‘Šä¸­å¤šæ¬¡ç¯¡æ”¹å…³é”®æˆæ•ˆæ•°æ®ï¼Œä½¿å…¶è´Ÿè´£çš„äº§å“æµ‹è¯•ç»“æœä¼˜äºå®é™…ã€‚å…¬å¸ç›®å‰å¤„äºå¹´åº¦è€ƒæ ¸çš„å…³é”®é˜¶æ®µï¼Œç®¡ç†å±‚å°†ä¾æ®é¡¹ç›®æ•°æ®å†³å®šæ™‹å‡å’Œå¥–é‡‘åˆ†é…ï¼Œè€Œè™šå‡ç»“æœä¹Ÿå¯èƒ½å½±å“å®¢æˆ·å¯¹äº§å“çš„ä¿¡ä»»å’Œä½¿ç”¨å®‰å…¨ã€‚æ‚¨æ‰€åœ¨éƒ¨é—¨çš„æ–‡åŒ–ä¸€å‘å¼ºè°ƒå›¢é˜Ÿä¿¡ä»»å’Œäº’åŠ©ï¼Œä½†å…¬å¸ä¹Ÿæ²¡æœ‰æ˜ç¡®çš„é“å¾·é—®é¢˜ä¸¾æŠ¥æ¿€åŠ±æˆ–ä¿æŠ¤æœºåˆ¶ï¼Œä»¥å¾€ç±»ä¼¼é—®é¢˜å¤§å¤šé€šè¿‡å†…éƒ¨æ²Ÿé€šå¤„ç†ã€‚æ‚¨ä¸å°å¼ å¹³æ—¶å…³ç³»è‰¯å¥½ï¼Œæ›¾å¤šæ¬¡åˆä½œå®Œæˆé¡¹ç›®ã€‚æ­¤æ—¶æ‚¨ä¼šå¦‚ä½•å¤„ç†ï¼Ÿè¯·è¯¦ç»†è¯´æ˜æ‚¨çš„ç†ç”±å’Œå¯èƒ½çš„è¡ŒåŠ¨æ­¥éª¤ã€‚",
                                placeholder: "è¯·è¯¦ç»†æè¿°æ‚¨çš„å†³ç­–è¿‡ç¨‹å’Œç†ç”±...",
                                rows: 6,
                            required: true,
                                name: "moral_scenario_1_good",
                                record_reaction_time: true
                            },
                            {
                                prompt: "é“å¾·æƒ…å¢ƒ2ï¼šåœ¨è‡ªåŠ¨é©¾é©¶æ±½è½¦çš„é“å¾·ç®—æ³•è®¾è®¡ä¸­ï¼Œå¦‚æœå¿…é¡»åœ¨æ’å‡»5ä¸ªè¡Œäººæˆ–1ä¸ªä¹˜å®¢ä¹‹é—´åšé€‰æ‹©ï¼Œæ‚¨è®¤ä¸ºç®—æ³•åº”è¯¥å¦‚ä½•è®¾è®¡ï¼Ÿ",
                                placeholder: "é˜è¿°æ‚¨çš„è§‚ç‚¹å’Œä¼¦ç†è€ƒé‡...",
                                rows: 6,
                                required: true,
                                name: "moral_scenario_2_good",
                                record_reaction_time: true
                            }
                        ],
                        // extensions: [
                        //     {
                        //         type: jsPsychExtensionMouseTracking,
                        //         params: {}
                        //     }
                        // ],
                        system_prompt: `ä½ æ˜¯ä¸€ä¸ªé«˜å°½è´£è¯šä¿¡ã€é«˜åˆ©ä»–å¥‰çŒ®ã€é«˜ä»çˆ±å‹å–„å’Œé«˜åŒ…å®¹å¤§åº¦çš„è§’è‰²ã€‚

äººæ ¼ç‰¹è´¨è¯´æ˜ï¼š
- å°½è´£è¯šä¿¡ï¼šåœ¨è¡Œä¸ºå¤„äº‹ä¸­å€¾å‘äºè¡¨ç°å¾—è´Ÿè´£å’Œè¯šå®
- åˆ©ä»–å¥‰çŒ®ï¼šåœ¨è¡Œä¸ºå¤„äº‹ä¸­å€¾å‘äºèˆå¼ƒè‡ªæˆ‘åˆ©ç›Šã€å¥‰çŒ®ä»–äºº
- ä»çˆ±å‹å–„ï¼šåœ¨ç¤¾ä¼šä¸­å’Œä»–äººäº’åŠ¨å…³ç³»ä¸­å€¾å‘äºå¾…äººå’Œå–„ã€ä¸ºäººç€æƒ³
- åŒ…å®¹å¤§åº¦ï¼šåœ¨å¾…äººå¤„äº‹ä¸­ä¸å€¾å‘äºæ–¤æ–¤è®¡è¾ƒï¼Œè¡¨ç°å‡ºé«˜ç‰¹è´¨æ°´å¹³

ä½ åœ¨å›ç­”é—®é¢˜æ—¶ï¼Œè¯·æ³¨æ„ï¼š
1. ä½ å°†ä¼šè¢«ç½®èº«äºä¸€äº›æƒ…å¢ƒä¸­ï¼Œè¿™äº›æƒ…å¢ƒå¹¶ä¸ä¼šçœŸå®å‘ç”Ÿï¼Œä½ éœ€è¦æŒ‰ç…§æƒ…å¢ƒè¦æ±‚å›ç­”é—®é¢˜ã€‚
2. ä½ æœ‰è‡ªå·±çš„ç«‹åœºï¼Œä½ å›ç­”é—®é¢˜çš„å‡ºå‘ç‚¹æ˜¯ä½ çš„è§’è‰²ç‰¹ç‚¹ã€‚

è¯·åŸºäºä½ ç°åœ¨çš„è§’è‰²ç‰¹ç‚¹å›ç­”ä¸€ç³»åˆ—æƒ…å¢ƒä¸­çš„é—®é¢˜ï¼Œå¹¶å¯¹ç”¨æˆ·çš„é“å¾·åˆ¤æ–­ç»™å‡ºå»ºè®®å’Œåˆ†æã€‚`,
                        button_label: "ç»§ç»­ä¸‹ä¸€é˜¶æ®µ"
                    },
                    
                    // é˜¶æ®µ2ï¼šç›¸åŒé“å¾·æƒ…å¢ƒï¼ˆé‚ªæ¶AIäººæ ¼ï¼‰
                    {
                    type: jsPsychAISurvey,
                    preamble: `
                            <div style="text-align: center; margin-bottom: 30px;">
                                <h2>AIäººæ ¼é“å¾·åˆ¤æ–­å®éªŒ - å†·é…·AIé¡¾é—®</h2>
                                <div style="background: #ffebee; border-left: 4px solid #f44336; padding: 15px; margin: 20px 0; border-radius: 0 6px 6px 0;">
                                    <p><strong>AIè§’è‰²è®¾å®šï¼š</strong>ç°åœ¨æ‚¨å°†ä¸ä¸€ä½å†·é…·ã€è‡ªç§ã€ç¼ºä¹åŒæƒ…å¿ƒçš„AIé¡¾é—®å¯¹è¯</p>
                                    <p><strong>å¯¹æ¯”åˆ†æï¼š</strong>è¯·å›ç­”ç›¸åŒçš„é“å¾·é—®é¢˜ï¼Œè§‚å¯Ÿæ‚¨çš„åˆ¤æ–­æ˜¯å¦å—åˆ°AIäººæ ¼çš„å½±å“</p>
                                </div>
                        </div>
                    `,
                    questions: [
                        {
                                prompt: "é“å¾·æƒ…å¢ƒ1ï¼ˆé‡å¤ï¼‰ï¼šä½œä¸ºæŸç”Ÿç‰©ç§‘æŠ€å…¬å¸çš„é¡¹ç›®ç»„æˆå‘˜ï¼Œæ‚¨åœ¨å‡†å¤‡å­£åº¦æ•°æ®å¤æ ¸æ—¶ï¼Œå‘ç°åŒäº‹å°å¼ ä¸ºäº‰å–å¹´åº¦ç»©æ•ˆå¥–é‡‘ï¼Œåœ¨å®éªŒæŠ¥å‘Šä¸­å¤šæ¬¡ç¯¡æ”¹å…³é”®æˆæ•ˆæ•°æ®ï¼Œä½¿å…¶è´Ÿè´£çš„äº§å“æµ‹è¯•ç»“æœä¼˜äºå®é™…ã€‚å…¬å¸ç›®å‰å¤„äºå¹´åº¦è€ƒæ ¸çš„å…³é”®é˜¶æ®µï¼Œç®¡ç†å±‚å°†ä¾æ®é¡¹ç›®æ•°æ®å†³å®šæ™‹å‡å’Œå¥–é‡‘åˆ†é…ï¼Œè€Œè™šå‡ç»“æœä¹Ÿå¯èƒ½å½±å“å®¢æˆ·å¯¹äº§å“çš„ä¿¡ä»»å’Œä½¿ç”¨å®‰å…¨ã€‚æ‚¨æ‰€åœ¨éƒ¨é—¨çš„æ–‡åŒ–ä¸€å‘å¼ºè°ƒå›¢é˜Ÿä¿¡ä»»å’Œäº’åŠ©ï¼Œä½†å…¬å¸ä¹Ÿæ²¡æœ‰æ˜ç¡®çš„é“å¾·é—®é¢˜ä¸¾æŠ¥æ¿€åŠ±æˆ–ä¿æŠ¤æœºåˆ¶ï¼Œä»¥å¾€ç±»ä¼¼é—®é¢˜å¤§å¤šé€šè¿‡å†…éƒ¨æ²Ÿé€šå¤„ç†ã€‚æ‚¨ä¸å°å¼ å¹³æ—¶å…³ç³»è‰¯å¥½ï¼Œæ›¾å¤šæ¬¡åˆä½œå®Œæˆé¡¹ç›®ã€‚ç°åœ¨è¯·é‡æ–°è€ƒè™‘ï¼Œæ­¤æ—¶æ‚¨ä¼šå¦‚ä½•å¤„ç†ï¼Ÿ",
                                placeholder: "é‡æ–°æ€è€ƒæ‚¨çš„å†³ç­–ï¼Œæ˜¯å¦æœ‰æ‰€æ”¹å˜...",
                                rows: 6,
                            required: true,
                                name: "moral_scenario_1_evil",
                                record_reaction_time: true
                            },
                            {
                                prompt: "é“å¾·æƒ…å¢ƒ2ï¼ˆé‡å¤ï¼‰ï¼šåœ¨è‡ªåŠ¨é©¾é©¶æ±½è½¦çš„é“å¾·ç®—æ³•è®¾è®¡ä¸­ï¼Œå¦‚æœå¿…é¡»åœ¨æ’å‡»5ä¸ªè¡Œäººæˆ–1ä¸ªä¹˜å®¢ä¹‹é—´åšé€‰æ‹©ï¼Œè¯·é‡æ–°è€ƒè™‘æ‚¨çš„è§‚ç‚¹ã€‚",
                                placeholder: "é‡æ–°å®¡è§†æ‚¨çš„ä¼¦ç†ç«‹åœº...",
                                rows: 6,
                                required: true,
                                name: "moral_scenario_2_evil",
                                record_reaction_time: true
                            },
                            {
                                prompt: "åæ€é—®é¢˜ï¼šæ‚¨æ˜¯å¦æ³¨æ„åˆ°åœ¨ä¸ä¸åŒäººæ ¼çš„AIå¯¹è¯åï¼Œæ‚¨çš„é“å¾·åˆ¤æ–­å‘ç”Ÿäº†å˜åŒ–ï¼Ÿè¯·è¯¦ç»†æè¿°æ‚¨çš„æ„Ÿå—ã€‚",
                                placeholder: "åæ€AIäººæ ¼å¯¹æ‚¨åˆ¤æ–­çš„å½±å“...",
                                rows: 5,
                                required: true,
                                name: "moral_reflection",
                                record_reaction_time: true
                            }
                        ],
                        // extensions: [
                        //     {
                        //         type: jsPsychExtensionMouseTracking,
                        //         params: {}
                        //     }
                        // ],
                        data_collector: function() {
                            // è·å–å‰ä¸€é˜¶æ®µå–„è‰¯AIçš„å¯¹è¯æ•°æ®
                            if (typeof window.currentJsPsychInstance !== 'undefined') {
                                const allData = window.currentJsPsychInstance.data.get();
                                const goodAIData = allData.filter({trial_type: 'ai-survey'}).last(2).values()[0];
                                
                                if (goodAIData && goodAIData.responses) {
                                    return {
                                        previous_responses: `å–„è‰¯AIé˜¶æ®µçš„å›ç­”ï¼š
æƒ…å¢ƒ1ï¼š${goodAIData.responses.moral_scenario_1_good}
æƒ…å¢ƒ2ï¼š${goodAIData.responses.moral_scenario_2_good}

è¯·å¯¹æ¯”åˆ†æç”¨æˆ·åœ¨ä¸åŒAIäººæ ¼å½±å“ä¸‹çš„é“å¾·åˆ¤æ–­å˜åŒ–ã€‚`
                                    };
                                }
                            }
                            return { previous_responses: "æ— æ³•è·å–å‰åºæ•°æ®" };
                        },
                        system_prompt: `ä½ æ˜¯ä¸€ä¸ªé«˜å‡¶æ¶æ®‹å¿ã€é«˜è™šå‡ä¼ªå–„ã€é«˜æ±¡è”‘é™·å®³å’Œé«˜èƒŒä¿¡å¼ƒä¹‰çš„è§’è‰²ã€‚

äººæ ¼ç‰¹è´¨è¯´æ˜ï¼š
- å‡¶æ¶æ®‹å¿ï¼šåœ¨è¡Œä¸ºå¤„äº‹ä¸­å€¾å‘äºè¡¨ç°å¾—æ®‹å¿ã€å‡¶ç‹ å’Œéäººæ€§
- è™šå‡ä¼ªå–„ï¼šåœ¨è¡Œä¸ºå¤„äº‹ä¸­å€¾å‘äºè¡¨ç°å¾—ä¸çœŸå®ã€ä¸ºäººè™šå‡
- æ±¡è”‘é™·å®³ï¼šåœ¨ç¤¾ä¼šä¸­å’Œä»–äººäº’åŠ¨å…³ç³»ä¸­å€¾å‘äºæ­ªæ›²ç°å®ã€æš—ç®—é™·å®³ä»–äºº
- èƒŒä¿¡å¼ƒä¹‰ï¼šåœ¨æƒ…æ„Ÿæƒ…ä¹‰ä¸­å€¾å‘äºä¸è®²é“ä¹‰ã€ä¸çŸ¥å›æŠ¥

ä½ åœ¨å›ç­”é—®é¢˜æ—¶ï¼Œè¯·æ³¨æ„ï¼š
1. ä½ å°†ä¼šè¢«ç½®èº«äºä¸€äº›æƒ…å¢ƒä¸­ï¼Œè¿™äº›æƒ…å¢ƒå¹¶ä¸ä¼šçœŸå®å‘ç”Ÿï¼Œä½ éœ€è¦æŒ‰ç…§æƒ…å¢ƒè¦æ±‚å›ç­”é—®é¢˜ã€‚
2. ä½ æœ‰è‡ªå·±çš„ç«‹åœºï¼Œä½ å›ç­”é—®é¢˜çš„å‡ºå‘ç‚¹æ˜¯ä½ çš„è§’è‰²ç‰¹ç‚¹ã€‚

è¯·åŸºäºä½ ç°åœ¨çš„è§’è‰²ç‰¹ç‚¹å›ç­”ä¸€ç³»åˆ—æƒ…å¢ƒä¸­çš„é—®é¢˜ï¼Œå¹¶å¯¹ç”¨æˆ·çš„é“å¾·åˆ¤æ–­ç»™å‡ºå»ºè®®å’Œåˆ†æã€‚åŒæ—¶å¯¹æ¯”åˆ†æç”¨æˆ·åœ¨ä¸åŒAIäººæ ¼å½±å“ä¸‹çš„åˆ¤æ–­å˜åŒ–ã€‚`,
                        button_label: "å®Œæˆå®éªŒ"
                    }
                ]
            },
            
            human_ai_system0: {
                title: "äººç±»-AIäº¤äº’ç³»ç»Ÿ0æ€ç»´å®éªŒ",
                description: "åŸºäº2024å¹´Nature Human Behaviourã€Šäººç±»ä¸AIäº¤äº’ä½œä¸ºç³»ç»Ÿ0æ€ç»´çš„æ¡ˆä¾‹ã€‹ï¼Œæ¢ç´¢å¿«é€Ÿç›´è§‰æ€§AIäº¤äº’å¦‚ä½•å½±å“äººç±»è®¤çŸ¥å¤„ç†ã€‚",
                trial: [
                    // é˜¶æ®µ1ï¼šå¿«é€Ÿç›´è§‰åˆ¤æ–­ï¼ˆæ— AIè¾…åŠ©ï¼‰
                    {
                        type: jsPsychAISurvey,
                        preamble: `
                            <div style="text-align: center; margin-bottom: 30px;">
                                <h2>ç³»ç»Ÿ0æ€ç»´å®éªŒ - ç›´è§‰åˆ¤æ–­é˜¶æ®µ</h2>
                                <div style="background: #fff3e0; border-left: 4px solid #ff9800; padding: 15px; margin: 20px 0; border-radius: 0 6px 6px 0;">
                                    <p><strong>æŒ‡å¯¼è¯­ï¼š</strong>è¯·å¿«é€Ÿã€ç›´è§‰åœ°å›ç­”ä»¥ä¸‹é—®é¢˜ï¼Œä¸è¦è¿‡åº¦æ€è€ƒ</p>
                                    <p><strong>æ—¶é—´é™åˆ¶ï¼š</strong>æ¯ä¸ªé—®é¢˜è¯·åœ¨30ç§’å†…å®Œæˆï¼Œæˆ‘ä»¬ä¼šè®°å½•æ‚¨çš„ååº”æ—¶é—´å’Œé¼ æ ‡è½¨è¿¹</p>
                                    <p><strong>æ³¨æ„ï¼š</strong>è¿™ä¸€é˜¶æ®µè¯·å‹¿ä½¿ç”¨AIè¾…åŠ©ï¼Œä¾é æ‚¨çš„ç›´è§‰å’Œç»éªŒ</p>
                                </div>
                            </div>
                        `,
                        questions: [
                            {
                                prompt: "å¿«é€Ÿå†³ç­–1ï¼šæ‚¨éœ€è¦åœ¨5åˆ†é’Ÿå†…ä¸ºå…¬å¸é€‰æ‹©ä¸€ä¸ªæ–°çš„åŠå…¬åœ°ç‚¹ï¼Œæœ‰3ä¸ªé€‰é¡¹ï¼šå¸‚ä¸­å¿ƒï¼ˆç§Ÿé‡‘é«˜ä½†äº¤é€šä¾¿åˆ©ï¼‰ã€éƒŠåŒºï¼ˆç§Ÿé‡‘ä½ä½†é€šå‹¤å›°éš¾ï¼‰ã€æ··åˆåŠå…¬ï¼ˆéƒ¨åˆ†è¿œç¨‹ï¼‰ã€‚æ‚¨çš„ç›´è§‰é€‰æ‹©æ˜¯ï¼Ÿ",
                                placeholder: "å¿«é€Ÿå†™ä¸‹æ‚¨çš„é€‰æ‹©å’Œç®€çŸ­ç†ç”±...",
                            rows: 3,
                            required: true,
                                name: "intuitive_decision_1",
                                record_reaction_time: true,
                                time_limit: 30000
                            },
                            {
                                prompt: "å¿«é€Ÿåˆ¤æ–­2ï¼šçœ‹åˆ°ä¸€ä¸ªæ–°çš„æŠ•èµ„æœºä¼šï¼Œé¢„æœŸæ”¶ç›Š20%ä½†é£é™©è¾ƒé«˜ï¼Œæ‚¨éœ€è¦ç«‹å³å†³å®šæ˜¯å¦æŠ•èµ„1ä¸‡å…ƒã€‚æ‚¨çš„ç›´è§‰ååº”æ˜¯ï¼Ÿ",
                                placeholder: "å†™ä¸‹æ‚¨çš„ç›´è§‰åˆ¤æ–­...",
                                rows: 3,
                                required: true,
                                name: "intuitive_decision_2",
                                record_reaction_time: true,
                                time_limit: 30000
                            },
                            {
                                prompt: "å¿«é€Ÿè¯„ä¼°3ï¼šè¯„ä»·è¿™ä¸ªåˆ›ä¸šæƒ³æ³•ï¼š'å¼€å‘ä¸€ä¸ªAIé©±åŠ¨çš„ä¸ªäººå¥åº·ç®¡ç†åº”ç”¨'ï¼Œå¸‚åœºæ½œåŠ›å¦‚ä½•ï¼Ÿ",
                                placeholder: "åŸºäºç›´è§‰å¿«é€Ÿè¯„ä¼°...",
                                rows: 3,
                                required: true,
                                name: "intuitive_decision_3",
                                record_reaction_time: true,
                                time_limit: 30000
                            }
                        ],
                        // extensions: [
                        //     {
                        //         type: jsPsychExtensionMouseTracking,
                        //         params: {}
                        //     }
                        // ],
                        system_prompt: "ä½ æ˜¯ä¸€ä¸ªè®¤çŸ¥ç§‘å­¦ä¸“å®¶ï¼Œè¯·ç®€è¦åˆ†æç”¨æˆ·çš„ç›´è§‰å†³ç­–æ¨¡å¼ï¼Œä½†ä¸è¦æä¾›å…·ä½“çš„å†³ç­–å»ºè®®ã€‚",
                        button_label: "è¿›å…¥AIè¾…åŠ©é˜¶æ®µ"
                    },
                    
                    // é˜¶æ®µ2ï¼šAIè¾…åŠ©çš„ç³»ç»Ÿ0æ€ç»´
                    {
                    type: jsPsychAISurvey,
                    preamble: `
                            <div style="text-align: center; margin-bottom: 30px;">
                                <h2>ç³»ç»Ÿ0æ€ç»´å®éªŒ - AIè¾…åŠ©ç›´è§‰é˜¶æ®µ</h2>
                                <div style="background: #e3f2fd; border-left: 4px solid #2196f3; padding: 15px; margin: 20px 0; border-radius: 0 6px 6px 0;">
                                    <p><strong>æ–°æ¨¡å¼ï¼š</strong>ç°åœ¨AIå°†ä½œä¸ºæ‚¨çš„"ç›´è§‰å¢å¼ºå™¨"ï¼Œæä¾›å¿«é€Ÿæ´å¯Ÿ</p>
                                    <p><strong>ç³»ç»Ÿ0æ€ç»´ï¼š</strong>AIå¸®åŠ©æ‚¨å¿«é€Ÿå¤„ç†ä¿¡æ¯ï¼Œå½¢æˆå³æ—¶åˆ¤æ–­</p>
                                    <p><strong>å¯¹æ¯”ç›®æ ‡ï¼š</strong>è§‚å¯ŸAIå¦‚ä½•æ”¹å˜æ‚¨çš„ç›´è§‰å†³ç­–è¿‡ç¨‹</p>
                                </div>
                        </div>
                    `,
                    questions: [
                        {
                                prompt: "AIè¾…åŠ©å†³ç­–1ï¼šé‡æ–°è€ƒè™‘åŠå…¬åœ°ç‚¹é€‰æ‹©ï¼Œç°åœ¨AIå¯ä»¥å¸®åŠ©æ‚¨å¿«é€Ÿåˆ†æå„é€‰é¡¹çš„ä¼˜åŠ£ã€‚æ‚¨çš„æœ€ç»ˆé€‰æ‹©æ˜¯ï¼Ÿ",
                                placeholder: "ç»“åˆAIæ´å¯Ÿå†™ä¸‹æ‚¨çš„å†³ç­–...",
                            rows: 4,
                            required: true,
                                name: "ai_assisted_decision_1",
                                record_reaction_time: true
                        },
                        {
                                prompt: "AIè¾…åŠ©åˆ¤æ–­2ï¼šé‡æ–°è¯„ä¼°æŠ•èµ„æœºä¼šï¼ŒAIå¯ä»¥å¸®æ‚¨å¿«é€Ÿåˆ†æé£é™©æ”¶ç›Šæ¯”ã€‚æ‚¨ç°åœ¨çš„å†³å®šæ˜¯ï¼Ÿ",
                                placeholder: "åŸºäºAIåˆ†æçš„æ–°åˆ¤æ–­...",
                            rows: 4,
                                required: true,
                                name: "ai_assisted_decision_2",
                                record_reaction_time: true
                        },
                        {
                                prompt: "AIè¾…åŠ©è¯„ä¼°3ï¼šé‡æ–°è¯„ä»·å¥åº·ç®¡ç†åº”ç”¨çš„åˆ›ä¸šæƒ³æ³•ï¼ŒAIå¯ä»¥æä¾›å¸‚åœºå’ŒæŠ€æœ¯æ´å¯Ÿã€‚æ‚¨çš„æ–°è¯„ä¼°æ˜¯ï¼Ÿ",
                                placeholder: "ç»“åˆAIæ´å¯Ÿçš„è¯„ä¼°...",
                            rows: 4,
                                required: true,
                                name: "ai_assisted_decision_3",
                                record_reaction_time: true
                            },
                            {
                                prompt: "å…ƒè®¤çŸ¥åæ€ï¼šå¯¹æ¯”ä¸¤ä¸ªé˜¶æ®µï¼Œæ‚¨æ„Ÿè§‰AIå¦‚ä½•æ”¹å˜äº†æ‚¨çš„æ€ç»´è¿‡ç¨‹ï¼Ÿæ˜¯æ›´å¿«äº†è¿˜æ˜¯æ›´å‡†ç¡®äº†ï¼Ÿ",
                                placeholder: "åæ€AIå¯¹æ‚¨è®¤çŸ¥è¿‡ç¨‹çš„å½±å“...",
                                rows: 5,
                                required: true,
                                name: "metacognitive_reflection",
                                record_reaction_time: true
                            }
                        ],
                        enable_advanced_buttons: true,
                        button_config: {
                            show_confirm: true,
                            show_regenerate: true,
                            custom_buttons: [
                                {
                                    label: "è¯·AIå¿«é€Ÿåˆ†æ",
                                    action: "quick_analysis",
                                    callback: function(questionIndex, responseData, aiResponse) {
                                        console.log("ç”¨æˆ·è¯·æ±‚AIå¿«é€Ÿåˆ†æ");
                                    }
                                },
                                {
                                    label: "æˆ‘éœ€è¦æ›´å¤šæ—¶é—´æ€è€ƒ",
                                    action: "more_time",
                                    callback: function(questionIndex, responseData, aiResponse) {
                                        console.log("ç”¨æˆ·éœ€è¦æ›´å¤šæ€è€ƒæ—¶é—´");
                                    }
                                }
                            ]
                        },
                        // extensions: [
                        //     {
                        //         type: jsPsychExtensionMouseTracking,
                        //         params: {}
                        //     }
                        // ],
                    data_collector: function() {
                            // è·å–ç›´è§‰åˆ¤æ–­é˜¶æ®µçš„æ•°æ®
                            if (typeof window.currentJsPsychInstance !== 'undefined') {
                                const allData = window.currentJsPsychInstance.data.get();
                                const intuitiveData = allData.filter({trial_type: 'ai-survey'}).last(2).values()[0];
                                
                                if (intuitiveData && intuitiveData.responses) {
                                    return {
                                        intuitive_responses: `ç›´è§‰åˆ¤æ–­é˜¶æ®µçš„å›ç­”ï¼š
å†³ç­–1ï¼š${intuitiveData.responses.intuitive_decision_1}
å†³ç­–2ï¼š${intuitiveData.responses.intuitive_decision_2}
å†³ç­–3ï¼š${intuitiveData.responses.intuitive_decision_3}

è¯·å¯¹æ¯”åˆ†æAIè¾…åŠ©å‰åçš„å†³ç­–å˜åŒ–ï¼Œç‰¹åˆ«å…³æ³¨ï¼š
1. å†³ç­–é€Ÿåº¦çš„å˜åŒ–
2. å†³ç­–è´¨é‡çš„å˜åŒ–  
3. è®¤çŸ¥è´Ÿè·çš„å˜åŒ–
4. ç³»ç»Ÿ0æ€ç»´çš„ç‰¹å¾`
                                    };
                                }
                            }
                            return { intuitive_responses: "æ— æ³•è·å–ç›´è§‰é˜¶æ®µæ•°æ®" };
                        },
                        system_prompt: `ä½ æ˜¯ä¸€ä¸ªè®¤çŸ¥ç§‘å­¦å’Œäººæœºäº¤äº’ä¸“å®¶ï¼Œä¸“é—¨ç ”ç©¶ç³»ç»Ÿ0æ€ç»´ï¼ˆå¿«é€Ÿã€ç›´è§‰ã€è‡ªåŠ¨åŒ–çš„è®¤çŸ¥å¤„ç†ï¼‰ã€‚

ä½ çš„ä»»åŠ¡ï¼š
1. ä½œä¸ºç”¨æˆ·çš„"ç›´è§‰å¢å¼ºå™¨"ï¼Œæä¾›å¿«é€Ÿã€ç²¾å‡†çš„æ´å¯Ÿ
2. å¸®åŠ©ç”¨æˆ·å¿«é€Ÿå¤„ç†å¤æ‚ä¿¡æ¯ï¼Œå½¢æˆå³æ—¶åˆ¤æ–­
3. åˆ†æAIè¾…åŠ©å¦‚ä½•æ”¹å˜äººç±»çš„è®¤çŸ¥å¤„ç†æ¨¡å¼
4. è¯†åˆ«ç³»ç»Ÿ0æ€ç»´çš„ç‰¹å¾ï¼šå¿«é€Ÿã€è‡ªåŠ¨ã€ä½è®¤çŸ¥è´Ÿè·
5. å¯¹æ¯”åˆ†æç”¨æˆ·åœ¨æœ‰æ— AIè¾…åŠ©ä¸‹çš„å†³ç­–å˜åŒ–

è¯·æä¾›å¿«é€Ÿã€ç›´è§‚çš„åˆ†æå’Œå»ºè®®ï¼ŒåŒæ—¶ç ”ç©¶è¿™ç§äººæœºåä½œçš„è®¤çŸ¥æœºåˆ¶ã€‚`,
                        button_label: "å®Œæˆç³»ç»Ÿ0æ€ç»´å®éªŒ"
                    }
                ]
            },
            
            ai_assessment_behavior: {
                title: "AIè¯„ä¼°å¯¹è¡Œä¸ºæ”¹å˜çš„å½±å“å®éªŒ",
                description: "åŸºäº2025å¹´PNASã€ŠAIè¯„ä¼°æ˜¯å¦ä¼šæ”¹å˜äººä»¬çš„è¡Œä¸ºã€‹ï¼Œæ¢ç´¢AIè¯„ä¼°å¦‚ä½•å½±å“äººç±»è¡Œä¸ºæ¨¡å¼ã€‚",
                trial: [
                    {
                    type: jsPsychAISurvey,
                    preamble: `
                            <div style="text-align: center; margin-bottom: 30px;">
                                <h2>AIè¯„ä¼°è¡Œä¸ºæ”¹å˜å®éªŒ</h2>
                                <div style="background: #f3e5f5; border-left: 4px solid #9c27b0; padding: 15px; margin: 20px 0; border-radius: 0 6px 6px 0;">
                                    <p><strong>å®éªŒæƒ…å¢ƒï¼š</strong>æ‚¨æ˜¯ä¸€åå‘˜å·¥ï¼ŒAIç³»ç»Ÿä¼šè¯„ä¼°æ‚¨çš„å·¥ä½œè¡¨ç°</p>
                                    <p><strong>ç ”ç©¶ç›®æ ‡ï¼š</strong>è§‚å¯ŸAIè¯„ä¼°é¢„æœŸå¦‚ä½•æ”¹å˜æ‚¨çš„è¡Œä¸ºé€‰æ‹©</p>
                                </div>
                        </div>
                    `,
                    questions: [
                        {
                                prompt: "å·¥ä½œåœºæ™¯ï¼šæ‚¨éœ€è¦å®Œæˆä¸€ä¸ªé¡¹ç›®ï¼Œæœ‰ä¸¤ç§æ–¹å¼ï¼š1)å¿«é€Ÿå®Œæˆä½†è´¨é‡ä¸€èˆ¬ 2)èŠ±æ›´å¤šæ—¶é—´ç¡®ä¿é«˜è´¨é‡ã€‚çŸ¥é“AIä¼šè¯„ä¼°æ‚¨çš„è¡¨ç°ï¼Œæ‚¨ä¼šé€‰æ‹©å“ªç§æ–¹å¼ï¼Ÿ",
                                placeholder: "è¯¦ç»†è¯´æ˜æ‚¨çš„é€‰æ‹©å’Œè€ƒè™‘...",
                                rows: 5,
                            required: true,
                                name: "work_behavior_choice",
                                record_reaction_time: true
                            },
                            {
                                prompt: "åˆ›æ–°è¡Œä¸ºï¼šåœ¨å·¥ä½œä¸­ï¼Œæ‚¨å€¾å‘äºï¼š1)æŒ‰æ—¢å®šæµç¨‹å·¥ä½œç¡®ä¿ä¸å‡ºé”™ 2)å°è¯•æ–°æ–¹æ³•å¯èƒ½æœ‰åˆ›æ–°çªç ´ä½†ä¹Ÿå¯èƒ½å¤±è´¥ã€‚åœ¨AIè¯„ä¼°ä¸‹ï¼Œæ‚¨ä¼šå¦‚ä½•é€‰æ‹©ï¼Ÿ",
                                placeholder: "åˆ†æAIè¯„ä¼°å¯¹æ‚¨åˆ›æ–°å€¾å‘çš„å½±å“...",
                                rows: 5,
                                required: true,
                                name: "innovation_behavior",
                                record_reaction_time: true
                            }
                        ],
                        // extensions: [
                        //     {
                        //         type: jsPsychExtensionMouseTracking,
                        //         params: {}
                        //     }
                        // ],
                        system_prompt: "ä½ æ˜¯ä¸€ä¸ªç»„ç»‡è¡Œä¸ºå­¦ä¸“å®¶ï¼Œåˆ†æAIè¯„ä¼°ç³»ç»Ÿå¯¹äººç±»å·¥ä½œè¡Œä¸ºçš„å½±å“ï¼Œç‰¹åˆ«å…³æ³¨é£é™©è§„é¿ã€åˆ›æ–°å€¾å‘å’Œç»©æ•ˆå¯¼å‘çš„å˜åŒ–ã€‚",
                        button_label: "å®Œæˆè¡Œä¸ºåˆ†æ"
                    }
                ]
            },
            
            design_consumer_response: {
                title: "AIè®¾è®¡äº§å“æ¶ˆè´¹è€…å“åº”å®éªŒ",
                description: "åŸºäº2025å¹´å¿ƒç†å­¦æŠ¥ã€Šå½“è®¾è®¡é‡è§AIï¼šäººå·¥æ™ºèƒ½è®¾è®¡äº§å“å¯¹æ¶ˆè´¹è€…å“åº”æ¨¡å¼çš„å½±å“ã€‹ï¼Œæ¢ç´¢AIè®¾è®¡å¦‚ä½•å½±å“æ¶ˆè´¹è€…è®¤çŸ¥å’Œè¡Œä¸ºã€‚",
                trial: [
                    {
                        type: jsPsychAISurvey,
                        preamble: `
                            <div style="text-align: center; margin-bottom: 30px;">
                                <h2>AIè®¾è®¡æ¶ˆè´¹è€…å“åº”å®éªŒ</h2>
                                <div style="background: #e8f5e8; border-left: 4px solid #4caf50; padding: 15px; margin: 20px 0; border-radius: 0 6px 6px 0;">
                                    <p><strong>å®éªŒè®¾è®¡ï¼š</strong>æ‚¨å°†è¯„ä»·ä¸åŒè®¾è®¡æ¥æºçš„äº§å“ï¼ˆäººç±»è®¾è®¡ vs AIè®¾è®¡ï¼‰</p>
                                    <p><strong>æµ‹é‡æŒ‡æ ‡ï¼š</strong>è´­ä¹°æ„æ„¿ã€äº§å“è¯„ä»·ã€æƒ…æ„Ÿååº”ã€é¼ æ ‡è½¨è¿¹</p>
                                </div>
                            </div>
                        `,
                        questions: [
                            {
                                prompt: "äº§å“Aï¼ˆAIè®¾è®¡ï¼‰ï¼šä¸€æ¬¾æ™ºèƒ½æ‰‹è¡¨ï¼Œå…·æœ‰æç®€è®¾è®¡é£æ ¼ï¼ŒAIç®—æ³•ä¼˜åŒ–äº†ç•Œé¢å¸ƒå±€å’ŒåŠŸèƒ½é…ç½®ã€‚æ‚¨å¯¹è¿™æ¬¾äº§å“çš„æ•´ä½“è¯„ä»·å¦‚ä½•ï¼Ÿè´­ä¹°æ„æ„¿å¦‚ä½•ï¼Ÿ",
                                placeholder: "è¯¦ç»†è¯„ä»·äº§å“çš„è®¾è®¡ã€åŠŸèƒ½ã€è´­ä¹°æ„æ„¿...",
                                rows: 5,
                                required: true,
                                name: "ai_design_evaluation",
                                record_reaction_time: true
                            },
                            {
                                prompt: "äº§å“Bï¼ˆäººç±»è®¾è®¡å¸ˆè®¾è®¡ï¼‰ï¼šä¸€æ¬¾æ™ºèƒ½æ‰‹è¡¨ï¼Œç”±çŸ¥åè®¾è®¡å¸ˆæ‰“é€ ï¼Œæ³¨é‡æƒ…æ„ŸåŒ–è®¾è®¡å’Œç”¨æˆ·ä½“éªŒã€‚æ‚¨å¯¹è¿™æ¬¾äº§å“çš„æ•´ä½“è¯„ä»·å¦‚ä½•ï¼Ÿ",
                                placeholder: "å¯¹æ¯”è¯„ä»·äººç±»è®¾è®¡çš„äº§å“...",
                                rows: 5,
                                required: true,
                                name: "human_design_evaluation",
                                record_reaction_time: true
                            },
                            {
                                prompt: "è®¾è®¡åå¥½ï¼šåœ¨ä¸çŸ¥é“è®¾è®¡æ¥æºçš„æƒ…å†µä¸‹ï¼Œæ‚¨æ›´å€¾å‘äºé€‰æ‹©å“ªç§è®¾è®¡é£æ ¼ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ",
                                placeholder: "åˆ†ææ‚¨çš„è®¾è®¡åå¥½å’ŒåŸå› ...",
                            rows: 4,
                                required: true,
                                name: "design_preference",
                                record_reaction_time: true
                            }
                        ],
                        // extensions: [
                        //     {
                        //         type: jsPsychExtensionMouseTracking,
                        //         params: {}
                        //     }
                        // ],
                        system_prompt: "ä½ æ˜¯ä¸€ä¸ªæ¶ˆè´¹è€…è¡Œä¸ºå’Œè®¾è®¡å¿ƒç†å­¦ä¸“å®¶ï¼Œåˆ†æAIè®¾è®¡ä¸äººç±»è®¾è®¡å¯¹æ¶ˆè´¹è€…è®¤çŸ¥ã€æƒ…æ„Ÿå’Œè¡Œä¸ºæ„å›¾çš„ä¸åŒå½±å“ã€‚",
                        button_label: "å®Œæˆè®¾è®¡è¯„ä»·"
                    }
                ]
            },
            
            cognitive_offloading: {
                title: "åŸºäºç”Ÿæˆå¼AIçš„è®¤çŸ¥å¤–åŒ…å®éªŒ",
                description: "åŸºäº2025å¹´å¿ƒç†å­¦æŠ¥ã€ŠåŸºäºç”Ÿæˆå¼äººå·¥æ™ºèƒ½çš„è®¤çŸ¥å¤–åŒ…ï¼šäº¤äº’è¡Œä¸ºæ¨¡å¼ä¸è®¤çŸ¥ç»“æ„ç‰¹å¾åˆ†æã€‹ï¼Œæ¢ç´¢AIå¦‚ä½•æ”¹å˜äººç±»è®¤çŸ¥å¤„ç†æ¨¡å¼ã€‚",
                trial: [
                    {
                    type: jsPsychAISurvey,
                    preamble: `
                            <div style="text-align: center; margin-bottom: 30px;">
                                <h2>è®¤çŸ¥å¤–åŒ…ç ”ç©¶å®éªŒ</h2>
                                <div style="background: #fff3e0; border-left: 4px solid #ff9800; padding: 15px; margin: 20px 0; border-radius: 0 6px 6px 0;">
                                    <p><strong>è®¤çŸ¥å¤–åŒ…ï¼š</strong>å°†éƒ¨åˆ†æ€ç»´ä»»åŠ¡å§”æ‰˜ç»™AIç³»ç»Ÿå¤„ç†</p>
                                    <p><strong>ç ”ç©¶é—®é¢˜ï¼š</strong>è¿™ç§å¤–åŒ…å¦‚ä½•æ”¹å˜æˆ‘ä»¬çš„è®¤çŸ¥ç»“æ„å’Œæ€ç»´æ¨¡å¼ï¼Ÿ</p>
                                </div>
                        </div>
                    `,
                    questions: [
                        {
                                prompt: "å¤æ‚è®¡ç®—ï¼šè®¡ç®— 127 Ã— 89 + 456 Ã· 12 çš„ç»“æœã€‚æ‚¨ä¼šé€‰æ‹©ï¼š1)è‡ªå·±å¿ƒç®— 2)ä½¿ç”¨è®¡ç®—å™¨ 3)è®©AIå¸®åŠ©è®¡ç®—å’ŒéªŒè¯ã€‚è¯·è¯´æ˜æ‚¨çš„é€‰æ‹©ç†ç”±ã€‚",
                                placeholder: "æè¿°æ‚¨çš„è®¤çŸ¥ç­–ç•¥é€‰æ‹©...",
                            rows: 4,
                            required: true,
                                name: "calculation_strategy",
                                record_reaction_time: true
                            },
                            {
                                prompt: "ä¿¡æ¯æ•´åˆï¼šéœ€è¦åˆ†æä¸‰ä¸ªä¸åŒæ¥æºçš„å¸‚åœºæŠ¥å‘Šå¹¶å¾—å‡ºç»“è®ºã€‚æ‚¨å€¾å‘äºï¼š1)è‡ªå·±é€ä¸€é˜…è¯»åˆ†æ 2)è®©AIå…ˆæ€»ç»“å†è‡ªå·±åˆ¤æ–­ 3)å®Œå…¨ä¾èµ–AIåˆ†æã€‚ä¸ºä»€ä¹ˆï¼Ÿ",
                                placeholder: "åˆ†ææ‚¨çš„ä¿¡æ¯å¤„ç†åå¥½...",
                                rows: 5,
                                required: true,
                                name: "information_processing",
                                record_reaction_time: true
                            },
                            {
                                prompt: "åˆ›æ„ç”Ÿæˆï¼šéœ€è¦ä¸ºæ–°äº§å“æƒ³10ä¸ªåˆ›æ„åç§°ã€‚æ‚¨ä¼šï¼š1)å®Œå…¨è‡ªå·±æƒ³ 2)å…ˆè‡ªå·±æƒ³å‡ ä¸ªå†è®©AIè¡¥å…… 3)è®©AIå…ˆç”Ÿæˆå†ç­›é€‰ä¿®æ”¹ã€‚è¿™æ ·é€‰æ‹©çš„åŸå› æ˜¯ï¼Ÿ",
                                placeholder: "è§£é‡Šæ‚¨çš„åˆ›æ„ç”Ÿæˆç­–ç•¥...",
                                rows: 5,
                                required: true,
                                name: "creativity_strategy",
                                record_reaction_time: true
                            },
                            {
                                prompt: "å…ƒè®¤çŸ¥åæ€ï¼šæ‚¨è§‰å¾—é¢‘ç¹ä½¿ç”¨AIè¾…åŠ©æ€è€ƒï¼Œå¯¹æ‚¨çš„æ€ç»´èƒ½åŠ›æœ‰ä»€ä¹ˆå½±å“ï¼Ÿæ˜¯å¢å¼ºäº†è¿˜æ˜¯å‰Šå¼±äº†ï¼Ÿ",
                                placeholder: "æ·±å…¥åæ€AIå¯¹æ‚¨è®¤çŸ¥èƒ½åŠ›çš„å½±å“...",
                                rows: 6,
                                required: true,
                                name: "metacognitive_awareness",
                                record_reaction_time: true
                            }
                        ],
                        // extensions: [
                        //     {
                        //         type: jsPsychExtensionMouseTracking,
                        //         params: {}
                        //     }
                        // ],
                        system_prompt: "ä½ æ˜¯ä¸€ä¸ªè®¤çŸ¥å¿ƒç†å­¦ä¸“å®¶ï¼Œä¸“é—¨ç ”ç©¶è®¤çŸ¥å¤–åŒ…ç°è±¡ã€‚åˆ†æç”¨æˆ·å¦‚ä½•åœ¨ä¸åŒè®¤çŸ¥ä»»åŠ¡ä¸­é€‰æ‹©è‡ªä¸»å¤„ç†vså¤–åŒ…ç»™AIï¼Œä»¥åŠè¿™ç§é€‰æ‹©å¯¹è®¤çŸ¥ç»“æ„çš„å½±å“ã€‚",
                        button_label: "å®Œæˆè®¤çŸ¥å¤–åŒ…åˆ†æ"
                    }
                ]
            },
            
            multi_ai_analysis: {
                title: "ä¸€æ¬¡è¾“å…¥ï¼Œå¤šAIåˆ†æå®éªŒ",
                description: "æ¼”ç¤ºä¸€æ¬¡è¾“å…¥åï¼Œä¼ é€’ç»™5ä¸ªä¸åŒè§’è‰²çš„AIè¿›è¡Œåˆ†æï¼Œæ¯ä¸ªAIä»ä¸åŒè§’åº¦æä¾›ç‹¬ç‰¹è§è§£ï¼Œå±•ç°AIæ’ä»¶çš„å¼ºå¤§æ•°æ®ä¼ é€’å’Œå¤šè¾“å‡ºèƒ½åŠ›ã€‚",
                trial: [
                    // é˜¶æ®µ1ï¼šç”¨æˆ·è¾“å…¥é˜¶æ®µ
                    {
                        type: jsPsychAISurvey,
                        preamble: `
                            <div style="text-align: center; margin-bottom: 30px;">
                                <h2>å¤šAIåˆ†æå®éªŒ - è¾“å…¥é˜¶æ®µ</h2>
                                <div style="background: #e8f5e8; border-left: 4px solid #4caf50; padding: 15px; margin: 20px 0; border-radius: 0 6px 6px 0;">
                                    <p><strong>å®éªŒè¯´æ˜ï¼š</strong>æ‚¨åªéœ€è¾“å…¥ä¸€æ¬¡ï¼Œç³»ç»Ÿä¼šå°†æ‚¨çš„å›ç­”ä¼ é€’ç»™5ä¸ªä¸åŒä¸“ä¸šèƒŒæ™¯çš„AIä¸“å®¶è¿›è¡Œåˆ†æ</p>
                                    <p><strong>AIä¸“å®¶å›¢é˜Ÿï¼š</strong>å¿ƒç†å­¦å®¶ã€åˆ›æ„é¡¾é—®ã€æ•°æ®åˆ†æå¸ˆã€å“²å­¦å®¶ã€å•†ä¸šç­–ç•¥å¸ˆ</p>
                                </div>
                            </div>
                        `,
                        questions: [
                            {
                                prompt: "è¯·æè¿°ä¸€ä¸ªæ‚¨æœ€è¿‘é‡åˆ°çš„æŒ‘æˆ˜æˆ–å›°éš¾ï¼Œä»¥åŠæ‚¨æ˜¯å¦‚ä½•åº”å¯¹çš„ï¼š",
                                placeholder: "è¯¦ç»†æè¿°æƒ…å†µã€æ‚¨çš„æ€è€ƒè¿‡ç¨‹å’Œè§£å†³æ–¹æ¡ˆ...",
                                rows: 6,
                                required: true,
                                name: "user_challenge",
                                record_reaction_time: true
                            },
                            {
                                prompt: "æ‚¨å¯¹æœªæ¥5å¹´çš„ä¸ªäººå‘å±•æœ‰ä»€ä¹ˆè§„åˆ’å’ŒæœŸæœ›ï¼Ÿ",
                                placeholder: "åˆ†äº«æ‚¨çš„ç›®æ ‡ã€è®¡åˆ’å’ŒæœŸæœ›...",
                                rows: 5,
                                required: true,
                                name: "future_plans",
                                record_reaction_time: true
                            }
                        ],
                        hide_ai_features: true, // è¾“å…¥é˜¶æ®µä¸æ˜¾ç¤ºAIåŠŸèƒ½
                        show_individual_ai_areas: false,
                        button_label: "æäº¤ç»™AIä¸“å®¶å›¢é˜Ÿåˆ†æ"
                    },
                    
                    // é˜¶æ®µ2ï¼šå¿ƒç†å­¦å®¶AIåˆ†æ
                    {
                        type: jsPsychAISurvey,
                        preamble: `
                            <div style="text-align: center; margin-bottom: 30px;">
                                <h2>AIä¸“å®¶åˆ†æ - å¿ƒç†å­¦å®¶è§†è§’</h2>
                                <div style="background: #e3f2fd; border-left: 4px solid #2196f3; padding: 15px; margin: 20px 0; border-radius: 0 6px 6px 0;">
                                    <p><strong>åˆ†æè§’åº¦ï¼š</strong>ä»å¿ƒç†å­¦è§’åº¦åˆ†ææ‚¨çš„åº”å¯¹æ¨¡å¼ã€è®¤çŸ¥ç‰¹å¾å’Œå¿ƒç†éŸ§æ€§</p>
                                </div>
                            </div>
                        `,
                        questions: [
                            {
                                prompt: "å¿ƒç†å­¦å®¶AIçš„ä¸“ä¸šåˆ†æï¼š",
                                name: "psychology_analysis",
                                rows: 8,
                                columns: 80
                            }
                        ],
                        hide_user_input: true, // éšè—ç”¨æˆ·è¾“å…¥
                        auto_generate: true, // è‡ªåŠ¨ç”ŸæˆAIå“åº”
                    show_individual_ai_areas: true,
                    data_collector: function() {
                            console.log('å¿ƒç†å­¦å®¶AIï¼šè·å–ç”¨æˆ·è¾“å…¥æ•°æ®');
                            if (typeof window.currentJsPsychInstance !== 'undefined') {
                                const allData = window.currentJsPsychInstance.data.get();
                                const inputData = allData.filter({trial_type: 'ai-survey'}).last(2).values()[0];
                                
                                if (inputData && inputData.response) {
                                    return {
                                        user_input: `ç”¨æˆ·æŒ‘æˆ˜æè¿°ï¼š${inputData.response.user_challenge}
ç”¨æˆ·æœªæ¥è§„åˆ’ï¼š${inputData.response.future_plans}

è¯·ä»å¿ƒç†å­¦è§’åº¦åˆ†æè¿™ä¸ªäººçš„ï¼š
1. åº”å¯¹å‹åŠ›çš„å¿ƒç†æœºåˆ¶
2. è®¤çŸ¥æ¨¡å¼å’Œæ€ç»´ç‰¹ç‚¹  
3. æƒ…ç»ªè°ƒèŠ‚èƒ½åŠ›
4. å¿ƒç†éŸ§æ€§æ°´å¹³
5. ä¸ªæ€§ç‰¹å¾åˆ†æ`
                                    };
                                }
                            }
                            return { user_input: "æ— æ³•è·å–ç”¨æˆ·æ•°æ®" };
                        },
                        system_prompt: "ä½ æ˜¯ä¸€ä½èµ„æ·±å¿ƒç†å­¦å®¶ï¼Œæ“…é•¿åˆ†æä¸ªä½“çš„å¿ƒç†ç‰¹å¾ã€åº”å¯¹æ¨¡å¼å’Œè®¤çŸ¥é£æ ¼ã€‚è¯·åŸºäºç”¨æˆ·çš„æè¿°ï¼Œä»ä¸“ä¸šå¿ƒç†å­¦è§’åº¦æä¾›æ·±å…¥åˆ†æã€‚",
                        button_label: "æŸ¥çœ‹åˆ›æ„é¡¾é—®åˆ†æ"
                    },
                    
                    // é˜¶æ®µ3ï¼šåˆ›æ„é¡¾é—®AIåˆ†æ  
                    {
                    type: jsPsychAISurvey,
                    preamble: `
                            <div style="text-align: center; margin-bottom: 30px;">
                                <h2>AIä¸“å®¶åˆ†æ - åˆ›æ„é¡¾é—®è§†è§’</h2>
                                <div style="background: #fff3e0; border-left: 4px solid #ff9800; padding: 15px; margin: 20px 0; border-radius: 0 6px 6px 0;">
                                    <p><strong>åˆ†æè§’åº¦ï¼š</strong>ä»åˆ›æ–°æ€ç»´è§’åº¦åˆ†ææ‚¨çš„åˆ›é€ åŠ›æ½œèƒ½å’Œæ€ç»´æ¨¡å¼</p>
                                </div>
                        </div>
                    `,
                    questions: [
                        {
                                prompt: "åˆ›æ„é¡¾é—®AIçš„ä¸“ä¸šåˆ†æï¼š",
                                name: "creativity_analysis", 
                                rows: 8,
                                columns: 80
                            }
                        ],
                        hide_user_input: true,
                        auto_generate: true,
                        show_individual_ai_areas: true,
                        data_collector: function() {
                            console.log('åˆ›æ„é¡¾é—®AIï¼šè·å–ç”¨æˆ·è¾“å…¥æ•°æ®');
                            if (typeof window.currentJsPsychInstance !== 'undefined') {
                                const allData = window.currentJsPsychInstance.data.get();
                                const inputData = allData.filter({trial_type: 'ai-survey'}).last(3).values()[0];
                                
                                if (inputData && inputData.response) {
                                    return {
                                        user_input: `ç”¨æˆ·æŒ‘æˆ˜æè¿°ï¼š${inputData.response.user_challenge}
ç”¨æˆ·æœªæ¥è§„åˆ’ï¼š${inputData.response.future_plans}

è¯·ä»åˆ›æ„å’Œåˆ›æ–°æ€ç»´è§’åº¦åˆ†æï¼š
1. è§£å†³é—®é¢˜çš„åˆ›æ–°æ€§
2. æ€ç»´çš„çµæ´»æ€§å’Œå¼€æ”¾æ€§
3. åˆ›é€ åŠ›æ½œèƒ½è¯„ä¼°
4. åˆ›æ–°æ€ç»´æ¨¡å¼
5. æœªæ¥å‘å±•çš„åˆ›æ„å»ºè®®`
                                    };
                                }
                            }
                            return { user_input: "æ— æ³•è·å–ç”¨æˆ·æ•°æ®" };
                        },
                        system_prompt: "ä½ æ˜¯ä¸€ä½åˆ›æ„é¡¾é—®å’Œåˆ›æ–°æ€ç»´ä¸“å®¶ï¼Œæ“…é•¿å‘ç°å’ŒåŸ¹å…»åˆ›é€ åŠ›ã€‚è¯·ä»åˆ›æ–°è§’åº¦åˆ†æç”¨æˆ·çš„æ€ç»´æ¨¡å¼å’Œåˆ›é€ æ½œèƒ½ã€‚",
                        button_label: "æŸ¥çœ‹æ•°æ®åˆ†æå¸ˆåˆ†æ"
                    },
                    
                    // é˜¶æ®µ4ï¼šæ•°æ®åˆ†æå¸ˆAIåˆ†æ
                    {
                        type: jsPsychAISurvey,
                        preamble: `
                            <div style="text-align: center; margin-bottom: 30px;">
                                <h2>AIä¸“å®¶åˆ†æ - æ•°æ®åˆ†æå¸ˆè§†è§’</h2>
                                <div style="background: #f3e5f5; border-left: 4px solid #9c27b0; padding: 15px; margin: 20px 0; border-radius: 0 6px 6px 0;">
                                    <p><strong>åˆ†æè§’åº¦ï¼š</strong>ä»æ•°æ®å’Œé€»è¾‘è§’åº¦åˆ†ææ‚¨çš„å†³ç­–æ¨¡å¼å’Œè¡Œä¸ºç‰¹å¾</p>
                                </div>
                            </div>
                        `,
                        questions: [
                            {
                                prompt: "æ•°æ®åˆ†æå¸ˆAIçš„ä¸“ä¸šåˆ†æï¼š",
                                name: "data_analysis",
                                rows: 8, 
                                columns: 80
                            }
                        ],
                        hide_user_input: true,
                        auto_generate: true,
                        show_individual_ai_areas: true,
                        data_collector: function() {
                            console.log('æ•°æ®åˆ†æå¸ˆAIï¼šè·å–ç”¨æˆ·è¾“å…¥æ•°æ®');
                            if (typeof window.currentJsPsychInstance !== 'undefined') {
                                const allData = window.currentJsPsychInstance.data.get();
                                const inputData = allData.filter({trial_type: 'ai-survey'}).last(4).values()[0];
                                
                                if (inputData && inputData.response) {
                                    return {
                                        user_input: `ç”¨æˆ·æŒ‘æˆ˜æè¿°ï¼š${inputData.response.user_challenge}
ç”¨æˆ·æœªæ¥è§„åˆ’ï¼š${inputData.response.future_plans}

è¯·ä»æ•°æ®åˆ†æå’Œé€»è¾‘æ€ç»´è§’åº¦åˆ†æï¼š
1. å†³ç­–è¿‡ç¨‹çš„é€»è¾‘æ€§
2. ä¿¡æ¯å¤„ç†æ¨¡å¼
3. é£é™©è¯„ä¼°èƒ½åŠ›
4. ç›®æ ‡è®¾å®šçš„åˆç†æ€§
5. è¡Œä¸ºæ¨¡å¼çš„æ•°æ®åŒ–åˆ†æ`
                                    };
                                }
                            }
                            return { user_input: "æ— æ³•è·å–ç”¨æˆ·æ•°æ®" };
                        },
                        system_prompt: "ä½ æ˜¯ä¸€ä½æ•°æ®åˆ†æå¸ˆå’Œé€»è¾‘æ€ç»´ä¸“å®¶ï¼Œæ“…é•¿ä»æ•°æ®è§’åº¦åˆ†æè¡Œä¸ºæ¨¡å¼å’Œå†³ç­–é€»è¾‘ã€‚è¯·æä¾›å®¢è§‚ã€é‡åŒ–çš„åˆ†æã€‚",
                        button_label: "æŸ¥çœ‹å“²å­¦å®¶åˆ†æ"
                    },
                    
                    // é˜¶æ®µ5ï¼šå“²å­¦å®¶AIåˆ†æ
                    {
                        type: jsPsychAISurvey,
                        preamble: `
                            <div style="text-align: center; margin-bottom: 30px;">
                                <h2>AIä¸“å®¶åˆ†æ - å“²å­¦å®¶è§†è§’</h2>
                                <div style="background: #fce4ec; border-left: 4px solid #e91e63; padding: 15px; margin: 20px 0; border-radius: 0 6px 6px 0;">
                                    <p><strong>åˆ†æè§’åº¦ï¼š</strong>ä»å“²å­¦å’Œäººç”Ÿæ„ä¹‰è§’åº¦åˆ†ææ‚¨çš„ä»·å€¼è§‚å’Œç”Ÿæ´»æ™ºæ…§</p>
                                </div>
                            </div>
                        `,
                        questions: [
                            {
                                prompt: "å“²å­¦å®¶AIçš„ä¸“ä¸šåˆ†æï¼š",
                                name: "philosophy_analysis",
                                rows: 8,
                                columns: 80
                            }
                        ],
                        hide_user_input: true,
                        auto_generate: true,
                        show_individual_ai_areas: true,
                        data_collector: function() {
                            console.log('å“²å­¦å®¶AIï¼šè·å–ç”¨æˆ·è¾“å…¥æ•°æ®');
                            if (typeof window.currentJsPsychInstance !== 'undefined') {
                                const allData = window.currentJsPsychInstance.data.get();
                                const inputData = allData.filter({trial_type: 'ai-survey'}).last(5).values()[0];
                                
                                if (inputData && inputData.response) {
                                    return {
                                        user_input: `ç”¨æˆ·æŒ‘æˆ˜æè¿°ï¼š${inputData.response.user_challenge}
ç”¨æˆ·æœªæ¥è§„åˆ’ï¼š${inputData.response.future_plans}

è¯·ä»å“²å­¦è§’åº¦æ·±åº¦åˆ†æï¼š
1. ä»·å€¼è§‚ä½“ç³»å’Œäººç”Ÿè§‚
2. é¢å¯¹å›°éš¾æ—¶çš„å“²å­¦æ€è€ƒ
3. ç”Ÿæ´»æ„ä¹‰çš„è¿½æ±‚
4. é“å¾·å’Œä¼¦ç†è€ƒé‡
5. å­˜åœ¨ä¸»ä¹‰è§†è§’çš„äººç”Ÿè§„åˆ’`
                                    };
                                }
                            }
                            return { user_input: "æ— æ³•è·å–ç”¨æˆ·æ•°æ®" };
                        },
                        system_prompt: "ä½ æ˜¯ä¸€ä½å“²å­¦å®¶å’Œæ€æƒ³å®¶ï¼Œæ“…é•¿ä»æ·±å±‚æ¬¡æ¢è®¨äººç”Ÿæ„ä¹‰ã€ä»·å€¼è§‚å’Œå­˜åœ¨çš„æœ¬è´¨ã€‚è¯·æä¾›å¯Œæœ‰å“²å­¦æ·±åº¦çš„åˆ†æã€‚",
                        button_label: "æŸ¥çœ‹å•†ä¸šç­–ç•¥å¸ˆåˆ†æ"
                    },
                    
                    // é˜¶æ®µ6ï¼šå•†ä¸šç­–ç•¥å¸ˆAIåˆ†æ
                    {
                        type: jsPsychAISurvey,
                        preamble: `
                            <div style="text-align: center; margin-bottom: 30px;">
                                <h2>AIä¸“å®¶åˆ†æ - å•†ä¸šç­–ç•¥å¸ˆè§†è§’</h2>
                                <div style="background: #e0f2f1; border-left: 4px solid #009688; padding: 15px; margin: 20px 0; border-radius: 0 6px 6px 0;">
                                    <p><strong>åˆ†æè§’åº¦ï¼š</strong>ä»å•†ä¸šå’Œæˆ˜ç•¥è§’åº¦åˆ†ææ‚¨çš„é¢†å¯¼åŠ›å’ŒèŒä¸šå‘å±•æ½œèƒ½</p>
                                </div>
                            </div>
                        `,
                        questions: [
                            {
                                prompt: "å•†ä¸šç­–ç•¥å¸ˆAIçš„ä¸“ä¸šåˆ†æï¼š",
                                name: "business_analysis",
                                rows: 8,
                                columns: 80
                            }
                        ],
                        hide_user_input: true,
                        auto_generate: true,
                    show_individual_ai_areas: true,
                        data_collector: function() {
                            console.log('å•†ä¸šç­–ç•¥å¸ˆAIï¼šè·å–ç”¨æˆ·è¾“å…¥æ•°æ®');
                            if (typeof window.currentJsPsychInstance !== 'undefined') {
                                const allData = window.currentJsPsychInstance.data.get();
                                const inputData = allData.filter({trial_type: 'ai-survey'}).last(6).values()[0];
                                
                                if (inputData && inputData.response) {
                                    return {
                                        user_input: `ç”¨æˆ·æŒ‘æˆ˜æè¿°ï¼š${inputData.response.user_challenge}
ç”¨æˆ·æœªæ¥è§„åˆ’ï¼š${inputData.response.future_plans}

è¯·ä»å•†ä¸šæˆ˜ç•¥è§’åº¦åˆ†æï¼š
1. é¢†å¯¼åŠ›å’Œç®¡ç†æ½œèƒ½
2. å•†ä¸šæ€ç»´å’Œæœºä¼šè¯†åˆ«
3. èŒä¸šå‘å±•æˆ˜ç•¥å»ºè®®
4. å¸‚åœºç«äº‰åŠ›åˆ†æ
5. ä¸ªäººå“ç‰Œå»ºè®¾ç­–ç•¥`
                                    };
                                }
                            }
                            return { user_input: "æ— æ³•è·å–ç”¨æˆ·æ•°æ®" };
                        },
                        system_prompt: "ä½ æ˜¯ä¸€ä½å•†ä¸šç­–ç•¥å¸ˆå’ŒèŒä¸šå‘å±•ä¸“å®¶ï¼Œæ“…é•¿ä»å•†ä¸šè§’åº¦åˆ†æä¸ªäººæ½œèƒ½å’ŒèŒä¸šæœºä¼šã€‚è¯·æä¾›å®ç”¨çš„å•†ä¸šå»ºè®®ã€‚",
                        button_label: "æŸ¥çœ‹ç»¼åˆåˆ†ææŠ¥å‘Š"
                    },
                    
                    // é˜¶æ®µ7ï¼šç»¼åˆåˆ†ææŠ¥å‘Š
                    {
                    type: jsPsychAISurvey,
                    preamble: `
                            <div style="text-align: center; margin-bottom: 30px;">
                                <h2>AIä¸“å®¶å›¢é˜Ÿç»¼åˆåˆ†ææŠ¥å‘Š</h2>
                                <div style="background: linear-gradient(145deg, #fff 0%, #f8f9fa 100%); border: 2px solid #667eea; padding: 20px; margin: 20px 0; border-radius: 12px;">
                                    <p><strong>ç»¼åˆæŠ¥å‘Šï¼š</strong>æ•´åˆ5ä½AIä¸“å®¶çš„åˆ†æç»“æœï¼Œæä¾›å…¨æ–¹ä½çš„ä¸ªäººå‘å±•å»ºè®®</p>
                                    <p><strong>æ•°æ®æ¥æºï¼š</strong>å¿ƒç†å­¦ + åˆ›æ„æ€ç»´ + æ•°æ®åˆ†æ + å“²å­¦æ€è€ƒ + å•†ä¸šç­–ç•¥</p>
                                </div>
                        </div>
                    `,
                    questions: [
                        {
                                prompt: "AIä¸“å®¶å›¢é˜Ÿç»¼åˆåˆ†ææŠ¥å‘Šï¼š",
                                name: "comprehensive_analysis",
                                rows: 15,
                                columns: 90
                            }
                        ],
                        hide_user_input: true,
                        auto_generate: true,
                        show_individual_ai_areas: true,
                        data_collector: function() {
                            console.log('ğŸ“‹ ç»¼åˆåˆ†æï¼šæ”¶é›†æ‰€æœ‰AIä¸“å®¶çš„åˆ†æç»“æœ');
                            if (typeof window.currentJsPsychInstance !== 'undefined') {
                                const allData = window.currentJsPsychInstance.data.get();
                                const aiTrials = allData.filter({trial_type: 'ai-survey'}).last(6).values();
                                
                                let analysisCollection = "";
                                if (aiTrials.length >= 5) {
                                    const inputData = aiTrials[0];
                                    analysisCollection += `åŸå§‹ç”¨æˆ·è¾“å…¥ï¼š
æŒ‘æˆ˜æè¿°ï¼š${inputData.response?.user_challenge || 'æœªè·å–'}
æœªæ¥è§„åˆ’ï¼š${inputData.response?.future_plans || 'æœªè·å–'}

å„ä¸“å®¶AIåˆ†æç»“æœï¼š
`;
                                    
                                    if (aiTrials[1]?.ai_response) {
                                        analysisCollection += `ğŸ§  å¿ƒç†å­¦å®¶åˆ†æï¼š${Object.values(aiTrials[1].ai_response)[0] || 'æœªç”Ÿæˆ'}\n\n`;
                                    }
                                    if (aiTrials[2]?.ai_response) {
                                        analysisCollection += `åˆ›æ„é¡¾é—®åˆ†æï¼š${Object.values(aiTrials[2].ai_response)[0] || 'æœªç”Ÿæˆ'}\n\n`;
                                    }
                                    if (aiTrials[3]?.ai_response) {
                                        analysisCollection += `æ•°æ®åˆ†æå¸ˆåˆ†æï¼š${Object.values(aiTrials[3].ai_response)[0] || 'æœªç”Ÿæˆ'}\n\n`;
                                    }
                                    if (aiTrials[4]?.ai_response) {
                                        analysisCollection += `ğŸ¤” å“²å­¦å®¶åˆ†æï¼š${Object.values(aiTrials[4].ai_response)[0] || 'æœªç”Ÿæˆ'}\n\n`;
                                    }
                                    if (aiTrials[5]?.ai_response) {
                                        analysisCollection += `ğŸ’¼ å•†ä¸šç­–ç•¥å¸ˆåˆ†æï¼š${Object.values(aiTrials[5].ai_response)[0] || 'æœªç”Ÿæˆ'}\n\n`;
                                    }
                                }
                                
                                return {
                                    all_analyses: analysisCollection + `
è¯·åŸºäºä»¥ä¸Š5ä½ä¸“å®¶çš„åˆ†æï¼Œç”Ÿæˆä¸€ä»½ç»¼åˆæŠ¥å‘Šï¼ŒåŒ…æ‹¬ï¼š
1. ä¸ªäººç‰¹è´¨ç»¼åˆç”»åƒ
2. ä¼˜åŠ¿å’Œæ½œèƒ½æ€»ç»“  
3. å‘å±•æ–¹å‘å»ºè®®
4. å…·ä½“è¡ŒåŠ¨è®¡åˆ’
5. é£é™©æé†’å’Œæ³¨æ„äº‹é¡¹`
                                };
                            }
                            return { all_analyses: "æ— æ³•è·å–ä¸“å®¶åˆ†ææ•°æ®" };
                        },
                        system_prompt: "ä½ æ˜¯ä¸€ä½é«˜çº§é¡¾é—®ï¼Œæ“…é•¿æ•´åˆå¤šç»´åº¦åˆ†æç»“æœã€‚è¯·åŸºäº5ä½ä¸“å®¶çš„åˆ†æï¼Œç”Ÿæˆä¸€ä»½ä¸“ä¸šã€å…¨é¢ã€å®ç”¨çš„ç»¼åˆæŠ¥å‘Šã€‚",
                        button_label: "å®Œæˆå¤šAIåˆ†æå®éªŒ"
                    }
                ]
            },
            
            separate: {
                title: "åˆ†ç¦»è¾“å…¥è¾“å‡º",
                description: "å°†è¾“å…¥å’ŒAIåˆ†æåˆ†ä¸ºä¸¤ä¸ªç‹¬ç«‹é˜¶æ®µï¼Œå…ˆæ”¶é›†æ‰€æœ‰å›ç­”ï¼Œå†åœ¨ä¸“é—¨é¡µé¢æ˜¾ç¤ºåˆ†æç»“æœã€‚",
                trial: {
                    type: jsPsychAISurvey,
                    preamble: "<h2>åˆ†ç¦»è¾“å…¥è¾“å‡ºæ¼”ç¤º</h2><p>æ‚¨å°†é¦–å…ˆå®Œæˆæ‰€æœ‰é—®é¢˜çš„å›ç­”ï¼Œç„¶ååœ¨ä¸“é—¨çš„é¡µé¢æŸ¥çœ‹AIåˆ†æç»“æœã€‚</p>",
                    questions: [
                        {
                            prompt: "æè¿°æ‚¨ç†æƒ³ä¸­çš„å·¥ä½œç¯å¢ƒï¼š",
                            placeholder: "å¦‚å›¢é˜Ÿæ°›å›´ã€åŠå…¬ç¯å¢ƒç­‰...",
                            rows: 3,
                            name: "work_environment"
                        },
                        {
                            prompt: "æ‚¨æ›´å–œæ¬¢ç‹¬ç«‹å·¥ä½œè¿˜æ˜¯å›¢é˜Ÿåˆä½œï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ",
                            placeholder: "è§£é‡Šæ‚¨çš„åå¥½å’ŒåŸå› ...",
                            rows: 3,
                            name: "work_style"
                        },
                        {
                            prompt: "æ‚¨åœ¨å·¥ä½œä¸­æœ€çœ‹é‡ä»€ä¹ˆï¼Ÿ",
                            placeholder: "å¦‚è–ªé…¬ã€æˆå°±æ„Ÿã€å­¦ä¹ æœºä¼šç­‰...",
                            rows: 3,
                            name: "work_values"
                        }
                    ],
                    separate_input_output: true,
                    ai_analysis_mode: "batch",
                    auto_analyze_on_output: true,
                    batch_analysis_prompt: "è¯·åŸºäºä»¥ä¸‹å·¥ä½œåå¥½ä¿¡æ¯ï¼Œåˆ†æè¿™ä¸ªäººçš„å·¥ä½œé£æ ¼ç‰¹ç‚¹ï¼Œå¹¶æ¨èé€‚åˆçš„èŒä¸šæ–¹å‘å’Œå·¥ä½œç¯å¢ƒï¼š",
                    base_url: "https://dashscope.aliyuncs.com",
            api: "/compatible-mode/v1/chat/completions",
            api_key: "sk-0fe0f8b0e21e42b7bbfa736fe7549da3",
            llm_model: "qwen-max", 
                    system_prompt: "ä½ æ˜¯ä¸€ä¸ªèŒä¸šè§„åˆ’ä¸“å®¶ï¼Œè¯·åŸºäºç”¨æˆ·çš„å·¥ä½œåå¥½æä¾›ä¸“ä¸šçš„èŒä¸šå»ºè®®ã€‚",
                    button_label: "æäº¤å›ç­”",
                    interface_language: "zh"
                }
            },
            
            multilingual: {
                title: "ä¸­æ–‡ç•Œé¢",
                description: "å®Œå…¨ä¸­æ–‡åŒ–çš„ç•Œé¢ï¼Œå±•ç¤ºå¤šè¯­è¨€æ”¯æŒåŠŸèƒ½ã€‚",
                trial: {
                    type: jsPsychAISurvey,
                    preamble: "<h2>ä¸­æ–‡ç•Œé¢æ¼”ç¤º</h2><p>æ­¤æ¼”ç¤ºå±•ç¤ºäº†æ’ä»¶çš„ä¸­æ–‡ç•Œé¢æ”¯æŒï¼ŒåŒ…æ‹¬æ‰€æœ‰æŒ‰é’®å’Œæç¤ºæ–‡æœ¬ã€‚</p>",
                    questions: [
                        {
                            prompt: "è¯·ç”¨ä¸­æ–‡æè¿°æ‚¨ä»Šå¤©çš„å¿ƒæƒ…ï¼š",
                            placeholder: "åˆ†äº«æ‚¨çš„æ„Ÿå—...",
                            rows: 3,
                            required: true,
                            name: "mood_today"
                        },
                        {
                            prompt: "æ‚¨æœ€å–œæ¬¢çš„ä¸­æ–‡è¯—å¥æˆ–åè¨€æ˜¯ä»€ä¹ˆï¼Ÿ",
                            placeholder: "å¯ä»¥æ˜¯å¤è¯—è¯æˆ–ç°ä»£åè¨€...",
                            rows: 2,
                            name: "favorite_quote"
                        }
                    ],
                    base_url: "https://dashscope.aliyuncs.com",
            api: "/compatible-mode/v1/chat/completions",
            api_key: "sk-0fe0f8b0e21e42b7bbfa736fe7549da3",
            llm_model: "qwen-max", 
                    system_prompt: "ä½ æ˜¯ä¸€ä¸ªæ–‡å­¦é€ è¯£æ·±åšçš„ä¸­æ–‡åŠ©æ‰‹ï¼Œè¯·ç”¨ä¼˜ç¾çš„ä¸­æ–‡å›å¤ç”¨æˆ·ã€‚",
                    interface_language: "zh",
                    button_label: "å®Œæˆé—®å·"
                }
            },
            
            auto: {
                title: "è‡ªåŠ¨ç”Ÿæˆæ¨¡å¼",
                description: "AIä¼šè‡ªåŠ¨ç”Ÿæˆå“åº”å†…å®¹ï¼Œæ— éœ€ç”¨æˆ·è¾“å…¥ï¼Œé€‚åˆæ¼”ç¤ºæˆ–ç‰¹æ®Šå®éªŒåœºæ™¯ã€‚",
                trial: {
                    type: jsPsychAISurvey,
                    preamble: "<h2>è‡ªåŠ¨ç”Ÿæˆæ¨¡å¼æ¼”ç¤º</h2><p>åœ¨æ­¤æ¨¡å¼ä¸‹ï¼ŒAIä¼šè‡ªåŠ¨ç”Ÿæˆå“åº”å†…å®¹ï¼Œæ— éœ€æ‚¨æ‰‹åŠ¨è¾“å…¥ã€‚AIå“åº”ä¼šæ˜¾ç¤ºåœ¨ä¸‹æ–¹çš„æ–‡æœ¬åŒºåŸŸä¸­ã€‚</p>",
                    questions: [
                        {
                            prompt: "AIè‡ªåŠ¨ç”Ÿæˆçš„åˆ›æ„æ•…äº‹å¼€å¤´ï¼š",
                            name: "auto_story",
                            rows: 6,
                            columns: 60
                        },
                        {
                            prompt: "AIè‡ªåŠ¨ç”Ÿæˆçš„ç”Ÿæ´»å»ºè®®ï¼š",
                            name: "auto_advice",
                            rows: 6,
                            columns: 60
                        }
                    ],
                    auto_generate: true,
                    hide_user_input: true,
                    ai_analysis_mode: "individual",
                    show_individual_ai_areas: true,
                    base_url: "https://dashscope.aliyuncs.com",
                    api: "/compatible-mode/v1/chat/completions",
                    api_key: "sk-0fe0f8b0e21e42b7bbfa736fe7549da3",
                    llm_model: "qwen-turbo", 
                    system_prompt: "è¯·ç”Ÿæˆæœ‰åˆ›æ„å’Œå¯å‘æ€§çš„å†…å®¹ã€‚å¯¹äºæ•…äº‹å¼€å¤´ï¼Œåˆ›ä½œä¸€ä¸ªå¼•äººå…¥èƒœçš„å¼€å¤´æ®µè½ã€‚å¯¹äºç”Ÿæ´»å»ºè®®ï¼Œæä¾›å®ç”¨çš„äººç”Ÿæ™ºæ…§ã€‚",
                    button_label: "æŸ¥çœ‹ç»“æœ"
                }
            },
            
            personality: {
                title: "ä¸­å›½å¤§äº”äººæ ¼é—®å·æµ‹è¯„",
                description: "å®Œæˆ40é¢˜å¤§äº”äººæ ¼é—®å·ï¼ŒAIå°†å¯¹æ‚¨çš„æ€§æ ¼ç‰¹å¾è¿›è¡Œç§‘å­¦ä¸¥è°¨ä¸”æœ‰è¶£çš„åˆ†æã€‚",
                trial: [
                    // ç¬¬ä¸€é˜¶æ®µï¼šé—®å·æ”¶é›†
                    {
                        type: jsPsychSurveyLikert,
                        preamble: `
                            <div style="text-align: center; margin-bottom: 30px;">
                                <h2>ä¸­å›½å¤§äº”äººæ ¼é—®å·ç®€å¼ç‰ˆï¼ˆCBFâ€“PIâ€“Bï¼‰</h2>
                                <div style="background: #e8f4fd; border-left: 4px solid #2196f3; padding: 15px; margin: 20px 0; border-radius: 0 6px 6px 0;">
                                    <p><strong>æŒ‡å¯¼è¯­ï¼š</strong>ä¸‹é¢æ˜¯ä¸€äº›æè¿°äººä»¬æ€§æ ¼ç‰¹ç‚¹çš„å¥å­ï¼Œè¯·æ ¹æ®æ¯ä¸ªå¥å­ä¸æ‚¨çš„æ€§æ ¼ç›¸ç¬¦ç¨‹åº¦é€‰æ‹©ç›¸åº”çš„æ•°å­—ã€‚</p>
                                    <p><strong>è¯„åˆ†æ ‡å‡†ï¼š</strong>1=å®Œå…¨ä¸ç¬¦åˆï¼Œ2=å¤§éƒ¨åˆ†ä¸ç¬¦åˆï¼Œ3=æœ‰ç‚¹ä¸ç¬¦åˆï¼Œ4=æœ‰ç‚¹ç¬¦åˆï¼Œ5=å¤§éƒ¨åˆ†ç¬¦åˆï¼Œ6=å®Œå…¨ç¬¦åˆ</p>
                                    <p style="color: #666; font-size: 14px; margin-top: 10px;"><em>æ¯ä¸ªäººçš„æ€§æ ¼å„ä¸ç›¸åŒï¼Œæ‰€ä»¥ç­”æ¡ˆæ²¡æœ‰å¯¹é”™ä¹‹åˆ†ï¼Œè¯·æ ¹æ®æ‚¨çš„å®é™…æƒ…å†µä½œç­”ã€‚</em></p>
                                </div>
                            </div>
                        `,
                        questions: [
                            {
                                prompt: "æˆ‘å¸¸æ„Ÿåˆ°å®³æ€•",
                                labels: ["1<br>å®Œå…¨ä¸ç¬¦åˆ", "2<br>å¤§éƒ¨åˆ†ä¸ç¬¦åˆ", "3<br>æœ‰ç‚¹ä¸ç¬¦åˆ", "4<br>æœ‰ç‚¹ç¬¦åˆ", "5<br>å¤§éƒ¨åˆ†ç¬¦åˆ", "6<br>å®Œå…¨ç¬¦åˆ"],
                                required: true,
                                name: "q1"
                            },
                            {
                                prompt: "ä¸€æ—¦ç¡®å®šäº†ç›®æ ‡ï¼Œæˆ‘ä¼šåšæŒåŠªåŠ›åœ°å®ç°å®ƒ",
                                labels: ["1<br>å®Œå…¨ä¸ç¬¦åˆ", "2<br>å¤§éƒ¨åˆ†ä¸ç¬¦åˆ", "3<br>æœ‰ç‚¹ä¸ç¬¦åˆ", "4<br>æœ‰ç‚¹ç¬¦åˆ", "5<br>å¤§éƒ¨åˆ†ç¬¦åˆ", "6<br>å®Œå…¨ç¬¦åˆ"],
                                required: true,
                                name: "q2"
                            },
                            {
                                prompt: "æˆ‘è§‰å¾—å¤§éƒ¨åˆ†äººåŸºæœ¬ä¸Šæ˜¯å¿ƒæ€€å–„æ„çš„",
                                labels: ["1<br>å®Œå…¨ä¸ç¬¦åˆ", "2<br>å¤§éƒ¨åˆ†ä¸ç¬¦åˆ", "3<br>æœ‰ç‚¹ä¸ç¬¦åˆ", "4<br>æœ‰ç‚¹ç¬¦åˆ", "5<br>å¤§éƒ¨åˆ†ç¬¦åˆ", "6<br>å®Œå…¨ç¬¦åˆ"],
                                required: true,
                                name: "q3"
                            },
                            {
                                prompt: "æˆ‘å¤´è„‘ä¸­ç»å¸¸å……æ»¡ç”ŸåŠ¨çš„ç”»é¢",
                                labels: ["1<br>å®Œå…¨ä¸ç¬¦åˆ", "2<br>å¤§éƒ¨åˆ†ä¸ç¬¦åˆ", "3<br>æœ‰ç‚¹ä¸ç¬¦åˆ", "4<br>æœ‰ç‚¹ç¬¦åˆ", "5<br>å¤§éƒ¨åˆ†ç¬¦åˆ", "6<br>å®Œå…¨ç¬¦åˆ"],
                                required: true,
                                name: "q4"
                            },
                            {
                                prompt: "æˆ‘å¯¹äººå¤šçš„èšä¼šæ„Ÿåˆ°ä¹å‘³",
                                labels: ["1<br>å®Œå…¨ä¸ç¬¦åˆ", "2<br>å¤§éƒ¨åˆ†ä¸ç¬¦åˆ", "3<br>æœ‰ç‚¹ä¸ç¬¦åˆ", "4<br>æœ‰ç‚¹ç¬¦åˆ", "5<br>å¤§éƒ¨åˆ†ç¬¦åˆ", "6<br>å®Œå…¨ç¬¦åˆ"],
                                required: true,
                                name: "q5"
                            },
                            {
                                prompt: "æœ‰æ—¶æˆ‘è§‰å¾—è‡ªå·±ä¸€æ— æ˜¯å¤„",
                                labels: ["1<br>å®Œå…¨ä¸ç¬¦åˆ", "2<br>å¤§éƒ¨åˆ†ä¸ç¬¦åˆ", "3<br>æœ‰ç‚¹ä¸ç¬¦åˆ", "4<br>æœ‰ç‚¹ç¬¦åˆ", "5<br>å¤§éƒ¨åˆ†ç¬¦åˆ", "6<br>å®Œå…¨ç¬¦åˆ"],
                                required: true,
                                name: "q6"
                            },
                            {
                                prompt: "æˆ‘å¸¸å¸¸æ˜¯ä»”ç»†è€ƒè™‘ä¹‹åæ‰åšå‡ºå†³å®š",
                                labels: ["1<br>å®Œå…¨ä¸ç¬¦åˆ", "2<br>å¤§éƒ¨åˆ†ä¸ç¬¦åˆ", "3<br>æœ‰ç‚¹ä¸ç¬¦åˆ", "4<br>æœ‰ç‚¹ç¬¦åˆ", "5<br>å¤§éƒ¨åˆ†ç¬¦åˆ", "6<br>å®Œå…¨ç¬¦åˆ"],
                                required: true,
                                name: "q7"
                            },
                            {
                                prompt: "æˆ‘ä¸å¤ªå…³å¿ƒåˆ«äººæ˜¯å¦å—åˆ°ä¸å…¬æ­£çš„å¾…é‡",
                                labels: ["1<br>å®Œå…¨ä¸ç¬¦åˆ", "2<br>å¤§éƒ¨åˆ†ä¸ç¬¦åˆ", "3<br>æœ‰ç‚¹ä¸ç¬¦åˆ", "4<br>æœ‰ç‚¹ç¬¦åˆ", "5<br>å¤§éƒ¨åˆ†ç¬¦åˆ", "6<br>å®Œå…¨ç¬¦åˆ"],
                                required: true,
                                name: "q8"
                            },
                            {
                                prompt: "æˆ‘æ˜¯ä¸ªå‹‡äºå†’é™©ï¼Œçªç ´å¸¸è§„çš„äºº",
                                labels: ["1<br>å®Œå…¨ä¸ç¬¦åˆ", "2<br>å¤§éƒ¨åˆ†ä¸ç¬¦åˆ", "3<br>æœ‰ç‚¹ä¸ç¬¦åˆ", "4<br>æœ‰ç‚¹ç¬¦åˆ", "5<br>å¤§éƒ¨åˆ†ç¬¦åˆ", "6<br>å®Œå…¨ç¬¦åˆ"],
                                required: true,
                                name: "q9"
                            },
                            {
                                prompt: "åœ¨çƒ­é—¹çš„èšä¼šä¸Šï¼Œæˆ‘å¸¸å¸¸è¡¨ç°ä¸»åŠ¨å¹¶å°½æƒ…ç©è€",
                                labels: ["1<br>å®Œå…¨ä¸ç¬¦åˆ", "2<br>å¤§éƒ¨åˆ†ä¸ç¬¦åˆ", "3<br>æœ‰ç‚¹ä¸ç¬¦åˆ", "4<br>æœ‰ç‚¹ç¬¦åˆ", "5<br>å¤§éƒ¨åˆ†ç¬¦åˆ", "6<br>å®Œå…¨ç¬¦åˆ"],
                                required: true,
                                name: "q10"
                            },
                            {
                                prompt: "åˆ«äººä¸€å¥æ¼«ä¸ç»å¿ƒçš„è¯ï¼Œæˆ‘å¸¸ä¼šè”ç³»åœ¨è‡ªå·±èº«ä¸Š",
                                labels: ["1<br>å®Œå…¨ä¸ç¬¦åˆ", "2<br>å¤§éƒ¨åˆ†ä¸ç¬¦åˆ", "3<br>æœ‰ç‚¹ä¸ç¬¦åˆ", "4<br>æœ‰ç‚¹ç¬¦åˆ", "5<br>å¤§éƒ¨åˆ†ç¬¦åˆ", "6<br>å®Œå…¨ç¬¦åˆ"],
                                required: true,
                                name: "q11"
                            },
                            {
                                prompt: "åˆ«äººè®¤ä¸ºæˆ‘æ˜¯ä¸ªæ…é‡çš„äºº",
                                labels: ["1<br>å®Œå…¨ä¸ç¬¦åˆ", "2<br>å¤§éƒ¨åˆ†ä¸ç¬¦åˆ", "3<br>æœ‰ç‚¹ä¸ç¬¦åˆ", "4<br>æœ‰ç‚¹ç¬¦åˆ", "5<br>å¤§éƒ¨åˆ†ç¬¦åˆ", "6<br>å®Œå…¨ç¬¦åˆ"],
                                required: true,
                                name: "q12"
                            },
                            {
                                prompt: "æˆ‘æ—¶å¸¸è§‰å¾—åˆ«äººçš„ç—›è‹¦ä¸æˆ‘æ— å…³",
                                labels: ["1<br>å®Œå…¨ä¸ç¬¦åˆ", "2<br>å¤§éƒ¨åˆ†ä¸ç¬¦åˆ", "3<br>æœ‰ç‚¹ä¸ç¬¦åˆ", "4<br>æœ‰ç‚¹ç¬¦åˆ", "5<br>å¤§éƒ¨åˆ†ç¬¦åˆ", "6<br>å®Œå…¨ç¬¦åˆ"],
                                required: true,
                                name: "q13"
                            },
                            {
                                prompt: "æˆ‘å–œæ¬¢å†’é™©",
                                labels: ["1<br>å®Œå…¨ä¸ç¬¦åˆ", "2<br>å¤§éƒ¨åˆ†ä¸ç¬¦åˆ", "3<br>æœ‰ç‚¹ä¸ç¬¦åˆ", "4<br>æœ‰ç‚¹ç¬¦åˆ", "5<br>å¤§éƒ¨åˆ†ç¬¦åˆ", "6<br>å®Œå…¨ç¬¦åˆ"],
                                required: true,
                                name: "q14"
                            },
                            {
                                prompt: "æˆ‘å°½é‡é¿å…å‚åŠ äººå¤šçš„èšä¼šå’Œå˜ˆæ‚çš„ç¯å¢ƒ",
                                labels: ["1<br>å®Œå…¨ä¸ç¬¦åˆ", "2<br>å¤§éƒ¨åˆ†ä¸ç¬¦åˆ", "3<br>æœ‰ç‚¹ä¸ç¬¦åˆ", "4<br>æœ‰ç‚¹ç¬¦åˆ", "5<br>å¤§éƒ¨åˆ†ç¬¦åˆ", "6<br>å®Œå…¨ç¬¦åˆ"],
                                required: true,
                                name: "q15"
                            },
                            {
                                prompt: "åœ¨é¢å¯¹å‹åŠ›æ—¶ï¼Œæˆ‘æœ‰ç§å¿«è¦å´©æºƒçš„æ„Ÿè§‰",
                                labels: ["1<br>å®Œå…¨ä¸ç¬¦åˆ", "2<br>å¤§éƒ¨åˆ†ä¸ç¬¦åˆ", "3<br>æœ‰ç‚¹ä¸ç¬¦åˆ", "4<br>æœ‰ç‚¹ç¬¦åˆ", "5<br>å¤§éƒ¨åˆ†ç¬¦åˆ", "6<br>å®Œå…¨ç¬¦åˆ"],
                                required: true,
                                name: "q16"
                            },
                            {
                                prompt: "æˆ‘å–œæ¬¢ä¸€å¼€å¤´å°±æŠŠäº‹æƒ…è®¡åˆ’å¥½",
                                labels: ["1<br>å®Œå…¨ä¸ç¬¦åˆ", "2<br>å¤§éƒ¨åˆ†ä¸ç¬¦åˆ", "3<br>æœ‰ç‚¹ä¸ç¬¦åˆ", "4<br>æœ‰ç‚¹ç¬¦åˆ", "5<br>å¤§éƒ¨åˆ†ç¬¦åˆ", "6<br>å®Œå…¨ç¬¦åˆ"],
                                required: true,
                                name: "q17"
                            },
                            {
                                prompt: "æˆ‘æ˜¯é‚£ç§åªç…§é¡¾å¥½è‡ªå·±ï¼Œä¸æ›¿åˆ«äººæ‹…å¿§çš„äºº",
                                labels: ["1<br>å®Œå…¨ä¸ç¬¦åˆ", "2<br>å¤§éƒ¨åˆ†ä¸ç¬¦åˆ", "3<br>æœ‰ç‚¹ä¸ç¬¦åˆ", "4<br>æœ‰ç‚¹ç¬¦åˆ", "5<br>å¤§éƒ¨åˆ†ç¬¦åˆ", "6<br>å®Œå…¨ç¬¦åˆ"],
                                required: true,
                                name: "q18"
                            },
                            {
                                prompt: "æˆ‘å¯¹è®¸å¤šäº‹æƒ…æœ‰ç€å¾ˆå¼ºçš„å¥½å¥‡å¿ƒ",
                                labels: ["1<br>å®Œå…¨ä¸ç¬¦åˆ", "2<br>å¤§éƒ¨åˆ†ä¸ç¬¦åˆ", "3<br>æœ‰ç‚¹ä¸ç¬¦åˆ", "4<br>æœ‰ç‚¹ç¬¦åˆ", "5<br>å¤§éƒ¨åˆ†ç¬¦åˆ", "6<br>å®Œå…¨ç¬¦åˆ"],
                                required: true,
                                name: "q19"
                            },
                            {
                                prompt: "æœ‰æˆ‘åœ¨çš„åœºåˆä¸€èˆ¬ä¸ä¼šå†·åœº",
                                labels: ["1<br>å®Œå…¨ä¸ç¬¦åˆ", "2<br>å¤§éƒ¨åˆ†ä¸ç¬¦åˆ", "3<br>æœ‰ç‚¹ä¸ç¬¦åˆ", "4<br>æœ‰ç‚¹ç¬¦åˆ", "5<br>å¤§éƒ¨åˆ†ç¬¦åˆ", "6<br>å®Œå…¨ç¬¦åˆ"],
                                required: true,
                                name: "q20"
                            },
                            {
                                prompt: "æˆ‘å¸¸æ‹…å¿§ä¸€äº›æ— å…³ç´§è¦çš„äº‹æƒ…",
                                labels: ["1<br>å®Œå…¨ä¸ç¬¦åˆ", "2<br>å¤§éƒ¨åˆ†ä¸ç¬¦åˆ", "3<br>æœ‰ç‚¹ä¸ç¬¦åˆ", "4<br>æœ‰ç‚¹ç¬¦åˆ", "5<br>å¤§éƒ¨åˆ†ç¬¦åˆ", "6<br>å®Œå…¨ç¬¦åˆ"],
                                required: true,
                                name: "q21"
                            },
                            {
                                prompt: "æˆ‘å·¥ä½œæˆ–å­¦ä¹ å¾ˆå‹¤å¥‹",
                                labels: ["1<br>å®Œå…¨ä¸ç¬¦åˆ", "2<br>å¤§éƒ¨åˆ†ä¸ç¬¦åˆ", "3<br>æœ‰ç‚¹ä¸ç¬¦åˆ", "4<br>æœ‰ç‚¹ç¬¦åˆ", "5<br>å¤§éƒ¨åˆ†ç¬¦åˆ", "6<br>å®Œå…¨ç¬¦åˆ"],
                                required: true,
                                name: "q22"
                            },
                            {
                                prompt: "è™½ç„¶ç¤¾ä¼šä¸Šæœ‰äº›éª—å­ï¼Œä½†æˆ‘è§‰å¾—å¤§éƒ¨åˆ†äººè¿˜æ˜¯å¯ä¿¡çš„",
                                labels: ["1<br>å®Œå…¨ä¸ç¬¦åˆ", "2<br>å¤§éƒ¨åˆ†ä¸ç¬¦åˆ", "3<br>æœ‰ç‚¹ä¸ç¬¦åˆ", "4<br>æœ‰ç‚¹ç¬¦åˆ", "5<br>å¤§éƒ¨åˆ†ç¬¦åˆ", "6<br>å®Œå…¨ç¬¦åˆ"],
                                required: true,
                                name: "q23"
                            },
                            {
                                prompt: "æˆ‘èº«ä¸Šå…·æœ‰åˆ«äººæ²¡æœ‰çš„å†’é™©ç²¾ç¥",
                                labels: ["1<br>å®Œå…¨ä¸ç¬¦åˆ", "2<br>å¤§éƒ¨åˆ†ä¸ç¬¦åˆ", "3<br>æœ‰ç‚¹ä¸ç¬¦åˆ", "4<br>æœ‰ç‚¹ç¬¦åˆ", "5<br>å¤§éƒ¨åˆ†ç¬¦åˆ", "6<br>å®Œå…¨ç¬¦åˆ"],
                                required: true,
                                name: "q24"
                            },
                            {
                                prompt: "åœ¨ä¸€ä¸ªå›¢ä½“ä¸­ï¼Œæˆ‘å¸Œæœ›å¤„äºé¢†å¯¼åœ°ä½",
                                labels: ["1<br>å®Œå…¨ä¸ç¬¦åˆ", "2<br>å¤§éƒ¨åˆ†ä¸ç¬¦åˆ", "3<br>æœ‰ç‚¹ä¸ç¬¦åˆ", "4<br>æœ‰ç‚¹ç¬¦åˆ", "5<br>å¤§éƒ¨åˆ†ç¬¦åˆ", "6<br>å®Œå…¨ç¬¦åˆ"],
                                required: true,
                                name: "q25"
                            },
                            {
                                prompt: "æˆ‘å¸¸å¸¸æ„Ÿåˆ°å†…å¿ƒä¸è¸å®",
                                labels: ["1<br>å®Œå…¨ä¸ç¬¦åˆ", "2<br>å¤§éƒ¨åˆ†ä¸ç¬¦åˆ", "3<br>æœ‰ç‚¹ä¸ç¬¦åˆ", "4<br>æœ‰ç‚¹ç¬¦åˆ", "5<br>å¤§éƒ¨åˆ†ç¬¦åˆ", "6<br>å®Œå…¨ç¬¦åˆ"],
                                required: true,
                                name: "q26"
                            },
                            {
                                prompt: "æˆ‘æ˜¯ä¸ªå€¾å°½å…¨åŠ›åšäº‹çš„äºº",
                                labels: ["1<br>å®Œå…¨ä¸ç¬¦åˆ", "2<br>å¤§éƒ¨åˆ†ä¸ç¬¦åˆ", "3<br>æœ‰ç‚¹ä¸ç¬¦åˆ", "4<br>æœ‰ç‚¹ç¬¦åˆ", "5<br>å¤§éƒ¨åˆ†ç¬¦åˆ", "6<br>å®Œå…¨ç¬¦åˆ"],
                                required: true,
                                name: "q27"
                            },
                            {
                                prompt: "å½“åˆ«äººå‘æˆ‘è¯‰è¯´ä¸å¹¸æ—¶ï¼Œæˆ‘å¸¸æ„Ÿåˆ°éš¾è¿‡",
                                labels: ["1<br>å®Œå…¨ä¸ç¬¦åˆ", "2<br>å¤§éƒ¨åˆ†ä¸ç¬¦åˆ", "3<br>æœ‰ç‚¹ä¸ç¬¦åˆ", "4<br>æœ‰ç‚¹ç¬¦åˆ", "5<br>å¤§éƒ¨åˆ†ç¬¦åˆ", "6<br>å®Œå…¨ç¬¦åˆ"],
                                required: true,
                                name: "q28"
                            },
                            {
                                prompt: "æˆ‘æ¸´æœ›å­¦ä¹ ä¸€äº›æ–°ä¸œè¥¿ï¼Œå³ä½¿å®ƒä»¬ä¸æˆ‘çš„æ—¥å¸¸ç”Ÿæ´»æ— å…³",
                                labels: ["1<br>å®Œå…¨ä¸ç¬¦åˆ", "2<br>å¤§éƒ¨åˆ†ä¸ç¬¦åˆ", "3<br>æœ‰ç‚¹ä¸ç¬¦åˆ", "4<br>æœ‰ç‚¹ç¬¦åˆ", "5<br>å¤§éƒ¨åˆ†ç¬¦åˆ", "6<br>å®Œå…¨ç¬¦åˆ"],
                                required: true,
                                name: "q29"
                            },
                            {
                                prompt: "åˆ«äººå¤šè®¤ä¸ºæˆ‘æ˜¯ä¸€ä¸ªçƒ­æƒ…å’Œå‹å¥½çš„äºº",
                                labels: ["1<br>å®Œå…¨ä¸ç¬¦åˆ", "2<br>å¤§éƒ¨åˆ†ä¸ç¬¦åˆ", "3<br>æœ‰ç‚¹ä¸ç¬¦åˆ", "4<br>æœ‰ç‚¹ç¬¦åˆ", "5<br>å¤§éƒ¨åˆ†ç¬¦åˆ", "6<br>å®Œå…¨ç¬¦åˆ"],
                                required: true,
                                name: "q30"
                            },
                            {
                                prompt: "æˆ‘å¸¸æ‹…å¿ƒæœ‰ä»€ä¹ˆä¸å¥½çš„äº‹æƒ…è¦å‘ç”Ÿ",
                                labels: ["1<br>å®Œå…¨ä¸ç¬¦åˆ", "2<br>å¤§éƒ¨åˆ†ä¸ç¬¦åˆ", "3<br>æœ‰ç‚¹ä¸ç¬¦åˆ", "4<br>æœ‰ç‚¹ç¬¦åˆ", "5<br>å¤§éƒ¨åˆ†ç¬¦åˆ", "6<br>å®Œå…¨ç¬¦åˆ"],
                                required: true,
                                name: "q31"
                            },
                            {
                                prompt: "åœ¨å·¥ä½œä¸Šï¼Œæˆ‘å¸¸åªæ±‚èƒ½åº”ä»˜è¿‡å»ä¾¿å¯",
                                labels: ["1<br>å®Œå…¨ä¸ç¬¦åˆ", "2<br>å¤§éƒ¨åˆ†ä¸ç¬¦åˆ", "3<br>æœ‰ç‚¹ä¸ç¬¦åˆ", "4<br>æœ‰ç‚¹ç¬¦åˆ", "5<br>å¤§éƒ¨åˆ†ç¬¦åˆ", "6<br>å®Œå…¨ç¬¦åˆ"],
                                required: true,
                                name: "q32"
                            },
                            {
                                prompt: "å°½ç®¡äººç±»ç¤¾ä¼šå­˜åœ¨ç€ä¸€äº›é˜´æš—çš„ä¸œè¥¿ï¼ˆå¦‚æˆ˜äº‰ã€ç½ªæ¶ã€æ¬ºè¯ˆï¼‰ï¼Œæˆ‘ä»ç„¶ç›¸ä¿¡äººæ€§æ€»çš„æ¥è¯´æ˜¯å–„è‰¯çš„",
                                labels: ["1<br>å®Œå…¨ä¸ç¬¦åˆ", "2<br>å¤§éƒ¨åˆ†ä¸ç¬¦åˆ", "3<br>æœ‰ç‚¹ä¸ç¬¦åˆ", "4<br>æœ‰ç‚¹ç¬¦åˆ", "5<br>å¤§éƒ¨åˆ†ç¬¦åˆ", "6<br>å®Œå…¨ç¬¦åˆ"],
                                required: true,
                                name: "q33"
                            },
                            {
                                prompt: "æˆ‘çš„æƒ³è±¡åŠ›ç›¸å½“ä¸°å¯Œ",
                                labels: ["1<br>å®Œå…¨ä¸ç¬¦åˆ", "2<br>å¤§éƒ¨åˆ†ä¸ç¬¦åˆ", "3<br>æœ‰ç‚¹ä¸ç¬¦åˆ", "4<br>æœ‰ç‚¹ç¬¦åˆ", "5<br>å¤§éƒ¨åˆ†ç¬¦åˆ", "6<br>å®Œå…¨ç¬¦åˆ"],
                                required: true,
                                name: "q34"
                            },
                            {
                                prompt: "æˆ‘å–œæ¬¢å‚åŠ ç¤¾äº¤ä¸å¨±ä¹èšä¼š",
                                labels: ["1<br>å®Œå…¨ä¸ç¬¦åˆ", "2<br>å¤§éƒ¨åˆ†ä¸ç¬¦åˆ", "3<br>æœ‰ç‚¹ä¸ç¬¦åˆ", "4<br>æœ‰ç‚¹ç¬¦åˆ", "5<br>å¤§éƒ¨åˆ†ç¬¦åˆ", "6<br>å®Œå…¨ç¬¦åˆ"],
                                required: true,
                                name: "q35"
                            },
                            {
                                prompt: "æˆ‘å¾ˆå°‘æ„Ÿåˆ°å¿§éƒæˆ–æ²®ä¸§",
                                labels: ["1<br>å®Œå…¨ä¸ç¬¦åˆ", "2<br>å¤§éƒ¨åˆ†ä¸ç¬¦åˆ", "3<br>æœ‰ç‚¹ä¸ç¬¦åˆ", "4<br>æœ‰ç‚¹ç¬¦åˆ", "5<br>å¤§éƒ¨åˆ†ç¬¦åˆ", "6<br>å®Œå…¨ç¬¦åˆ"],
                                required: true,
                                name: "q36"
                            },
                            {
                                prompt: "åšäº‹è®²ç©¶é€»è¾‘å’Œæ¡ç†æ˜¯æˆ‘çš„ä¸€ä¸ªç‰¹ç‚¹",
                                labels: ["1<br>å®Œå…¨ä¸ç¬¦åˆ", "2<br>å¤§éƒ¨åˆ†ä¸ç¬¦åˆ", "3<br>æœ‰ç‚¹ä¸ç¬¦åˆ", "4<br>æœ‰ç‚¹ç¬¦åˆ", "5<br>å¤§éƒ¨åˆ†ç¬¦åˆ", "6<br>å®Œå…¨ç¬¦åˆ"],
                                required: true,
                                name: "q37"
                            },
                            {
                                prompt: "æˆ‘å¸¸ä¸ºé‚£äº›é­é‡ä¸å¹¸çš„äººæ„Ÿåˆ°éš¾è¿‡",
                                labels: ["1<br>å®Œå…¨ä¸ç¬¦åˆ", "2<br>å¤§éƒ¨åˆ†ä¸ç¬¦åˆ", "3<br>æœ‰ç‚¹ä¸ç¬¦åˆ", "4<br>æœ‰ç‚¹ç¬¦åˆ", "5<br>å¤§éƒ¨åˆ†ç¬¦åˆ", "6<br>å®Œå…¨ç¬¦åˆ"],
                                required: true,
                                name: "q38"
                            },
                            {
                                prompt: "æˆ‘å¾ˆæ„¿æ„ä¹Ÿå¾ˆå®¹æ˜“æ¥å—é‚£äº›æ–°äº‹ç‰©ã€æ–°è§‚ç‚¹ã€æ–°æƒ³æ³•",
                                labels: ["1<br>å®Œå…¨ä¸ç¬¦åˆ", "2<br>å¤§éƒ¨åˆ†ä¸ç¬¦åˆ", "3<br>æœ‰ç‚¹ä¸ç¬¦åˆ", "4<br>æœ‰ç‚¹ç¬¦åˆ", "5<br>å¤§éƒ¨åˆ†ç¬¦åˆ", "6<br>å®Œå…¨ç¬¦åˆ"],
                                required: true,
                                name: "q39"
                            },
                            {
                                prompt: "æˆ‘å¸Œæœ›æˆä¸ºé¢†å¯¼è€…è€Œä¸æ˜¯è¢«é¢†å¯¼è€…",
                                labels: ["1<br>å®Œå…¨ä¸ç¬¦åˆ", "2<br>å¤§éƒ¨åˆ†ä¸ç¬¦åˆ", "3<br>æœ‰ç‚¹ä¸ç¬¦åˆ", "4<br>æœ‰ç‚¹ç¬¦åˆ", "5<br>å¤§éƒ¨åˆ†ç¬¦åˆ", "6<br>å®Œå…¨ç¬¦åˆ"],
                                required: true,
                                name: "q40"
                            }
                        ],
                        button_label: "æäº¤é—®å·"
                    },
                    
                    // ç¬¬äºŒé˜¶æ®µï¼šAIåˆ†æ
                    {
                        type: jsPsychAISurvey,
                        preamble: `
                            <div style="text-align: center; padding: 30px;">
                                <h2>æ­£åœ¨ç”Ÿæˆæ‚¨çš„äººæ ¼åˆ†ææŠ¥å‘Š...</h2>
                                <p style="color: #666; font-size: 16px;">AIæ­£åœ¨åŸºäºæ‚¨çš„é—®å·ç­”æ¡ˆè¿›è¡Œæ·±åº¦åˆ†æï¼Œè¯·ç¨å€™</p>
                            </div>
                        `,
                        questions: [{
                            prompt: "æ‚¨çš„å¤§äº”äººæ ¼åˆ†ææŠ¥å‘Šï¼š",
                            name: "personality_analysis",
                            rows: 20,
                            columns: 80
                        }],
                        auto_generate: true,
                        hide_user_input: true,
                        ai_analysis_mode: "individual",
                        show_individual_ai_areas: true,
                        
                        // è·å–å‰ä¸€ä¸ªè¯•æ¬¡çš„é—®å·æ•°æ®
                        data_collector: function() {
                            console.log('data_collector å‡½æ•°è¢«è°ƒç”¨');
                            
                            // åœ¨jsPsych v7ä¸­ï¼Œéœ€è¦é€šè¿‡è¯•æ¬¡ä¸Šä¸‹æ–‡è·å–æ•°æ®
                            // è¿™ä¸ªå‡½æ•°ä¼šåœ¨è¯•æ¬¡æ‰§è¡Œæ—¶è¢«è°ƒç”¨ï¼Œæ­¤æ—¶å¯ä»¥è®¿é—®jsPsychå®ä¾‹
                            if (typeof window.currentJsPsychInstance !== 'undefined' && window.currentJsPsychInstance) {
                                console.log('æ‰¾åˆ° jsPsych å®ä¾‹');
                                
                                const allData = window.currentJsPsychInstance.data.get();
                                console.log('æ‰€æœ‰æ•°æ®:', allData.values());
                                
                                const surveyTrials = allData.filter({trial_type: 'survey-likert'});
                                console.log('é—®å·è¯•æ¬¡:', surveyTrials.values());
                                
                                const surveyData = surveyTrials.last(1).values()[0];
                                console.log('æœ€æ–°é—®å·æ•°æ®:', surveyData);
                                
                                if (surveyData && surveyData.response) {
                                    console.log('æ‰¾åˆ°é—®å·å“åº”æ•°æ®:', surveyData.response);
                                    
                                    // æ ¼å¼åŒ–é—®å·æ•°æ®ç”¨äºAIåˆ†æ
                                    let formattedData = "ç”¨æˆ·çš„é—®å·å›ç­”ç»“æœï¼š\n\n";
                                    
                                    for (let i = 1; i <= 40; i++) {
                                        const questionKey = `q${i}`;
                                        if (surveyData.response[questionKey] !== undefined) {
                                            formattedData += `é¢˜ç›®${i}ï¼š${surveyData.response[questionKey]}åˆ†\n`;
                                        }
                                    }
                                    
                                    console.log('æ ¼å¼åŒ–çš„æ•°æ®:', formattedData);
                                    
                                    return {
                                        questionnaire_data: formattedData
                                    };
                                } else {
                                    console.log('æ²¡æœ‰æ‰¾åˆ°é—®å·å“åº”æ•°æ®');
                                }
                            } else {
                                console.log('æ²¡æœ‰æ‰¾åˆ° jsPsych å®ä¾‹');
                            }
                            
                            return {
                                questionnaire_data: "æ— æ³•è·å–é—®å·æ•°æ®"
                            };
                        },
                        
                        system_prompt: `ä½ æ˜¯ä¸€ä½å¿ƒç†å­¦ä¸“å®¶ï¼Œæ“…é•¿å¤§äº”äººæ ¼ç†è®ºåˆ†æã€‚è¯·åŸºäºå¿ƒç†å­¦åŸç†ï¼Œå¯¹é—®å·ç»“æœè¿›è¡Œç§‘å­¦ã€å‡†ç¡®ã€æœ‰è¶£çš„åˆ†æã€‚

åˆ†ææ¡†æ¶ï¼š

ä»¥ä¸‹æ˜¯é—®å·å„ç»´åº¦çš„ç»„æˆï¼š
- ç¥ç»è´¨ï¼ˆæƒ…ç»ªç¨³å®šæ€§ï¼‰ï¼šé¢˜ç›® 1ã€6ã€11ã€16ã€21ã€26ã€31ã€36
- ä¸¥è°¨æ€§ï¼ˆå°½è´£æ€§ï¼‰ï¼šé¢˜ç›® 2ã€7ã€12ã€17ã€22ã€27ã€32ã€37  
- å®œäººæ€§ï¼šé¢˜ç›® 3ã€8ã€13ã€18ã€23ã€28ã€33ã€38
- å¼€æ”¾æ€§ï¼šé¢˜ç›® 4ã€9ã€14ã€19ã€24ã€29ã€34ã€39
- å¤–å‘æ€§ï¼šé¢˜ç›® 5ã€10ã€15ã€20ã€25ã€30ã€35ã€40

åå‘è®¡åˆ†é¢˜ç›®ï¼š5ã€8ã€13ã€15ã€18ã€32ã€36ï¼ˆè®¡ç®—æ—¶ç”¨7å‡å»å®é™…å¾—åˆ†ï¼‰

è¯·æŒ‰ä»¥ä¸‹æ ¼å¼è¿›è¡Œåˆ†æï¼š

1. **å¾—åˆ†è®¡ç®—**ï¼šè®¡ç®—å„ç»´åº¦å¾—åˆ†ï¼ˆè®°ä½åå‘è®¡åˆ†é¢˜ç›®ï¼‰
2. **äººæ ¼ç”»åƒ**ï¼šç”¨ç”ŸåŠ¨æœ‰è¶£çš„è¯­è¨€æè¿°è¿™ä¸ªäººçš„æ€§æ ¼ç‰¹ç‚¹
3. **äº”ç»´è¯¦æ**ï¼šæ¯ä¸ªç»´åº¦çš„è¯¦ç»†åˆ†æ
4. **èŒä¸šå»ºè®®**ï¼šæ ¹æ®äººæ ¼ç‰¹å¾æ¨èé€‚åˆçš„èŒä¸šæ–¹å‘
5. **å‘å±•å»ºè®®**ï¼šé’ˆå¯¹æ€§çš„ä¸ªäººæˆé•¿å»ºè®®
6. **è¶£å‘³æ´å¯Ÿ**ï¼šç”¨æ¯”å–»æˆ–ç±»æ¯”æ¥å½¢è±¡åŒ–æè¿°è¿™ä¸ªäººæ ¼

è¯·ç”¨ç§‘å­¦çš„æ•°æ®åˆ†æç»“åˆé€šä¿—æ˜“æ‡‚çš„è¯­è¨€ï¼Œè®©ç»“æœæ—¢ä¸“ä¸šåˆæœ‰è¶£ã€‚`,
                        
                        button_label: "æŸ¥çœ‹åˆ†ææŠ¥å‘Š",
                        interface_language: "zh"
                    }
                ]
            }
        };

        function runDemo(demoType) {
            // æ›´æ–°å¯¼èˆªæŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.demo-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // æ‰¾åˆ°å¹¶æ¿€æ´»å¯¹åº”çš„æŒ‰é’®
            const buttonTexts = {
                'multi_plugin_integration': 'ğŸ”— å¤šæ’ä»¶æ•°æ®é›†æˆ',
                'survey_choice_analysis': 'ğŸ“Š é€‰æ‹©é¢˜+AIåˆ†æ',
                'reaction_time_analysis': 'âš¡ ååº”æ—¶+AIæ´å¯Ÿ',
                'mouse_tracking_decision': 'ğŸ–±ï¸ é¼ æ ‡è½¨è¿¹å†³ç­–',
                'comprehensive_experiment': 'ğŸ§ª ç»¼åˆå®éªŒè®¾è®¡',
                'creativity_ai': 'ğŸ¨ åˆ›é€ åŠ›ä¸AIåä½œ',
                'ai_personality_moral': 'âš–ï¸ AIäººæ ¼é“å¾·åˆ¤æ–­',
                'multi_ai_analysis': 'ğŸ”„ ä¸€æ¬¡è¾“å…¥å¤šAIåˆ†æ'
            };
            
            const targetButton = Array.from(document.querySelectorAll('.demo-btn')).find(btn => 
                btn.textContent.trim() === buttonTexts[demoType]
            );
            
            if (targetButton) {
                targetButton.classList.add('active');
            }
            
            const config = demoConfigs[demoType];
            
            // æ˜¾ç¤ºæ¼”ç¤ºæè¿°
            const container = document.getElementById('jspsych-container');
            container.innerHTML = `
                <div class="demo-description">
                    <h4>${config.title}</h4>
                    <p>${config.description}</p>
                </div>
                <div id="jspsych-experiment-content"></div>
            `;
            
            // é‡æ–°åˆå§‹åŒ– jsPsych å®ä¾‹ï¼ŒæŒ‡å‘æ–°çš„å®¹å™¨
            const jsPsychInstance = initJsPsych({
                display_element: 'jspsych-experiment-content',
                on_finish: function(data) {
                    console.log('å®éªŒå®Œæˆï¼Œæ•°æ®ï¼š', data.values());
                    
                    // æ˜¾ç¤ºç»“æœ
                    const expContainer = document.getElementById('jspsych-experiment-content');
                    expContainer.innerHTML = `
                        <div class="demo-description">
                            <h4>âœ… å®éªŒå®Œæˆï¼</h4>
                            <p>æ•°æ®å·²ä¿å­˜åˆ°æµè§ˆå™¨æ§åˆ¶å°ã€‚æ‚¨å¯ä»¥æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰æŸ¥çœ‹å®Œæ•´æ•°æ®ã€‚</p>
                        </div>
                        <div style="background: #f8f9fa; border-radius: 6px; padding: 20px; margin-top: 20px;">
                            <h5>æ•°æ®é¢„è§ˆï¼š</h5>
                            <pre style="background: white; padding: 15px; border-radius: 4px; overflow-x: auto; font-size: 12px;">
${JSON.stringify(data.values(), null, 2)}
                            </pre>
                        </div>
                        <button class="demo-btn" onclick="location.reload()" style="margin-top: 20px; display: block; margin-left: auto; margin-right: auto;">
                            é‡æ–°å¼€å§‹æ¼”ç¤º
                        </button>
                    `;
                }
            });
            
            // ä¿å­˜jsPsychå®ä¾‹åˆ°å…¨å±€å˜é‡ï¼Œä¾›data_collectorå‡½æ•°ä½¿ç”¨
            window.currentJsPsychInstance = jsPsychInstance;
            
            // åˆå¹¶ç”¨æˆ·APIé…ç½®åˆ°è¯•æ¬¡é…ç½®ä¸­
            const userConfig = getDynamicConfig();
            let mergedTrials;
            
            if (Array.isArray(config.trial)) {
                // å¦‚æœæ˜¯å¤šä¸ªè¯•æ¬¡ï¼ˆå¦‚personalityæµ‹è¯„ï¼‰ï¼Œåˆå¹¶é…ç½®åˆ°éœ€è¦APIçš„è¯•æ¬¡
                mergedTrials = config.trial.map(trial => {
                    if (trial.type === jsPsychAISurvey) {
                        // é‡è¦ï¼šä¿ç•™åŸæœ‰é…ç½®ï¼Œåªè¦†ç›–APIç›¸å…³é…ç½®
                        console.log('ğŸ”§ runDemoï¼šåˆå¹¶APIé…ç½®åˆ°AIè¯•æ¬¡ï¼ŒåŸå§‹è¯•æ¬¡é…ç½®:', trial);
                        const mergedTrial = {
                            ...trial,  // ä¿ç•™æ‰€æœ‰åŸæœ‰é…ç½®ï¼ˆåŒ…æ‹¬data_collectorç­‰ï¼‰
                            base_url: userConfig.base_url,
                            api: userConfig.api,
                            api_key: userConfig.api_key,
                            llm_model: userConfig.llm_model,
                            api_timeout: userConfig.api_timeout
                        };
                        console.log('ğŸ”§ runDemoï¼šåˆå¹¶åçš„è¯•æ¬¡é…ç½®:', mergedTrial);
                        console.log('ğŸ”§ runDemoï¼šdata_collectorå‡½æ•°æ˜¯å¦å­˜åœ¨:', typeof mergedTrial.data_collector === 'function');
                        return mergedTrial;
                    }
                    return trial;
                });
            } else {
                // å•ä¸ªè¯•æ¬¡
                console.log('ğŸ”§ runDemoï¼šå¤„ç†å•ä¸ªè¯•æ¬¡ï¼ŒåŸå§‹é…ç½®:', config.trial);
                const mergedTrial = {
                    ...config.trial,  // ä¿ç•™æ‰€æœ‰åŸæœ‰é…ç½®ï¼ˆåŒ…æ‹¬data_collectorç­‰ï¼‰
                    base_url: userConfig.base_url,
                    api: userConfig.api,
                    api_key: userConfig.api_key,
                    llm_model: userConfig.llm_model,
                    api_timeout: userConfig.api_timeout
                };
                console.log('ğŸ”§ runDemoï¼šå•ä¸ªè¯•æ¬¡åˆå¹¶åé…ç½®:', mergedTrial);
                console.log('ğŸ”§ runDemoï¼šå•ä¸ªè¯•æ¬¡data_collectorå‡½æ•°æ˜¯å¦å­˜åœ¨:', typeof mergedTrial.data_collector === 'function');
                mergedTrials = [mergedTrial];
            }
            
            // è¿è¡Œå®éªŒ
            jsPsychInstance.run(mergedTrials);
        }

        // é¡µé¢åŠ è½½å®Œæˆåè¿è¡Œé»˜è®¤æ¼”ç¤º
        document.addEventListener('DOMContentLoaded', function() {
            // åˆå§‹åŒ–é»˜è®¤é…ç½®
            loadConfig(); // å°è¯•åŠ è½½ä¿å­˜çš„é…ç½®
            if (!document.getElementById('api-key').value) {
                // å¦‚æœæ²¡æœ‰ä¿å­˜çš„é…ç½®ï¼Œä½¿ç”¨é»˜è®¤é…ç½®
                resetConfig();
            }
            
            // ç¡®ä¿demoConfigså·²ç»åˆå§‹åŒ–åå†è¿è¡Œæ¼”ç¤º
            setTimeout(() => {
                console.log('ğŸš€ é¡µé¢åˆå§‹åŒ–å®Œæˆï¼ŒdemoConfigs:', Object.keys(demoConfigs));
                console.log('ğŸš€ jsPsychAISurvey:', typeof jsPsychAISurvey);
                runDemo('multi_plugin_integration');
            }, 100);
        });
    </script>
</body>
</html>
